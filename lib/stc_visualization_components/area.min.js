!function(a){function b(a){return"Year"!==a?a:""}var c={margin:{top:15,right:10,bottom:30,left:50},aspectRatio:16/9,x:{tickSize:12,tickSizeOuter:12},y:{ticks:12,tickSizeOuter:12,totalProperty:"total",getTotal:function(a,b,c){var d,e,f=this;if(!a[f.y.totalProperty]){e=f.z.getKeys.call(f,c),d=0;for(var g=0;g<e.length;g++)d+=f.y.getValue.call(f,a,e[g],c);a[f.y.totalProperty]=d}return a[f.y.totalProperty]}},areaTableID:"areaTable",summaryId:"chrt-dt-tbl",dataTableTotal:!1};this.areaChart=function(d,e,f){var g,h,i=a(!0,{},c,e),j=i.width,k=Math.ceil(j/i.aspectRatio),l=i.innerHeight=k-i.margin.top-i.margin.bottom,m=i.innerWidth=j-i.margin.left-i.margin.right,n=d.select("g.margin-offset"),o=n.select(".data"),p=d3.area().defined(function(a){return!(isNaN(a[0])||isNaN(a[1]))}).x(function(a){return g(i.x.getValue(a.data))}).y0(function(a){return h(a[0])}).y1(function(a){return h(a[1])}),q=d3.stack(),r=d3.transition().duration(500),s=function(){var a=this.settings,b=a.filterData&&"function"==typeof a.filterData?a.filterData.call(a,f):f,c=a.z.getKeys.call(a,b),d=q.keys(c).value(a.y.getValue.bind(a))(b),j=n.select(".x.axis"),k=n.select(".y.axis"),s=m-6,t=function(a){return h((a[a.length-1][0]+a[a.length-1][1])/2)},u=function(b,c){var d="area area"+(c+1);return a.z&&a.z.getClass&&"function"==typeof a.z.getClass&&(d+=" "+a.z.getClass.call(a,b)),d};g=v.x=function(){return d3.scaleTime()}().range([0,m]),h=v.y=d3.scaleLinear().range([l,0]),g.domain(d3.extent(b,a.x.getValue.bind(a))),h.domain([0,d3.max(b,a.y.getTotal.bind(a))]),o.empty()&&(o=n.append("g").attr("class","data"));var w=o.selectAll(".area").data(d,a.z.getId.bind(a));w.enter().append("path").attr("class",u).attr("d",p),!1===i.transition?w.attr("d",p):w.transition(r).attr("d",p),w.exit().remove();var x=o.selectAll(".area-label").data(d,a.z.getId.bind(a));x.enter().append("text").text(a.z.getText.bind(a)).attr("aria-hidden","true").attr("class","area-label").attr("fill","#000").attr("x",s).attr("y",t).attr("dy","1em").attr("text-anchor","end"),!1===i.transition?x.attr("y",t):x.transition(r).attr("y",t),x.exit().remove(),n.empty()||n.append("text").attr("x",m/2).attr("y",0-i.margin.top/2).attr("text-anchor","middle").attr("class","areaChartTitle"),j.empty()?(j=n.append("g").attr("class","x axis").attr("aria-hidden","true").attr("transform","translate(0,"+l+")"),j.append("text").attr("class","chart-label").attr("fill","#000").attr("x",m/2).attr("dy","3.5em").attr("text-anchor","end").text(e.x.label)):j.select("text").text(e.x.label),j.call(d3.axisBottom(g).tickSize(i.x.tickSize).tickSizeOuter(i.x.tickSizeOuter).ticks(i.x.ticks).tickFormat(a.x.getTickText?a.x.getTickText.bind(a):null)),k.empty()?(k=n.append("g").attr("class","y axis").attr("aria-hidden","true"),k.append("text").attr("class","chart-label").attr("fill","#000").attr("y","0").attr("dy","-0.5em").attr("text-anchor","start").text(e.y.label)):k.select("text").text(e.y.label),k.call(d3.axisLeft(h).ticks(i.y.ticks).tickSizeOuter(i.y.tickSizeOuter).tickFormat(a.y.getTickText?a.y.getTickText.bind(a):null))},t=function(){var a,c,e,g,h,j,k=this.settings,l=d3.select("#"+k.areaTableID),m=k.summaryId,n=k.z.origData&&"function"==typeof k.z.origData?k.z.origData.call(k,f):f,o=l.select(d.classed("svg-shimmed")?function(){return this.parentNode.parentNode}:function(){return this.parentNode}),p=o.select("details"),q=k.z.getKeys.call(k,n);i.dataTableTotal&&q.push("total"),p.empty()||o.selectAll("details").remove(),p=o.append("details").attr("class","chart-data-table");for(p.append("summary").attr("id",function(){return d3.select("#chrt-dt-tbl").empty()?m:m+"1"}).text(k.tableTitle),p.append("caption").attr("class","wb-inv").text(k.tableTitle),p.append("div").attr("id","copy-button-container"),a=p.append("table").attr("class","table").attr("caption",m),c=a.append("thead").attr("id","tblHeader").append("tr").attr("id","tblHeaderTR"),e=a.append("tbody").attr("id","tblBody"),c.append("td").attr("id","thead_h0").text(b(k.x.label)),j=0;j<q.length;j++)c.append("th").attr("id","thead_h"+(j+1)).style("text-align","right").text(k.z.getText.bind(k)({key:q[j]}));for(g=e.selectAll("tr").data(n),h=g.enter().append("tr").attr("id",function(a,b){return"row"+b}),h.append("th").attr("id",function(a,b){return"row"+b+"_h0"}).text((k.x.getText||k.x.getValue).bind(k)),j=0;j<q.length;j++)h.append("td").attr("headers",function(a,b){return"row"+b+"_h0 thead_h"+(j+1)}).text(function(a){return k.y.getText?k.y.getText.call(k,a,q[j]):k.y.getValue.call(k,a,q[j])}).style("text-align","right");$&&$(".chart-data-table summary").trigger("wb-init.wb-details")},u=function(){o.remove()},v={settings:i,clear:u,svg:d};d.attr("viewBox","0 0 "+j+" "+k).attr("preserveAspectRatio","xMidYMid meet").attr("role","img").attr("aria-label",i.altText),n.empty()&&(n=d.append("g").attr("class","margin-offset").attr("transform","translate("+i.margin.left+","+i.margin.top+")"));var w=function(){s.apply(v),d3.stcExt.addIEShim(d,k,j),!1!==i.datatable&&t.apply(v)};return void 0===f?d3.json(i.url,function(a,b){f=b,w()}):w(),v}}(jQuery.extend,jQuery);
//# sourceMappingURL=area.min.js.map