!function(){"use strict";function t(t,e){return t(e={exports:{}},e.exports),e.exports}var h=t(function(t){var e=t.exports={version:"2.6.3"};"number"==typeof __e&&(__e=e)}),v=(h.version,t(function(t){var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)})),o=t(function(t){var e="__core-js_shared__",n=v[e]||(v[e]={});(t.exports=function(t,e){return n[t]||(n[t]=void 0!==e?e:{})})("versions",[]).push({version:h.version,mode:"global",copyright:"Â© 2019 Denis Pushkarev (zloirock.ru)"})}),e=0,n=Math.random(),c=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++e+n).toString(36))},r=t(function(t){var e=o("wks"),n=v.Symbol,r="function"==typeof n;(t.exports=function(t){return e[t]||(e[t]=r&&n[t]||(r?n:c)("Symbol."+t))}).store=e}),u=function(t){return"object"==typeof t?null!==t:"function"==typeof t},a=function(t){if(!u(t))throw TypeError(t+" is not an object!");return t},l=function(t){try{return!!t()}catch(t){return!0}},i=!l(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),s=v.document,f=u(s)&&u(s.createElement),p=function(t){return f?s.createElement(t):{}},d=!i&&!l(function(){return 7!=Object.defineProperty(p("div"),"a",{get:function(){return 7}}).a}),y=function(t,e){if(!u(t))return t;var n,r;if(e&&"function"==typeof(n=t.toString)&&!u(r=n.call(t)))return r;if("function"==typeof(n=t.valueOf)&&!u(r=n.call(t)))return r;if(!e&&"function"==typeof(n=t.toString)&&!u(r=n.call(t)))return r;throw TypeError("Can't convert object to primitive value")},g=Object.defineProperty,m={f:i?Object.defineProperty:function(t,e,n){if(a(t),e=y(e,!0),a(n),d)try{return g(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},O=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},_=i?function(t,e,n){return m.f(t,e,O(1,n))}:function(t,e,n){return t[e]=n,t},b=r("unscopables"),x=Array.prototype;null==x[b]&&_(x,b,{});var j=function(t){x[b][t]=!0},A=function(t,e){return{value:e,done:!!t}},S={},T={}.toString,w=function(t){return T.call(t).slice(8,-1)},N=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==w(t)?t.split(""):Object(t)},I=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t},P=function(t){return N(I(t))},k={}.hasOwnProperty,E=function(t,e){return k.call(t,e)},F=t(function(t){var i=c("src"),e="toString",n=Function[e],a=(""+n).split(e);h.inspectSource=function(t){return n.call(t)},(t.exports=function(t,e,n,r){var o="function"==typeof n;o&&(E(n,"name")||_(n,"name",e)),t[e]!==n&&(o&&(E(n,i)||_(n,i,t[e]?""+t[e]:a.join(String(e)))),t===v?t[e]=n:r?t[e]?t[e]=n:_(t,e,n):(delete t[e],_(t,e,n)))})(Function.prototype,e,function(){return"function"==typeof this&&this[i]||n.call(this)})}),C=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t},L=function(r,o,t){if(C(r),void 0===o)return r;switch(t){case 1:return function(t){return r.call(o,t)};case 2:return function(t,e){return r.call(o,t,e)};case 3:return function(t,e,n){return r.call(o,t,e,n)}}return function(){return r.apply(o,arguments)}},M="prototype",B=function(t,e,n){var r,o,i,a,c=t&B.F,u=t&B.G,l=t&B.S,s=t&B.P,f=t&B.B,p=u?v:l?v[e]||(v[e]={}):(v[e]||{})[M],d=u?h:h[e]||(h[e]={}),y=d[M]||(d[M]={});for(r in u&&(n=e),n)i=((o=!c&&p&&void 0!==p[r])?p:n)[r],a=f&&o?L(i,v):s&&"function"==typeof i?L(Function.call,i):i,p&&F(p,r,i,t&B.U),d[r]!=i&&_(d,r,a),s&&y[r]!=i&&(y[r]=i)};v.core=h,B.F=1,B.G=2,B.S=4,B.P=8,B.B=16,B.W=32,B.U=64,B.R=128;var D=B,V=Math.ceil,G=Math.floor,R=function(t){return isNaN(t=+t)?0:(0<t?G:V)(t)},z=Math.min,U=function(t){return 0<t?z(R(t),9007199254740991):0},Y=Math.max,H=Math.min,X=function(l){return function(t,e,n){var r,o,i,a=P(t),c=U(a.length),u=(o=c,(r=R(r=n))<0?Y(r+o,0):H(r,o));if(l&&e!=e){for(;u<c;)if((i=a[u++])!=i)return!0}else for(;u<c;u++)if((l||u in a)&&a[u]===e)return l||u||0;return!l&&-1}},q=o("keys"),Q=function(t){return q[t]||(q[t]=c(t))},W=X(!1),K=Q("IE_PROTO"),J=function(t,e){var n,r=P(t),o=0,i=[];for(n in r)n!=K&&E(r,n)&&i.push(n);for(;e.length>o;)E(r,n=e[o++])&&(~W(i,n)||i.push(n));return i},Z="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),tt=Object.keys||function(t){return J(t,Z)},et=i?Object.defineProperties:function(t,e){a(t);for(var n,r=tt(e),o=r.length,i=0;i<o;)m.f(t,n=r[i++],e[n]);return t},nt=v.document,rt=nt&&nt.documentElement,ot=Q("IE_PROTO"),it=function(){},at="prototype",ct=function(){var t,e=p("iframe"),n=Z.length;for(e.style.display="none",rt.appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),ct=t.F;n--;)delete ct[at][Z[n]];return ct()},ut=Object.create||function(t,e){var n;return null!==t?(it[at]=a(t),n=new it,it[at]=null,n[ot]=t):n=ct(),void 0===e?n:et(n,e)},lt=m.f,st=r("toStringTag"),ft=function(t,e,n){t&&!E(t=n?t:t.prototype,st)&&lt(t,st,{configurable:!0,value:e})},pt={};_(pt,r("iterator"),function(){return this});var dt=function(t){return Object(I(t))},yt=Q("IE_PROTO"),ht=Object.prototype,vt=Object.getPrototypeOf||function(t){return t=dt(t),E(t,yt)?t[yt]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?ht:null},gt=r("iterator"),mt=!([].keys&&"next"in[].keys()),bt="values",xt=function(){return this},jt=function(t,e,n,r,o,i,a){var c,u,l;u=e,l=r,(c=n).prototype=ut(pt,{next:O(1,l)}),ft(c,u+" Iterator");var s,f,p,d=function(t){if(!mt&&t in g)return g[t];switch(t){case"keys":case bt:return function(){return new n(this,t)}}return function(){return new n(this,t)}},y=e+" Iterator",h=o==bt,v=!1,g=t.prototype,m=g[gt]||g["@@iterator"]||o&&g[o],b=m||d(o),x=o?h?d("entries"):b:void 0,j="Array"==e&&g.entries||m;if(j&&(p=vt(j.call(new t)))!==Object.prototype&&p.next&&(ft(p,y,!0),"function"!=typeof p[gt]&&_(p,gt,xt)),h&&m&&m.name!==bt&&(v=!0,b=function(){return m.call(this)}),(mt||v||!g[gt])&&_(g,gt,b),S[e]=b,S[y]=xt,o)if(s={values:h?b:d(bt),keys:i?b:d("keys"),entries:x},a)for(f in s)f in g||F(g,f,s[f]);else D(D.P+D.F*(mt||v),e,s);return s},Ot=jt(Array,"Array",function(t,e){this._t=P(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,A(1)):A(0,"keys"==e?n:"values"==e?t[n]:[n,t[n]])},"values");S.Arguments=S.Array,j("keys"),j("values"),j("entries");for(var _t=r("iterator"),At=r("toStringTag"),St=S.Array,Tt={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},wt=tt(Tt),Nt=0;Nt<wt.length;Nt++){var It,Pt=wt[Nt],kt=Tt[Pt],Et=v[Pt],Ft=Et&&Et.prototype;if(Ft&&(Ft[_t]||_(Ft,_t,St),Ft[At]||_(Ft,At,Pt),S[Pt]=St,kt))for(It in Ot)Ft[It]||F(Ft,It,Ot[It],!0)}var Ct,Lt,Mt,Bt;Ct="keys",Lt=function(){return function(t){return tt(dt(t))}},Mt=(h.Object||{})[Ct]||Object[Ct],(Bt={})[Ct]=Lt(Mt),D(D.S+D.F*l(function(){Mt(1)}),"Object",Bt);var Dt,Vt,Gt,Rt,zt,Ut,Yt,Ht,Xt,$t=Array.isArray||function(t){return"Array"==w(t)},qt=r("species"),Qt=function(t,e){return!!t&&l(function(){e?t.call(null,function(){},1):t.call(null)})},Wt=(Gt=(Dt=1)==Dt,Rt=2==Dt,zt=3==Dt,Ut=4==Dt,Yt=6==Dt,Ht=5==Dt||Yt,Xt=Vt||function(t,e){return $t(n=t)&&("function"!=typeof(r=n.constructor)||r!==Array&&!$t(r.prototype)||(r=void 0),u(r)&&null===(r=r[qt])&&(r=void 0)),new(void 0===r?Array:r)(e);var n,r},function(t,e,n){for(var r,o,i=dt(t),a=N(i),c=L(e,n,3),u=U(a.length),l=0,s=Gt?Xt(t,u):Rt?Xt(t,0):void 0;l<u;l++)if((Ht||l in a)&&(o=c(r=a[l],l,i),Dt))if(Gt)s[l]=o;else if(o)switch(Dt){case 3:return!0;case 5:return r;case 6:return l;case 2:s.push(r)}else if(Ut)return!1;return Yt?-1:zt||Ut?Ut:s});function Kt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),r.forEach(function(t){Kt(e,t,n[t])})}return e}D(D.P+D.F*!Qt([].map,!0),"Array",{map:function(t){return Wt(this,t,arguments[1])}});var Zt=X(!1),te=[].indexOf,ee=!!te&&1/[1].indexOf(1,-0)<0;D(D.P+D.F*(ee||!Qt(te)),"Array",{indexOf:function(t){return ee?te.apply(this,arguments)||0:Zt(this,t,arguments[1])}});var ne={aspectRatio:16/13,margin:{top:50,left:50,bottom:50},x:{label:i18next.t("x_label",{ns:"railBar"}),getId:function(t){return t.year},getValue:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.x.getId.apply(this,e)},getClass:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.x.getId.apply(this,e)},getTickText:function(t){return i18next.t(t,{ns:"railBar"})}},y:{label:i18next.t("y_label",{ns:"railBar"}),getValue:function(t){return t.value},getText:function(t){return t.value},ticks:10,tickSizeOuter:0},z:{label:i18next.t("z_label",{ns:"railTable"}),getId:function(t){return t.category},getKeys:function(t){var e=Object.keys(t[0]);return e.splice(e.indexOf("category"),1),e},formatData:function(t){return t[0].values},getClass:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.z.getId.apply(this,e)},getDataPoints:function(t){return t.values},getText:function(t){return i18next.t(t.key,{ns:"railTable"})}},width:800,datatable:!0,tableTitle:""},re=[].sort,oe=[1,2,3];D(D.P+D.F*(l(function(){oe.sort(void 0)})||!l(function(){oe.sort(null)})||!Qt(re)),"Array",{sort:function(t){return void 0===t?re.call(dt(this)):re.call(dt(this),C(t))}});var ie,ae={f:{}.propertyIsEnumerable},ce=ae.f,ue=(ie=!1,function(t){for(var e,n=P(t),r=tt(n),o=r.length,i=0,a=[];i<o;)ce.call(n,e=r[i++])&&a.push(ie?[e,n[e]]:n[e]);return a});D(D.S,"Object",{values:function(t){return ue(t)}});var le,se={aspectRatio:19/6,margin:{top:30,right:0,bottom:20,left:120},alt:i18next.t("alt",{ns:"commodities"}),filterData:function(t){var o,i={},a=[];t.map(function(t){var e=Object.keys(t)[0];o||(o=Object.keys(t[e]));var n=o[o.length-1];i[e]||(i[e]=[]),a.push({key:e,lastYearValue:t[e][n].All});for(var r=0;r<o.length;r++)i[e].push({year:Object.keys(t[e])[r],value:Object.values(t[e])[r].All})}),a.sort(function(t,e){return t.lastYearValue<e.lastYearValue});var n,r=a.map(function(t){return t.key}),c=0,u=[];return Object.keys(i).map(function(t){var e=r[c];u.push(Kt({},t,e)),c++}),Object.keys(i).map(function(e){return u.map(function(t){if(Object.keys(t)[0]===e)return n=Object.values(t)[0]}),{id:n,dataPoints:i[n]}})},x:{getValue:function(t){return t.year},getText:function(t){return t.year}},r:{inverselyProportional:!1,getValue:function(t){return t.value}},z:{getId:function(t){return t.id},getClass:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.z.getId.apply(this,e)},getText:function(t){return i18next.t(t.id,{ns:"commodities"})},getDataPoints:function(t){return t.dataPoints}},width:800},fe=(le=!0,function(t,e){var n,r,o=String(I(t)),i=R(e),a=o.length;return i<0||a<=i?le?"":void 0:(n=o.charCodeAt(i))<55296||56319<n||i+1===a||(r=o.charCodeAt(i+1))<56320||57343<r?le?o.charAt(i):n:le?o.slice(i,i+2):r-56320+(n-55296<<10)+65536});jt(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=fe(e,n),this._i+=t.length,{value:t,done:!1})});var pe=function(e,t,n,r){try{return r?t(a(n)[0],n[1]):t(n)}catch(t){var o=e.return;throw void 0!==o&&a(o.call(e)),t}},de=r("iterator"),ye=Array.prototype,he=function(t,e,n){e in t?m.f(t,e,O(0,n)):t[e]=n},ve=r("toStringTag"),ge="Arguments"==w(function(){return arguments}()),me=r("iterator"),be=h.getIteratorMethod=function(t){if(null!=t)return t[me]||t["@@iterator"]||S[(e=t,void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=function(t,e){try{return t[e]}catch(t){}}(n=Object(e),ve))?r:ge?w(n):"Object"==(o=w(n))&&"function"==typeof n.callee?"Arguments":o)];var e,n,r,o},xe=r("iterator"),je=!1;try{[7][xe]().return=function(){je=!0}}catch(t){}D(D.S+D.F*!function(t,e){if(!e&&!je)return!1;var n=!1;try{var r=[7],o=r[xe]();o.next=function(){return{done:n=!0}},r[xe]=function(){return o},t(r)}catch(t){}return n}(function(t){}),"Array",{from:function(t){var e,n,r,o,i,a=dt(t),c="function"==typeof this?this:Array,u=arguments.length,l=1<u?arguments[1]:void 0,s=void 0!==l,f=0,p=be(a);if(s&&(l=L(l,2<u?arguments[2]:void 0,2)),null!=p&&(c!=Array||(void 0===(i=p)||S.Array!==i&&ye[de]!==i)))for(o=p.call(a),n=new c;!(r=o.next()).done;f++)he(n,f,s?pe(o,l,[r.value,f],!0):r.value);else for(n=new c(e=U(a.length));f<e;f++)he(n,f,s?l(a[f],f):a[f]);return n.length=f,n}});var Oe=Object.getOwnPropertyDescriptor,_e={f:i?Oe:function(t,e){if(t=P(t),e=y(e,!0),d)try{return Oe(t,e)}catch(t){}if(E(t,e))return O(!ae.f.call(t,e),t[e])}},Ae=function(t,e){if(a(t),!u(e)&&null!==e)throw TypeError(e+": can't set as prototype!")},Se={set:Object.setPrototypeOf||("__proto__"in{}?function(t,n,r){try{(r=L(Function.call,_e.f(Object.prototype,"__proto__").set,2))(t,[]),n=!(t instanceof Array)}catch(t){n=!0}return function(t,e){return Ae(t,e),n?t.__proto__=e:r(t,e),t}}({},!1):void 0),check:Ae}.set,Te=Z.concat("length","prototype"),we={f:Object.getOwnPropertyNames||function(t){return J(t,Te)}},Ne="\t\n\v\f\r Â áá ââââââââââââ¯âã\u2028\u2029\ufeff",Ie="["+Ne+"]",Pe=RegExp("^"+Ie+Ie+"*"),ke=RegExp(Ie+Ie+"*$"),Ee=function(t,e,n){var r={},o=l(function(){return!!Ne[t]()||"âÂ"!="âÂ"[t]()}),i=r[t]=o?e(Fe):Ne[t];n&&(r[n]=i),D(D.P+D.F*o,"String",r)},Fe=Ee.trim=function(t,e){return t=String(I(t)),1&e&&(t=t.replace(Pe,"")),2&e&&(t=t.replace(ke,"")),t},Ce=Ee,Le=we.f,Me=_e.f,Be=m.f,De=Ce.trim,Ve="Number",Ge=v[Ve],Re=Ge,ze=Ge.prototype,Ue=w(ut(ze))==Ve,Ye="trim"in String.prototype,He=function(t){var e=y(t,!1);if("string"==typeof e&&2<e.length){var n,r,o,i=(e=Ye?e.trim():De(e,3)).charCodeAt(0);if(43===i||45===i){if(88===(n=e.charCodeAt(2))||120===n)return NaN}else if(48===i){switch(e.charCodeAt(1)){case 66:case 98:r=2,o=49;break;case 79:case 111:r=8,o=55;break;default:return+e}for(var a,c=e.slice(2),u=0,l=c.length;u<l;u++)if((a=c.charCodeAt(u))<48||o<a)return NaN;return parseInt(c,r)}}return+e};if(!Ge(" 0o1")||!Ge("0b1")||Ge("+0x1")){Ge=function(t){var e,n,r,o,i=arguments.length<1?0:t,a=this;return a instanceof Ge&&(Ue?l(function(){ze.valueOf.call(a)}):w(a)!=Ve)?(e=new Re(He(i)),n=Ge,(o=a.constructor)!==n&&"function"==typeof o&&(r=o.prototype)!==n.prototype&&u(r)&&Se&&Se(e,r),e):He(i)};for(var Xe,$e=i?Le(Re):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),qe=0;$e.length>qe;qe++)E(Re,Xe=$e[qe])&&!E(Ge,Xe)&&Be(Ge,Xe,Me(Re,Xe));(Ge.prototype=ze).constructor=Ge,F(v,Ve,Ge)}var Qe,We=[],Ke="AT",Je="QC",Ze="chems",tn=1.5,en={},nn=d3.select(".dashboard .map").append("svg"),rn=570-20-0,on=150-20-10,an=d3.select("#mapColourScale").select("svg").attr("class","mapCB").attr("width",rn).attr("height",on).style("vertical-align","middle");d3.stcExt.addIEShim(nn,387.1,457.5),d3.select("body").append("div").attr("class","tooltip").style("opacity",0);var cn=d3.select(".data.raildata").append("svg").attr("id","svgBar"),un=d3.select("#commgrid").append("svg").attr("id","svg_commgrid");function ln(t){"commodity"===t.target.id&&(Ze=document.getElementById("commodity").value),"originGeo"===t.target.id&&(Ke=document.getElementById("originGeo").value),"destGeo"===t.target.id&&(Je=document.getElementById("destGeo").value),Qe="".concat(Ke,"_").concat(Ze),dn(),function(t,e,r){if(en[Qe]){var n=Jt({},ne,{filterData:fn});r(n)}else d3.json("data/rail/"+t+"_"+e+".json",function(t,e){en[Qe]=e;var n=Jt({},ne,{filterData:fn});r(n)})}(Ke,Ze,function(t){pn(t)})}function sn(){var t=[];t.push(en["".concat(Ke,"_").concat(Ze)][2016]);var e=["#AFE2FF","#72C2FF","#bc9dff","#894FFF","#5D0FBC"],n=function(t,e,n){var r,o=e.slice(-1)[0],i=t[0],a=[];(a=Object.values(i)).sort(function(t,e){return t-e}),r=d3.extent(a);var c=d3.scaleQuantize().domain([r[0],r[1]]).range(e.slice(0,n)),u=function(t){i.hasOwnProperty(t)&&d3.select(".dashboard .map").select("."+t).style("fill",function(){return Number(i[t])?c(i[t]):o}).classed("classNaN",function(){if(!Number(i[t]))return!0})};for(var l in i)u(l);return r}(t,e,e.length);!function(t,n,e,r,o){var i=(e[1]-e[0])/r,a=[];a[0]=e[0];for(var c=1;c<r;c++)a.push(Math.round(c*i+e[0]));var u=function(t,e){return n[e]},l=function(t,e){return t<r?o.formatNum()(a[e])+"+":t===r+1?"x":void 0},s=d3.select("body").append("div").attr("class","tooltip").style("opacity",0);t.append("g").attr("class","colourbarTitle").attr("id","cbTitle").append("text").attr("transform",function(t,e){return"translate(225, 15)"}).style("display",function(){return"inline"});var f=t.attr("class","mapCB").selectAll(".legend").data(Array.from(Array(n.length).keys())),p=f.enter().append("g").attr("class","legend").attr("id",function(t,e){return"cb".concat(e)});p.append("rect").attr("width",35).attr("height",35).attr("y",20).attr("x",function(t,e){return 135+35*e}).attr("fill",u).attr("class",function(t,e){if(e===r+1)return"classNaN"}),p.selectAll(".legend rect").on("mouseover",function(t,e){if("classNaN"===d3.select(this).attr("class")){var n=i18next.t("NaNhover1",{ns:"airUI"}),r=i18next.t("NaNhover2",{ns:"airUI",escapeInterpolation:!1});s.style("opacity",.9).html("<br>"+n+"<br>"+r+"<br><br>").style("left",d3.event.pageX+10+"px").style("top",d3.event.pageY+10+"px")}}).on("mouseout",function(){s.style("opacity",0)}),p.append("text").text(l).attr("text-anchor","end").attr("transform",function(t,e){return e<r?"translate(".concat(140+35*e,", ").concat(65,") rotate(-45)"):e===r+1?"translate(".concat(156+35*e,", ").concat(72,") "):void 0}).style("display",function(){return"inline"}),f.select("rect").attr("fill",u),f.select("text").text(l),f.exit().remove()}(an,e,n,e.length);var r=i18next.t("units",{ns:"rail"});d3.select("#cbTitle").select("text").text(r).attr("transform",function(t,e){return"translate(203, 15)"})}function fn(){var e=this,n=en[Qe];return[{category:"".concat(this.selectedOrig),values:Object.keys(n).map(function(t){return{year:t,value:n[t][e.selectedDest]}})}]}function pn(t){barChart(cn,Jt({},t,{selectedOrig:Ke,selectedDest:Je})),d3.select("#svgBar").select(".x.axis").select("text").attr("display","none"),d3.select("#svgBar").select(".x.axis").selectAll(".tick text").attr("dy","".concat(tn,"em")),dn()}function dn(){var t=i18next.t(Ze,{ns:"commodities"}),e=i18next.t(Ke,{ns:"geography"}),n=i18next.t(Je,{ns:"geography"});d3.select("#railTitleBarChart").text("".concat(t," from ").concat(e," to ").concat(n)),ne.tableTitle=i18next.t("tableTitle",{ns:"railTable",comm:t,orig:e,dest:n})}i18n.load(["src/i18n"],function(){ne.x.label=i18next.t("x_label",{ns:"railBar"}),ne.y.label=i18next.t("y_label",{ns:"railBar"}),ne.z.label=i18next.t("z_label",{ns:"railTable"}),d3.queue().defer(d3.json,"data/rail/All_coal.json").defer(d3.json,"data/rail/All_mixed.json").defer(d3.json,"data/rail/All_wheat.json").defer(d3.json,"data/rail/All_ores.json").defer(d3.json,"data/rail/All_potash.json").defer(d3.json,"data/rail/All_lumber.json").defer(d3.json,"data/rail/All_canola.json").defer(d3.json,"data/rail/All_oils.json").defer(d3.json,"data/rail/All_chems.json").defer(d3.json,"data/rail/All_pulp.json").defer(d3.json,"data/road/CANADA.json").await(function(t,e,n,r,o,i,a,c,u,l,s){var f;We.push({coal:e}),We.push({mixed:n}),We.push({wheat:r}),We.push({ores:o}),We.push({potash:i}),We.push({lumber:a}),We.push({canola:c}),We.push({oils:u}),We.push({chems:l}),We.push({pulp:s}),getCanadaMap(nn).on("loaded",function(){sn()}),d3.select("#mapTitleRail").text(i18next.t("mapTitle",{ns:"rail"})),f=i18next.t("tableTitle",{ns:"railBubbleTable"}),d3.select("#commTableTitle").text(f),bubbleTable(un,se,We),d3.json("data/rail/"+Ke+"_"+Ze+".json",function(t,e){Qe="".concat(Ke,"_").concat(Ze),en[Qe]=e,pn(Jt({},ne,{filterData:fn}))}),dn()})}),$(document).on("change",ln),$(document).on("change",ln),d3.selection.prototype.moveToFront=function(){return this.each(function(){this.parentNode.appendChild(this)})},d3.selection.prototype.moveToBack=function(){return this.each(function(){var t=this.parentNode.firstChild;t&&this.parentNode.insertBefore(this,t)})}}();