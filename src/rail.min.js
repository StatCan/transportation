!function(){"use strict";function t(t,e){return t(e={exports:{}},e.exports),e.exports}var h=t(function(t){var e=t.exports={version:"2.6.3"};"number"==typeof __e&&(__e=e)}),v=(h.version,t(function(t){var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)})),o=t(function(t){var e="__core-js_shared__",n=v[e]||(v[e]={});(t.exports=function(t,e){return n[t]||(n[t]=void 0!==e?e:{})})("versions",[]).push({version:h.version,mode:"global",copyright:"Â© 2019 Denis Pushkarev (zloirock.ru)"})}),e=0,n=Math.random(),u=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++e+n).toString(36))},r=t(function(t){var e=o("wks"),n=v.Symbol,r="function"==typeof n;(t.exports=function(t){return e[t]||(e[t]=r&&n[t]||(r?n:u)("Symbol."+t))}).store=e}),i=function(t){return"object"==typeof t?null!==t:"function"==typeof t},a=function(t){if(!i(t))throw TypeError(t+" is not an object!");return t},c=function(t){try{return!!t()}catch(t){return!0}},l=!c(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),s=v.document,f=i(s)&&i(s.createElement),p=function(t){return f?s.createElement(t):{}},d=!l&&!c(function(){return 7!=Object.defineProperty(p("div"),"a",{get:function(){return 7}}).a}),y=Object.defineProperty,g={f:l?Object.defineProperty:function(t,e,n){if(a(t),e=function(t,e){if(!i(t))return t;var n,r;if(e&&"function"==typeof(n=t.toString)&&!i(r=n.call(t)))return r;if("function"==typeof(n=t.valueOf)&&!i(r=n.call(t)))return r;if(!e&&"function"==typeof(n=t.toString)&&!i(r=n.call(t)))return r;throw TypeError("Can't convert object to primitive value")}(e,!0),a(n),d)try{return y(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},x=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},_=l?function(t,e,n){return g.f(t,e,x(1,n))}:function(t,e,n){return t[e]=n,t},b=r("unscopables"),m=Array.prototype;null==m[b]&&_(m,b,{});var j=function(t){m[b][t]=!0},O=function(t,e){return{value:e,done:!!t}},T={},S={}.toString,w=function(t){return S.call(t).slice(8,-1)},A=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==w(t)?t.split(""):Object(t)},k=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t},P=function(t){return A(k(t))},L={}.hasOwnProperty,E=function(t,e){return L.call(t,e)},M=t(function(t){var i=u("src"),e="toString",n=Function[e],a=(""+n).split(e);h.inspectSource=function(t){return n.call(t)},(t.exports=function(t,e,n,r){var o="function"==typeof n;o&&(E(n,"name")||_(n,"name",e)),t[e]!==n&&(o&&(E(n,i)||_(n,i,t[e]?""+t[e]:a.join(String(e)))),t===v?t[e]=n:r?t[e]?t[e]=n:_(t,e,n):(delete t[e],_(t,e,n)))})(Function.prototype,e,function(){return"function"==typeof this&&this[i]||n.call(this)})}),I=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t},B=function(r,o,t){if(I(r),void 0===o)return r;switch(t){case 1:return function(t){return r.call(o,t)};case 2:return function(t,e){return r.call(o,t,e)};case 3:return function(t,e,n){return r.call(o,t,e,n)}}return function(){return r.apply(o,arguments)}},C="prototype",D=function(t,e,n){var r,o,i,a,u=t&D.F,c=t&D.G,l=t&D.S,s=t&D.P,f=t&D.B,p=c?v:l?v[e]||(v[e]={}):(v[e]||{})[C],d=c?h:h[e]||(h[e]={}),y=d[C]||(d[C]={});for(r in c&&(n=e),n)i=((o=!u&&p&&void 0!==p[r])?p:n)[r],a=f&&o?B(i,v):s&&"function"==typeof i?B(Function.call,i):i,p&&M(p,r,i,t&D.U),d[r]!=i&&_(d,r,a),s&&y[r]!=i&&(y[r]=i)};v.core=h,D.F=1,D.G=2,D.S=4,D.P=8,D.B=16,D.W=32,D.U=64,D.R=128;var F=D,G=Math.ceil,V=Math.floor,z=function(t){return isNaN(t=+t)?0:(0<t?V:G)(t)},R=Math.min,N=function(t){return 0<t?R(z(t),9007199254740991):0},H=Math.max,Y=Math.min,q=function(l){return function(t,e,n){var r,o,i,a=P(t),u=N(a.length),c=(o=u,(r=z(r=n))<0?H(r+o,0):Y(r,o));if(l&&e!=e){for(;c<u;)if((i=a[c++])!=i)return!0}else for(;c<u;c++)if((l||c in a)&&a[c]===e)return l||c||0;return!l&&-1}},U=o("keys"),W=function(t){return U[t]||(U[t]=u(t))},K=q(!1),Q=W("IE_PROTO"),J="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),X=Object.keys||function(t){return function(t,e){var n,r=P(t),o=0,i=[];for(n in r)n!=Q&&E(r,n)&&i.push(n);for(;e.length>o;)E(r,n=e[o++])&&(~K(i,n)||i.push(n));return i}(t,J)},Z=l?Object.defineProperties:function(t,e){a(t);for(var n,r=X(e),o=r.length,i=0;i<o;)g.f(t,n=r[i++],e[n]);return t},tt=v.document,et=tt&&tt.documentElement,nt=W("IE_PROTO"),rt=function(){},ot="prototype",it=function(){var t,e=p("iframe"),n=J.length;for(e.style.display="none",et.appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),it=t.F;n--;)delete it[ot][J[n]];return it()},at=Object.create||function(t,e){var n;return null!==t?(rt[ot]=a(t),n=new rt,rt[ot]=null,n[nt]=t):n=it(),void 0===e?n:Z(n,e)},ut=g.f,ct=r("toStringTag"),lt=function(t,e,n){t&&!E(t=n?t:t.prototype,ct)&&ut(t,ct,{configurable:!0,value:e})},st={};_(st,r("iterator"),function(){return this});var ft=function(t){return Object(k(t))},pt=W("IE_PROTO"),dt=Object.prototype,yt=Object.getPrototypeOf||function(t){return t=ft(t),E(t,pt)?t[pt]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?dt:null},ht=r("iterator"),vt=!([].keys&&"next"in[].keys()),gt="values",bt=function(){return this},mt=function(t,e,n,r,o,i,a){var u,c,l;c=e,l=r,(u=n).prototype=at(st,{next:x(1,l)}),lt(u,c+" Iterator");var s,f,p,d=function(t){if(!vt&&t in g)return g[t];switch(t){case"keys":case gt:return function(){return new n(this,t)}}return function(){return new n(this,t)}},y=e+" Iterator",h=o==gt,v=!1,g=t.prototype,b=g[ht]||g["@@iterator"]||o&&g[o],m=b||d(o),j=o?h?d("entries"):m:void 0,O="Array"==e&&g.entries||b;if(O&&(p=yt(O.call(new t)))!==Object.prototype&&p.next&&(lt(p,y,!0),"function"!=typeof p[ht]&&_(p,ht,bt)),h&&b&&b.name!==gt&&(v=!0,m=function(){return b.call(this)}),(vt||v||!g[ht])&&_(g,ht,m),T[e]=m,T[y]=bt,o)if(s={values:h?m:d(gt),keys:i?m:d("keys"),entries:j},a)for(f in s)f in g||M(g,f,s[f]);else F(F.P+F.F*(vt||v),e,s);return s}(Array,"Array",function(t,e){this._t=P(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,O(1)):O(0,"keys"==e?n:"values"==e?t[n]:[n,t[n]])},"values");T.Arguments=T.Array,j("keys"),j("values"),j("entries");for(var jt=r("iterator"),Ot=r("toStringTag"),xt=T.Array,_t={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},Tt=X(_t),St=0;St<Tt.length;St++){var wt,At=Tt[St],kt=_t[At],Pt=v[At],Lt=Pt&&Pt.prototype;if(Lt&&(Lt[jt]||_(Lt,jt,xt),Lt[Ot]||_(Lt,Ot,At),T[At]=xt,kt))for(wt in mt)Lt[wt]||M(Lt,wt,mt[wt],!0)}var Et,Mt,It,Bt;Et="keys",Mt=function(){return function(t){return X(ft(t))}},It=(h.Object||{})[Et]||Object[Et],(Bt={})[Et]=Mt(It),F(F.S+F.F*c(function(){It(1)}),"Object",Bt);var Ct,Dt,Ft,Gt,Vt,zt,Rt,Nt,Ht,Yt=Array.isArray||function(t){return"Array"==w(t)},qt=r("species"),Ut=function(t,e){return!!t&&c(function(){e?t.call(null,function(){},1):t.call(null)})},Wt=(Ft=(Ct=1)==Ct,Gt=2==Ct,Vt=3==Ct,zt=4==Ct,Rt=6==Ct,Nt=5==Ct||Rt,Ht=Dt||function(t,e){return Yt(n=t)&&("function"!=typeof(r=n.constructor)||r!==Array&&!Yt(r.prototype)||(r=void 0),i(r)&&null===(r=r[qt])&&(r=void 0)),new(void 0===r?Array:r)(e);var n,r},function(t,e,n){for(var r,o,i=ft(t),a=A(i),u=B(e,n,3),c=N(a.length),l=0,s=Ft?Ht(t,c):Gt?Ht(t,0):void 0;l<c;l++)if((Nt||l in a)&&(o=u(r=a[l],l,i),Ct))if(Ft)s[l]=o;else if(o)switch(Ct){case 3:return!0;case 5:return r;case 6:return l;case 2:s.push(r)}else if(zt)return!1;return Rt?-1:Vt||zt?zt:s});function Kt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),r.forEach(function(t){Kt(e,t,n[t])})}return e}F(F.P+F.F*!Ut([].map,!0),"Array",{map:function(t){return Wt(this,t,arguments[1])}});var $t=q(!1),Jt=[].indexOf,Xt=!!Jt&&1/[1].indexOf(1,-0)<0;F(F.P+F.F*(Xt||!Ut(Jt)),"Array",{indexOf:function(t){return Xt?Jt.apply(this,arguments)||0:$t(this,t,arguments[1])}});var Zt={aspectRatio:2,margin:{top:50,left:50,bottom:50},x:{label:i18next.t("x_label",{ns:"railBar"}),getId:function(t){return t.year},getValue:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.x.getId.apply(this,e)},getClass:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.x.getId.apply(this,e)},getTickText:function(t){return i18next.t(t,{ns:"railBar"})}},y:{label:i18next.t("y_label",{ns:"railBar"}),getValue:function(t){return t.value},getText:function(t){return t.value},ticks:10,tickSizeOuter:0},z:{label:i18next.t("z_label",{ns:"railTable"}),getId:function(t){return t.category},getKeys:function(t){var e=Object.keys(t[0]);return e.splice(e.indexOf("category"),1),e},formatData:function(t){return t[0].values},getClass:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.z.getId.apply(this,e)},getDataPoints:function(t){return t.values},getText:function(t){return i18next.t(t.key,{ns:"railTable"})}},width:800,datatable:!0,tableTitle:""},te=[].sort,ee=[1,2,3];F(F.P+F.F*(c(function(){ee.sort(void 0)})||!c(function(){ee.sort(null)})||!Ut(te)),"Array",{sort:function(t){return void 0===t?te.call(ft(this)):te.call(ft(this),I(t))}});var ne,re={f:{}.propertyIsEnumerable}.f,oe=(ne=!1,function(t){for(var e,n=P(t),r=X(n),o=r.length,i=0,a=[];i<o;)re.call(n,e=r[i++])&&a.push(ne?[e,n[e]]:n[e]);return a});F(F.S,"Object",{values:function(t){return oe(t)}});var ie,ae={aspectRatio:19/6,margin:{top:30,right:0,bottom:20,left:120},alt:i18next.t("alt",{ns:"commodities"}),filterData:function(t){var o,i={},a=[];t.map(function(t){var e=Object.keys(t)[0];o||(o=Object.keys(t[e]));var n=o[o.length-1];i[e]||(i[e]=[]),a.push({key:e,lastYearValue:t[e][n].All});for(var r=0;r<o.length;r++)i[e].push({year:Object.keys(t[e])[r],value:Object.values(t[e])[r].All})}),a.sort(function(t,e){return t.lastYearValue<e.lastYearValue});var n,r=a.map(function(t){return t.key}),u=0,c=[];return Object.keys(i).map(function(t){var e=r[u];c.push(Kt({},t,e)),u++}),Object.keys(i).map(function(e){return c.map(function(t){if(Object.keys(t)[0]===e)return n=Object.values(t)[0]}),{id:n,dataPoints:i[n]}})},x:{getValue:function(t){return t.year},getText:function(t){return t.year}},r:{inverselyProportional:!1,getValue:function(t){return t.value}},z:{getId:function(t){return t.id},getClass:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.z.getId.apply(this,e)},getText:function(t){return i18next.t(t.id,{ns:"commodities"})},getDataPoints:function(t){return t.dataPoints}},width:800},ue=[],ce="AT",le="QC",se="chems",fe=1.5,pe={},de=d3.select(".data.raildata").append("svg").attr("id","svgBar"),ye=d3.select("#commgrid").append("svg").attr("id","svg_commgrid");function he(){var e=this,n=pe[ie];return[{category:"".concat(this.selectedOrig),values:Object.keys(n).map(function(t){return{year:t,value:n[t][e.selectedDest]/1e3}})}]}function ve(t){barChart(de,Qt({},t,{selectedOrig:ce,selectedDest:le})),d3.select("#svgBar").select(".x.axis").select("text").attr("display","none"),d3.select("#svgBar").select(".x.axis").selectAll(".tick text").attr("dy","".concat(fe,"em")),ge()}function ge(){var t=i18next.t(se,{ns:"commodities"}),e=i18next.t(ce,{ns:"railGeography"}),n=i18next.t(le,{ns:"railGeography"});d3.select("#railTitleBarChart").text("".concat(t," from ").concat(e," to ").concat(n)),Zt.tableTitle=i18next.t("tableTitle",{ns:"railTable",comm:t,orig:e,dest:n})}i18n.load(["src/i18n"],function(){Zt.x.label=i18next.t("x_label",{ns:"railBar"}),Zt.y.label=i18next.t("y_label",{ns:"railBar"}),Zt.z.label=i18next.t("z_label",{ns:"railTable"}),d3.queue().defer(d3.json,"data/rail/All_coal.json").defer(d3.json,"data/rail/All_mixed.json").defer(d3.json,"data/rail/All_wheat.json").defer(d3.json,"data/rail/All_ores.json").defer(d3.json,"data/rail/All_potash.json").defer(d3.json,"data/rail/All_lumber.json").defer(d3.json,"data/rail/All_canola.json").defer(d3.json,"data/rail/All_oils.json").defer(d3.json,"data/rail/All_chems.json").defer(d3.json,"data/rail/All_pulp.json").await(function(t,e,n,r,o,i,a,u,c,l,s){var f;ue.push({coal:e}),ue.push({mixed:n}),ue.push({wheat:r}),ue.push({ores:o}),ue.push({potash:i}),ue.push({lumber:a}),ue.push({canola:u}),ue.push({oils:c}),ue.push({chems:l}),ue.push({pulp:s}),f=i18next.t("tableTitle",{ns:"railBubbleTable"}),d3.select("#commTableTitle").text(f),bubbleTable(ye,ae,ue),d3.json("data/rail/"+ce+"_"+se+".json",function(t,e){ie="".concat(ce,"_").concat(se),pe[ie]=e,ve(Qt({},Zt,{filterData:he}))}),ge()})}),$(document).on("change",function(t){"commodity"===t.target.id&&(se=document.getElementById("commodity").value),"originGeo"===t.target.id&&(ce=document.getElementById("originGeo").value),"destGeo"===t.target.id&&(le=document.getElementById("destGeo").value),ie="".concat(ce,"_").concat(se),ge(),function(t,e,r){if(pe[ie]){var n=Qt({},Zt,{filterData:he});r(n)}else d3.json("data/rail/"+t+"_"+e+".json",function(t,e){pe[ie]=e;var n=Qt({},Zt,{filterData:he});r(n)})}(ce,se,function(t){ve(t)})})}();