!function(){"use strict";function t(t,e){return t(e={exports:{}},e.exports),e.exports}var v=t(function(t){var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)}),g=t(function(t){var e=t.exports={version:"2.6.3"};"number"==typeof __e&&(__e=e)}),p=(g.version,function(t){return"object"==typeof t?null!==t:"function"==typeof t}),O=function(t){if(!p(t))throw TypeError(t+" is not an object!");return t},s=function(t){try{return!!t()}catch(t){return!0}},e=!s(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),n=v.document,r=p(n)&&p(n.createElement),i=function(t){return r?n.createElement(t):{}},o=!e&&!s(function(){return 7!=Object.defineProperty(i("div"),"a",{get:function(){return 7}}).a}),a=Object.defineProperty,c={f:e?Object.defineProperty:function(t,e,n){if(O(t),e=function(t,e){if(!p(t))return t;var n,r;if(e&&"function"==typeof(n=t.toString)&&!p(r=n.call(t)))return r;if("function"==typeof(n=t.valueOf)&&!p(r=n.call(t)))return r;if(!e&&"function"==typeof(n=t.toString)&&!p(r=n.call(t)))return r;throw TypeError("Can't convert object to primitive value")}(e,!0),O(n),o)try{return a(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},S=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},T=e?function(t,e,n){return c.f(t,e,S(1,n))}:function(t,e,n){return t[e]=n,t},l={}.hasOwnProperty,u=function(t,e){return l.call(t,e)},f=0,d=Math.random(),y=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++f+d).toString(36))},A=t(function(t){var o=y("src"),e="toString",n=Function[e],a=(""+n).split(e);g.inspectSource=function(t){return n.call(t)},(t.exports=function(t,e,n,r){var i="function"==typeof n;i&&(u(n,"name")||T(n,"name",e)),t[e]!==n&&(i&&(u(n,o)||T(n,o,t[e]?""+t[e]:a.join(String(e)))),t===v?t[e]=n:r?t[e]?t[e]=n:T(t,e,n):(delete t[e],T(t,e,n)))})(Function.prototype,e,function(){return"function"==typeof this&&this[o]||n.call(this)})}),j=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t},h=function(r,i,t){if(j(r),void 0===i)return r;switch(t){case 1:return function(t){return r.call(i,t)};case 2:return function(t,e){return r.call(i,t,e)};case 3:return function(t,e,n){return r.call(i,t,e,n)}}return function(){return r.apply(i,arguments)}},x="prototype",m=function(t,e,n){var r,i,o,a,c=t&m.F,l=t&m.G,u=t&m.S,s=t&m.P,f=t&m.B,d=l?v:u?v[e]||(v[e]={}):(v[e]||{})[x],p=l?g:g[e]||(g[e]={}),y=p[x]||(p[x]={});for(r in l&&(n=e),n)o=((i=!c&&d&&void 0!==d[r])?d:n)[r],a=f&&i?h(o,v):s&&"function"==typeof o?h(Function.call,o):o,d&&A(d,r,o,t&m.U),p[r]!=o&&T(p,r,a),s&&y[r]!=o&&(y[r]=o)};v.core=g,m.F=1,m.G=2,m.S=4,m.P=8,m.B=16,m.W=32,m.U=64,m.R=128;var b,_,w,k,E,L,P,C,M,R=m,F={}.toString,I=function(t){return F.call(t).slice(8,-1)},B=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==I(t)?t.split(""):Object(t)},V=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t},D=function(t){return Object(V(t))},G=Math.ceil,N=Math.floor,z=function(t){return isNaN(t=+t)?0:(0<t?N:G)(t)},H=Math.min,U=function(t){return 0<t?H(z(t),9007199254740991):0},K=Array.isArray||function(t){return"Array"==I(t)},W=t(function(t){var e="__core-js_shared__",n=v[e]||(v[e]={});(t.exports=function(t,e){return n[t]||(n[t]=void 0!==e?e:{})})("versions",[]).push({version:g.version,mode:"global",copyright:"Â© 2019 Denis Pushkarev (zloirock.ru)"})}),q=t(function(t){var e=W("wks"),n=v.Symbol,r="function"==typeof n;(t.exports=function(t){return e[t]||(e[t]=r&&n[t]||(r?n:y)("Symbol."+t))}).store=e}),Q=q("species"),X=function(t,e){return!!t&&s(function(){e?t.call(null,function(){},1):t.call(null)})},Y=(w=1==(b=2),k=2==b,E=3==b,L=4==b,P=6==b,C=5==b||P,M=_||function(t,e){return K(n=t)&&("function"!=typeof(r=n.constructor)||r!==Array&&!K(r.prototype)||(r=void 0),p(r)&&null===(r=r[Q])&&(r=void 0)),new(void 0===r?Array:r)(e);var n,r},function(t,e,n){for(var r,i,o=D(t),a=B(o),c=h(e,n,3),l=U(a.length),u=0,s=w?M(t,l):k?M(t,0):void 0;u<l;u++)if((C||u in a)&&(i=c(r=a[u],u,o),b))if(w)s[u]=i;else if(i)switch(b){case 3:return!0;case 5:return r;case 6:return u;case 2:s.push(r)}else if(L)return!1;return P?-1:E||L?L:s});R(R.P+R.F*!X([].filter,!0),"Array",{filter:function(t){return Y(this,t,arguments[1])}});var J=q("unscopables"),Z=Array.prototype;null==Z[J]&&T(Z,J,{});var tt=function(t){Z[J][t]=!0},et=function(t,e){return{value:e,done:!!t}},nt={},rt=function(t){return B(V(t))},it=Math.max,ot=Math.min,at=function(u){return function(t,e,n){var r,i,o,a=rt(t),c=U(a.length),l=(i=c,(r=z(r=n))<0?it(r+i,0):ot(r,i));if(u&&e!=e){for(;l<c;)if((o=a[l++])!=o)return!0}else for(;l<c;l++)if((u||l in a)&&a[l]===e)return u||l||0;return!u&&-1}},ct=W("keys"),lt=function(t){return ct[t]||(ct[t]=y(t))},ut=at(!1),st=lt("IE_PROTO"),ft="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),dt=Object.keys||function(t){return function(t,e){var n,r=rt(t),i=0,o=[];for(n in r)n!=st&&u(r,n)&&o.push(n);for(;e.length>i;)u(r,n=e[i++])&&(~ut(o,n)||o.push(n));return o}(t,ft)},pt=e?Object.defineProperties:function(t,e){O(t);for(var n,r=dt(e),i=r.length,o=0;o<i;)c.f(t,n=r[o++],e[n]);return t},yt=v.document,vt=yt&&yt.documentElement,gt=lt("IE_PROTO"),ht=function(){},xt="prototype",mt=function(){var t,e=i("iframe"),n=ft.length;for(e.style.display="none",vt.appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),mt=t.F;n--;)delete mt[xt][ft[n]];return mt()},bt=Object.create||function(t,e){var n;return null!==t?(ht[xt]=O(t),n=new ht,ht[xt]=null,n[gt]=t):n=mt(),void 0===e?n:pt(n,e)},_t=c.f,St=q("toStringTag"),Tt=function(t,e,n){t&&!u(t=n?t:t.prototype,St)&&_t(t,St,{configurable:!0,value:e})},Ot={};T(Ot,q("iterator"),function(){return this});var At=lt("IE_PROTO"),jt=Object.prototype,wt=Object.getPrototypeOf||function(t){return t=D(t),u(t,At)?t[At]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?jt:null},kt=q("iterator"),Et=!([].keys&&"next"in[].keys()),Lt="values",Pt=function(){return this},Ct=function(t,e,n,r,i,o,a){var c,l,u;l=e,u=r,(c=n).prototype=bt(Ot,{next:S(1,u)}),Tt(c,l+" Iterator");var s,f,d,p=function(t){if(!Et&&t in h)return h[t];switch(t){case"keys":case Lt:return function(){return new n(this,t)}}return function(){return new n(this,t)}},y=e+" Iterator",v=i==Lt,g=!1,h=t.prototype,x=h[kt]||h["@@iterator"]||i&&h[i],m=x||p(i),b=i?v?p("entries"):m:void 0,_="Array"==e&&h.entries||x;if(_&&(d=wt(_.call(new t)))!==Object.prototype&&d.next&&(Tt(d,y,!0),"function"!=typeof d[kt]&&T(d,kt,Pt)),v&&x&&x.name!==Lt&&(g=!0,m=function(){return x.call(this)}),(Et||g||!h[kt])&&T(h,kt,m),nt[e]=m,nt[y]=Pt,i)if(s={values:v?m:p(Lt),keys:o?m:p("keys"),entries:b},a)for(f in s)f in h||A(h,f,s[f]);else R(R.P+R.F*(Et||g),e,s);return s}(Array,"Array",function(t,e){this._t=rt(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,et(1)):et(0,"keys"==e?n:"values"==e?t[n]:[n,t[n]])},"values");nt.Arguments=nt.Array,tt("keys"),tt("values"),tt("entries");for(var Mt=q("iterator"),Rt=q("toStringTag"),Ft=nt.Array,It={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},Bt=dt(It),Vt=0;Vt<Bt.length;Vt++){var Dt,Gt=Bt[Vt],Nt=It[Gt],zt=v[Gt],Ht=zt&&zt.prototype;if(Ht&&(Ht[Mt]||T(Ht,Mt,Ft),Ht[Rt]||T(Ht,Rt,Gt),nt[Gt]=Ft,Nt))for(Dt in Ct)Ht[Dt]||A(Ht,Dt,Ct[Dt],!0)}var Ut,$t,Kt,Wt;Ut="keys",$t=function(){return function(t){return dt(D(t))}},Kt=(g.Object||{})[Ut]||Object[Ut],(Wt={})[Ut]=$t(Kt),R(R.S+R.F*s(function(){Kt(1)}),"Object",Wt);var qt,Qt,Xt,Yt=q("match"),Jt=q("species"),Zt=(qt=!0,function(t,e){var n,r,i=String(V(t)),o=z(e),a=i.length;return o<0||a<=o?qt?"":void 0:(n=i.charCodeAt(o))<55296||56319<n||o+1===a||(r=i.charCodeAt(o+1))<56320||57343<r?qt?i.charAt(o):n:qt?i.slice(o,o+2):r-56320+(n-55296<<10)+65536}),te=q("toStringTag"),ee="Arguments"==I(function(){return arguments}()),ne=RegExp.prototype.exec,re=function(t,e){var n,r,i,o,a=t.exec;if("function"==typeof a){var c=a.call(t,e);if("object"!=typeof c)throw new TypeError("RegExp exec method returned something other than an Object or null");return c}if("RegExp"!==(void 0===(n=t)?"Undefined":null===n?"Null":"string"==typeof(i=function(t,e){try{return t[e]}catch(t){}}(r=Object(n),te))?i:ee?I(r):"Object"==(o=I(r))&&"function"==typeof r.callee?"Arguments":o))throw new TypeError("RegExp#exec called on incompatible receiver");return ne.call(t,e)},ie=RegExp.prototype.exec,oe=String.prototype.replace,ae=ie,ce="lastIndex",le=(Qt=/a/,Xt=/b*/g,ie.call(Qt,"a"),ie.call(Xt,"a"),0!==Qt[ce]||0!==Xt[ce]),ue=void 0!==/()??/.exec("")[1];(le||ue)&&(ae=function(t){var e,n,r,i,o=this;return ue&&(n=new RegExp("^"+o.source+"$(?!\\s)",function(){var t=O(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}.call(o))),le&&(e=o[ce]),r=ie.call(o,t),le&&r&&(o[ce]=o.global?r.index+r[0].length:e),ue&&r&&1<r.length&&oe.call(r[0],n,function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(r[i]=void 0)}),r});var se=ae;R({target:"RegExp",proto:!0,forced:se!==/./.exec},{exec:se});var fe=q("species"),de=!s(function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")}),pe=function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var n="ab".split(t);return 2===n.length&&"a"===n[0]&&"b"===n[1]}(),ye=Math.min,ve=[].push,ge="split",he="length",xe="lastIndex",me=4294967295,be=!s(function(){});!function(n,t,e){var r=q(n),o=!s(function(){var t={};return t[r]=function(){return 7},7!=""[n](t)}),i=o?!s(function(){var t=!1,e=/a/;return e.exec=function(){return t=!0,null},"split"===n&&(e.constructor={},e.constructor[fe]=function(){return e}),e[r](""),!t}):void 0;if(!o||!i||"replace"===n&&!de||"split"===n&&!pe){var a=/./[r],c=e(V,r,""[n],function(t,e,n,r,i){return e.exec===se?o&&!i?{done:!0,value:a.call(e,n,r)}:{done:!0,value:t.call(n,e,r)}:{done:!1}}),l=c[0],u=c[1];A(String.prototype,n,l),T(RegExp.prototype,r,2==t?function(t,e){return u.call(t,this,e)}:function(t){return u.call(t,this)})}}("split",2,function(i,o,_,S){var T;return T="c"=="abbc"[ge](/(b)*/)[1]||4!="test"[ge](/(?:)/,-1)[he]||2!="ab"[ge](/(?:ab)*/)[he]||4!="."[ge](/(.?)(.?)/)[he]||1<"."[ge](/()()/)[he]||""[ge](/.?/)[he]?function(t,e){var n,r,i=String(this);if(void 0===t&&0===e)return[];if(!p(n=t)||(void 0!==(r=n[Yt])?!r:"RegExp"!=I(n)))return _.call(i,t,e);for(var o,a,c,l=[],u=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),s=0,f=void 0===e?me:e>>>0,d=new RegExp(t.source,u+"g");(o=se.call(d,i))&&!(s<(a=d[xe])&&(l.push(i.slice(s,o.index)),1<o[he]&&o.index<i[he]&&ve.apply(l,o.slice(1)),c=o[0][he],s=a,l[he]>=f));)d[xe]===o.index&&d[xe]++;return s===i[he]?!c&&d.test("")||l.push(""):l.push(i.slice(s)),l[he]>f?l.slice(0,f):l}:"0"[ge](void 0,0)[he]?function(t,e){return void 0===t&&0===e?[]:_.call(this,t,e)}:_,[function(t,e){var n=i(this),r=null==t?void 0:t[o];return void 0!==r?r.call(t,n,e):T.call(String(n),t,e)},function(t,e){var n=S(T,t,this,e,T!==_);if(n.done)return n.value;var r,i,o,a=O(t),c=String(this),l=(r=RegExp,void 0===(o=O(a).constructor)||null==(i=O(o)[Jt])?r:j(i)),u=a.unicode,s=(a.ignoreCase?"i":"")+(a.multiline?"m":"")+(a.unicode?"u":"")+(be?"y":"g"),f=new l(be?a:"^(?:"+a.source+")",s),d=void 0===e?me:e>>>0;if(0===d)return[];if(0===c.length)return null===re(f,c)?[c]:[];for(var p,y,v=0,g=0,h=[];g<c.length;){f.lastIndex=be?g:0;var x,m=re(f,be?c:c.slice(g));if(null===m||(x=ye(U(f.lastIndex+(be?0:g)),c.length))===v)p=c,g=(y=g)+(u?Zt(p,y).length:1);else{if(h.push(c.slice(v,g)),h.length===d)return h;for(var b=1;b<=m.length-1;b++)if(h.push(m[b]),h.length===d)return h;g=v=x}}return h.push(c.slice(v)),h}]});var _e=at(!1),Se=[].indexOf,Te=!!Se&&1/[1].indexOf(1,-0)<0;R(R.P+R.F*(Te||!X(Se)),"Array",{indexOf:function(t){return Te?Se.apply(this,arguments)||0:_e(this,t,arguments[1])}});var Oe={aspectRatio:5,alt:i18next.t("alt",{ns:"area"}),filterData:function(t){return t.tonnage},x:{getValue:function(t){return new Date(t.year+"-01")},getText:function(t){return t.year},ticks:10},y:{label:i18next.t("y_label",{ns:"area"}),getValue:function(t,e){return"string"==typeof t[e]||t[e]instanceof String?0:1*t[e]/1e3},getText:function(t,e){return"string"==typeof t[e]||t[e]instanceof String?t[e]:1*t[e]/1e3},ticks:2},z:{label:i18next.t("z_label",{ns:"area"}),getId:function(t){return t.key},getKeys:function(t){var e=Object.keys(t[0]);return e.splice(e.indexOf("year"),1),-1!==e.indexOf(this.y.totalProperty)&&e.splice(e.indexOf(this.y.totalProperty),1),e},getClass:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.z.getId.apply(this,e)},getText:function(t){return i18next.t(t.key,{ns:"area"})}},datatable:!1,transition:!1,width:900},Ae={},je="ATR",we="meat",ke=we+"_from_"+je,Ee=we+"_to_"+je,Le=d3.format(","),Pe=50,Ce=750-Pe-0,Me=40-0-0,Re=d3.select("#areaLegend").append("svg:svg").attr("width",Ce).attr("height",Me).style("vertical-align","middle").selectAll("rect").data(["ATR","QC","ON","MB","SK","AB","BC"]).enter().append("g");Re.append("rect").attr("class",function(t){return"rect "+t}).attr("width",15).attr("height",15).attr("y",5).attr("x",function(t,e){return Pe+100*e}),Re.append("text").attr("class",function(t){return"legendText forAreaChart rect-"+t}).attr("x",function(t,e){return Pe+20+100*e}).attr("y",15).text(function(t){return t}),Re.on("mouseover",function(t){var e=d3.select(this)._groups[0][0].__data__;d3.selectAll(".area:not( ."+e+")").classed("inactive-region",!0),d3.selectAll(".rect:not(."+e+")").classed("inactive-region",!0),d3.selectAll("text.forAreaChart:not(.rect-"+e+")").classed("inactive-region",!0)}).on("mouseout",function(t){d3.selectAll(".area").classed("inactive-region",!1),d3.selectAll(".rect").classed("inactive-region",!1),d3.selectAll("text.legendText").classed("inactive-region",!1)});var Fe=d3.select("body").append("div").attr("class","tooltip").style("opacity",0),Ie=d3.select("#annualTimeseries").append("div").attr("class","remove").style("position","absolute").style("z-index","19").style("width","2px").style("height","500px").style("top","10px").style("bottom","30px").style("left","0px").style("background","#ccc"),Be={106:2002,199:2004,292:2006,382:2008,481:2010,568:2012,684:2014,620:2016},Ve=d3.select("#destTimeseries").append("svg"),De=d3.select("#origTimeseries").append("svg"),Ge=0;function Ne(){areaChart(Ve,Oe,Ae[ke]),areaChart(De,Oe,Ae[Ee]),d3.selectAll(".area-label").style("display","none"),d3.select("#destTimeseriesTitle").text("From "+i18next.t(je,{ns:"regions"})+", all destinations"),d3.select("#origTimeseriesTitle").text("To "+i18next.t(je,{ns:"regions"})+", all origins")}i18n.load(["src/i18n"],function(){d3.json("data/rail/rail_"+we+"_orig"+je+"_all_dest.json",function(t,e){var l,u;Ae[ke]=e,d3.json("data/rail/rail_"+we+"_all_orig_to_"+je+".json",function(t,e){Ae[Ee]=e,areaChart(Ve,Oe,Ae[ke]),areaChart(De,Oe,Ae[Ee]),d3.selectAll(".area-label").style("display","none"),d3.select("#destTimeseriesTitle").text("From "+i18next.t(je,{ns:"regions"})+", all destinations"),d3.select("#origTimeseriesTitle").text("To "+i18next.t(je,{ns:"regions"})+", all origins"),Ve.selectAll(".data").selectAll("path.area").on("mouseover",function(t,e){var n=e+1;d3.selectAll(".area:not(.area"+n+")").classed("inactive-region",!0);for(var r=d3.select(".area"+n).attr("class").split("area area"+n+" ")[1],i=Object.keys(Be),o=0;o<i.length;o++)if(i[o]>l){u=Be[i[o]];break}var a,c=t.filter(function(t){return t.data.year===u})[0].data[r];Fe.transition().style("opacity",.9),Fe.html("<b>"+u+"</b><br><br><table><tr><td>"+r+": </td><td><b>"+(a=c,Le(a))+"  </td><td>  . Mtons</td></tr></table>").style("left",d3.event.pageX+"px").style("top",d3.event.pageY+"px")}).on("mouseout",function(t,e){d3.selectAll(".area").classed("inactive-region",!1),Fe.transition().style("opacity",0)}),d3.select("#annualTimeseries").on("mousemove",function(){l=(l=d3.mouse(this))[0]+5,Ie.style("left",l+"px")}).on("mouseover",function(){l=(l=d3.mouse(this))[0]+5,Ie.style("left",l+"px")}),d3.select("#prevButton").classed("inactive",!0),d3.select("#nextButton").on("click",function(){0===++Ge?d3.select("#prevButton").classed("inactive",!0):d3.select("#prevButton").classed("inactive",!1)}),d3.select("#prevButton").on("click",function(){0===--Ge?d3.select("#prevButton").classed("inactive",!0):d3.select("#prevButton").classed("inactive",!1)})})})}),$(document).on("change",function(t){"commodity"===t.target.id&&(we=document.getElementById("commodity").value),"region"===t.target.id&&(je=document.getElementById("region").value),Ee=we+"_to_"+je,Ae[ke=we+"_from_"+je]?Ne():d3.json("data/rail/rail_"+we+"_orig"+je+"_all_dest.json",function(t,e){Ae[ke]=e,d3.json("data/rail/rail_"+we+"_all_orig_to_"+je+".json",function(t,e){Ae[Ee]=e,Ne()})})})}();