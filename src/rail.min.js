!function(){"use strict";function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function t(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),r.forEach(function(t){u(e,t,n[t])})}return e}function e(t,e){return t(e={exports:{}},e.exports),e.exports}var v=e(function(t){var e=t.exports={version:"2.6.3"};"number"==typeof __e&&(__e=e)}),y=(v.version,e(function(t){var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)})),o=e(function(t){var e="__core-js_shared__",n=y[e]||(y[e]={});(t.exports=function(t,e){return n[t]||(n[t]=void 0!==e?e:{})})("versions",[]).push({version:v.version,mode:"global",copyright:"Â© 2019 Denis Pushkarev (zloirock.ru)"})}),n=0,r=Math.random(),s=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++n+r).toString(36))},a=e(function(t){var e=o("wks"),n=y.Symbol,r="function"==typeof n;(t.exports=function(t){return e[t]||(e[t]=r&&n[t]||(r?n:s)("Symbol."+t))}).store=e}),c=function(t){return"object"==typeof t?null!==t:"function"==typeof t},h=function(t){if(!c(t))throw TypeError(t+" is not an object!");return t},l=function(t){try{return!!t()}catch(t){return!0}},f=!l(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),d=y.document,p=c(d)&&c(d.createElement),m=function(t){return p?d.createElement(t):{}},g=!f&&!l(function(){return 7!=Object.defineProperty(m("div"),"a",{get:function(){return 7}}).a}),b=Object.defineProperty,x={f:f?Object.defineProperty:function(t,e,n){if(h(t),e=function(t,e){if(!c(t))return t;var n,r;if(e&&"function"==typeof(n=t.toString)&&!c(r=n.call(t)))return r;if("function"==typeof(n=t.valueOf)&&!c(r=n.call(t)))return r;if(!e&&"function"==typeof(n=t.toString)&&!c(r=n.call(t)))return r;throw TypeError("Can't convert object to primitive value")}(e,!0),h(n),g)try{return b(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},j=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},w=f?function(t,e,n){return x.f(t,e,j(1,n))}:function(t,e,n){return t[e]=n,t},_=a("unscopables"),T=Array.prototype;null==T[_]&&w(T,_,{});var C=function(t){T[_][t]=!0},O=function(t,e){return{value:e,done:!!t}},A={},S={}.toString,k=function(t){return S.call(t).slice(8,-1)},E=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==k(t)?t.split(""):Object(t)},N=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t},P=function(t){return E(N(t))},B={}.hasOwnProperty,F=function(t,e){return B.call(t,e)},M=e(function(t){var o=s("src"),e="toString",n=Function[e],a=(""+n).split(e);v.inspectSource=function(t){return n.call(t)},(t.exports=function(t,e,n,r){var i="function"==typeof n;i&&(F(n,"name")||w(n,"name",e)),t[e]!==n&&(i&&(F(n,o)||w(n,o,t[e]?""+t[e]:a.join(String(e)))),t===y?t[e]=n:r?t[e]?t[e]=n:w(t,e,n):(delete t[e],w(t,e,n)))})(Function.prototype,e,function(){return"function"==typeof this&&this[o]||n.call(this)})}),I=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t},L=function(r,i,t){if(I(r),void 0===i)return r;switch(t){case 1:return function(t){return r.call(i,t)};case 2:return function(t,e){return r.call(i,t,e)};case 3:return function(t,e,n){return r.call(i,t,e,n)}}return function(){return r.apply(i,arguments)}},D="prototype",R=function(t,e,n){var r,i,o,a,s=t&R.F,c=t&R.G,u=t&R.S,l=t&R.P,f=t&R.B,d=c?y:u?y[e]||(y[e]={}):(y[e]||{})[D],p=c?v:v[e]||(v[e]={}),h=p[D]||(p[D]={});for(r in c&&(n=e),n)o=((i=!s&&d&&void 0!==d[r])?d:n)[r],a=f&&i?L(o,y):l&&"function"==typeof o?L(Function.call,o):o,d&&M(d,r,o,t&R.U),p[r]!=o&&w(p,r,a),l&&h[r]!=o&&(h[r]=o)};y.core=v,R.F=1,R.G=2,R.S=4,R.P=8,R.B=16,R.W=32,R.U=64,R.R=128;var V=R,z=Math.ceil,G=Math.floor,U=function(t){return isNaN(t=+t)?0:(0<t?G:z)(t)},H=Math.min,Y=function(t){return 0<t?H(U(t),9007199254740991):0},X=Math.max,K=Math.min,Q=function(u){return function(t,e,n){var r,i,o,a=P(t),s=Y(a.length),c=(i=s,(r=U(r=n))<0?X(r+i,0):K(r,i));if(u&&e!=e){for(;c<s;)if((o=a[c++])!=o)return!0}else for(;c<s;c++)if((u||c in a)&&a[c]===e)return u||c||0;return!u&&-1}},W=o("keys"),q=function(t){return W[t]||(W[t]=s(t))},J=Q(!1),Z=q("IE_PROTO"),tt="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),et=Object.keys||function(t){return function(t,e){var n,r=P(t),i=0,o=[];for(n in r)n!=Z&&F(r,n)&&o.push(n);for(;e.length>i;)F(r,n=e[i++])&&(~J(o,n)||o.push(n));return o}(t,tt)},nt=f?Object.defineProperties:function(t,e){h(t);for(var n,r=et(e),i=r.length,o=0;o<i;)x.f(t,n=r[o++],e[n]);return t},rt=y.document,it=rt&&rt.documentElement,ot=q("IE_PROTO"),at=function(){},st="prototype",ct=function(){var t,e=m("iframe"),n=tt.length;for(e.style.display="none",it.appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),ct=t.F;n--;)delete ct[st][tt[n]];return ct()},ut=Object.create||function(t,e){var n;return null!==t?(at[st]=h(t),n=new at,at[st]=null,n[ot]=t):n=ct(),void 0===e?n:nt(n,e)},lt=x.f,ft=a("toStringTag"),dt=function(t,e,n){t&&!F(t=n?t:t.prototype,ft)&&lt(t,ft,{configurable:!0,value:e})},pt={};w(pt,a("iterator"),function(){return this});var ht=function(t){return Object(N(t))},vt=q("IE_PROTO"),yt=Object.prototype,mt=Object.getPrototypeOf||function(t){return t=ht(t),F(t,vt)?t[vt]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?yt:null},gt=a("iterator"),bt=!([].keys&&"next"in[].keys()),xt="values",_t=function(){return this},jt=function(t,e,n,r,i,o,a){var s,c,u;c=e,u=r,(s=n).prototype=ut(pt,{next:j(1,u)}),dt(s,c+" Iterator");var l,f,d,p=function(t){if(!bt&&t in m)return m[t];switch(t){case"keys":case xt:return function(){return new n(this,t)}}return function(){return new n(this,t)}},h=e+" Iterator",v=i==xt,y=!1,m=t.prototype,g=m[gt]||m["@@iterator"]||i&&m[i],b=g||p(i),x=i?v?p("entries"):b:void 0,_="Array"==e&&m.entries||g;if(_&&(d=mt(_.call(new t)))!==Object.prototype&&d.next&&(dt(d,h,!0),"function"!=typeof d[gt]&&w(d,gt,_t)),v&&g&&g.name!==xt&&(y=!0,b=function(){return g.call(this)}),(bt||y||!m[gt])&&w(m,gt,b),A[e]=b,A[h]=_t,i)if(l={values:v?b:p(xt),keys:o?b:p("keys"),entries:x},a)for(f in l)f in m||M(m,f,l[f]);else V(V.P+V.F*(bt||y),e,l);return l},wt=jt(Array,"Array",function(t,e){this._t=P(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,O(1)):O(0,"keys"==e?n:"values"==e?t[n]:[n,t[n]])},"values");A.Arguments=A.Array,C("keys"),C("values"),C("entries");for(var Tt=a("iterator"),Ct=a("toStringTag"),Ot=A.Array,At={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},St=et(At),kt=0;kt<St.length;kt++){var Et,Nt=St[kt],Pt=At[Nt],Bt=y[Nt],Ft=Bt&&Bt.prototype;if(Ft&&(Ft[Tt]||w(Ft,Tt,Ot),Ft[Ct]||w(Ft,Ct,Nt),A[Nt]=Ot,Pt))for(Et in wt)Ft[Et]||M(Ft,Et,wt[Et],!0)}var Mt,It,Lt,Dt;Mt="keys",It=function(){return function(t){return et(ht(t))}},Lt=(v.Object||{})[Mt]||Object[Mt],(Dt={})[Mt]=It(Lt),V(V.S+V.F*l(function(){Lt(1)}),"Object",Dt);var Rt,Vt,zt,Gt,Ut,Ht,Yt,Xt,Kt,Qt=Array.isArray||function(t){return"Array"==k(t)},Wt=a("species"),$t=function(t,e){return!!t&&l(function(){e?t.call(null,function(){},1):t.call(null)})},qt=(zt=(Rt=1)==Rt,Gt=2==Rt,Ut=3==Rt,Ht=4==Rt,Yt=6==Rt,Xt=5==Rt||Yt,Kt=Vt||function(t,e){return Qt(n=t)&&("function"!=typeof(r=n.constructor)||r!==Array&&!Qt(r.prototype)||(r=void 0),c(r)&&null===(r=r[Wt])&&(r=void 0)),new(void 0===r?Array:r)(e);var n,r},function(t,e,n){for(var r,i,o=ht(t),a=E(o),s=L(e,n,3),c=Y(a.length),u=0,l=zt?Kt(t,c):Gt?Kt(t,0):void 0;u<c;u++)if((Xt||u in a)&&(i=s(r=a[u],u,o),Rt))if(zt)l[u]=i;else if(i)switch(Rt){case 3:return!0;case 5:return r;case 6:return u;case 2:l.push(r)}else if(Ht)return!1;return Yt?-1:Ut||Ht?Ht:l});V(V.P+V.F*!$t([].map,!0),"Array",{map:function(t){return qt(this,t,arguments[1])}});var Jt,Zt,te,ee=a("toStringTag"),ne="Arguments"==k(function(){return arguments}()),re=function(t){var e,n,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),ee))?n:ne?k(e):"Object"==(r=k(e))&&"function"==typeof e.callee?"Arguments":r},ie=function(e,t,n,r){try{return r?t(h(n)[0],n[1]):t(n)}catch(t){var i=e.return;throw void 0!==i&&h(i.call(e)),t}},oe=a("iterator"),ae=Array.prototype,se=function(t){return void 0!==t&&(A.Array===t||ae[oe]===t)},ce=a("iterator"),ue=v.getIteratorMethod=function(t){if(null!=t)return t[ce]||t["@@iterator"]||A[re(t)]},le=e(function(t){var d={},p={},e=t.exports=function(t,e,n,r,i){var o,a,s,c,u=i?function(){return t}:ue(t),l=L(n,r,e?2:1),f=0;if("function"!=typeof u)throw TypeError(t+" is not iterable!");if(se(u)){for(o=Y(t.length);f<o;f++)if((c=e?l(h(a=t[f])[0],a[1]):l(t[f]))===d||c===p)return c}else for(s=u.call(t);!(a=s.next()).done;)if((c=ie(s,l,a.value,e))===d||c===p)return c};e.BREAK=d,e.RETURN=p}),fe=a("species"),de=function(t,e,n){var r=void 0===n;switch(e.length){case 0:return r?t():t.call(n);case 1:return r?t(e[0]):t.call(n,e[0]);case 2:return r?t(e[0],e[1]):t.call(n,e[0],e[1]);case 3:return r?t(e[0],e[1],e[2]):t.call(n,e[0],e[1],e[2]);case 4:return r?t(e[0],e[1],e[2],e[3]):t.call(n,e[0],e[1],e[2],e[3])}return t.apply(n,e)},pe=y.process,he=y.setImmediate,ve=y.clearImmediate,ye=y.MessageChannel,me=y.Dispatch,ge=0,be={},xe="onreadystatechange",_e=function(){var t=+this;if(be.hasOwnProperty(t)){var e=be[t];delete be[t],e()}},je=function(t){_e.call(t.data)};he&&ve||(he=function(t){for(var e=[],n=1;arguments.length>n;)e.push(arguments[n++]);return be[++ge]=function(){de("function"==typeof t?t:Function(t),e)},Jt(ge),ge},ve=function(t){delete be[t]},"process"==k(pe)?Jt=function(t){pe.nextTick(L(_e,t,1))}:me&&me.now?Jt=function(t){me.now(L(_e,t,1))}:ye?(te=(Zt=new ye).port2,Zt.port1.onmessage=je,Jt=L(te.postMessage,te,1)):y.addEventListener&&"function"==typeof postMessage&&!y.importScripts?(Jt=function(t){y.postMessage(t+"","*")},y.addEventListener("message",je,!1)):Jt=xe in m("script")?function(t){it.appendChild(m("script"))[xe]=function(){it.removeChild(this),_e.call(t)}}:function(t){setTimeout(L(_e,t,1),0)});var we={set:he,clear:ve},Te=we.set,Ce=y.MutationObserver||y.WebKitMutationObserver,Oe=y.process,Ae=y.Promise,Se="process"==k(Oe);function ke(t){var n,r;this.promise=new t(function(t,e){if(void 0!==n||void 0!==r)throw TypeError("Bad Promise constructor");n=t,r=e}),this.resolve=I(n),this.reject=I(r)}var Ee={f:function(t){return new ke(t)}},Ne=function(t){try{return{e:!1,v:t()}}catch(t){return{e:!0,v:t}}},Pe=y.navigator,Be=Pe&&Pe.userAgent||"",Fe=a("species"),Me=a("iterator"),Ie=!1;try{[7][Me]().return=function(){Ie=!0}}catch(t){}var Le,De,Re,Ve,ze,Ge=function(t,e){if(!e&&!Ie)return!1;var n=!1;try{var r=[7],i=r[Me]();i.next=function(){return{done:n=!0}},r[Me]=function(){return i},t(r)}catch(t){}return n},Ue=we.set,He=function(){var n,r,i,t=function(){var t,e;for(Se&&(t=Oe.domain)&&t.exit();n;){e=n.fn,n=n.next;try{e()}catch(t){throw n?i():r=void 0,t}}r=void 0,t&&t.enter()};if(Se)i=function(){Oe.nextTick(t)};else if(!Ce||y.navigator&&y.navigator.standalone)if(Ae&&Ae.resolve){var e=Ae.resolve(void 0);i=function(){e.then(t)}}else i=function(){Te.call(y,t)};else{var o=!0,a=document.createTextNode("");new Ce(t).observe(a,{characterData:!0}),i=function(){a.data=o=!o}}return function(t){var e={fn:t,next:void 0};r&&(r.next=e),n||(n=e,i()),r=e}}(),Ye="Promise",Xe=y.TypeError,Ke=y.process,Qe=Ke&&Ke.versions,We=Qe&&Qe.v8||"",$e=y[Ye],qe="process"==re(Ke),Je=function(){},Ze=De=Ee.f,tn=!!function(){try{var t=$e.resolve(1),e=(t.constructor={})[a("species")]=function(t){t(Je,Je)};return(qe||"function"==typeof PromiseRejectionEvent)&&t.then(Je)instanceof e&&0!==We.indexOf("6.6")&&-1===Be.indexOf("Chrome/66")}catch(t){}}(),en=function(t){var e;return!(!c(t)||"function"!=typeof(e=t.then))&&e},nn=function(l,n){if(!l._n){l._n=!0;var r=l._c;He(function(){for(var c=l._v,u=1==l._s,t=0,e=function(t){var e,n,r,i=u?t.ok:t.fail,o=t.resolve,a=t.reject,s=t.domain;try{i?(u||(2==l._h&&an(l),l._h=1),!0===i?e=c:(s&&s.enter(),e=i(c),s&&(s.exit(),r=!0)),e===t.promise?a(Xe("Promise-chain cycle")):(n=en(e))?n.call(e,o,a):o(e)):a(c)}catch(t){s&&!r&&s.exit(),a(t)}};r.length>t;)e(r[t++]);l._c=[],l._n=!1,n&&!l._h&&rn(l)})}},rn=function(o){Ue.call(y,function(){var t,e,n,r=o._v,i=on(o);if(i&&(t=Ne(function(){qe?Ke.emit("unhandledRejection",r,o):(e=y.onunhandledrejection)?e({promise:o,reason:r}):(n=y.console)&&n.error&&n.error("Unhandled promise rejection",r)}),o._h=qe||on(o)?2:1),o._a=void 0,i&&t.e)throw t.v})},on=function(t){return 1!==t._h&&0===(t._a||t._c).length},an=function(e){Ue.call(y,function(){var t;qe?Ke.emit("rejectionHandled",e):(t=y.onrejectionhandled)&&t({promise:e,reason:e._v})})},sn=function(t){var e=this;e._d||(e._d=!0,(e=e._w||e)._v=t,e._s=2,e._a||(e._a=e._c.slice()),nn(e,!0))},cn=function(t){var n,r=this;if(!r._d){r._d=!0,r=r._w||r;try{if(r===t)throw Xe("Promise can't be resolved itself");(n=en(t))?He(function(){var e={_w:r,_d:!1};try{n.call(t,L(cn,e,1),L(sn,e,1))}catch(t){sn.call(e,t)}}):(r._v=t,r._s=1,nn(r,!1))}catch(t){sn.call({_w:r,_d:!1},t)}}};tn||($e=function(t){!function(t,e,n,r){if(!(t instanceof e)||void 0!==r&&r in t)throw TypeError(n+": incorrect invocation!")}(this,$e,Ye,"_h"),I(t),Le.call(this);try{t(L(cn,this,1),L(sn,this,1))}catch(t){sn.call(this,t)}},(Le=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=function(t,e,n){for(var r in e)M(t,r,e[r],n);return t}($e.prototype,{then:function(t,e){var n,r,i,o=Ze((n=$e,void 0===(i=h(this).constructor)||null==(r=h(i)[fe])?n:I(r)));return o.ok="function"!=typeof t||t,o.fail="function"==typeof e&&e,o.domain=qe?Ke.domain:void 0,this._c.push(o),this._a&&this._a.push(o),this._s&&nn(this,!1),o.promise},catch:function(t){return this.then(void 0,t)}}),Re=function(){var t=new Le;this.promise=t,this.resolve=L(cn,t,1),this.reject=L(sn,t,1)},Ee.f=Ze=function(t){return t===$e||t===Ve?new Re(t):De(t)}),V(V.G+V.W+V.F*!tn,{Promise:$e}),dt($e,Ye),ze=y[Ye],f&&ze&&!ze[Fe]&&x.f(ze,Fe,{configurable:!0,get:function(){return this}}),Ve=v[Ye],V(V.S+V.F*!tn,Ye,{reject:function(t){var e=Ze(this);return(0,e.reject)(t),e.promise}}),V(V.S+V.F*!tn,Ye,{resolve:function(t){return function(t,e){if(h(t),c(e)&&e.constructor===t)return e;var n=Ee.f(t);return(0,n.resolve)(e),n.promise}(this,t)}}),V(V.S+V.F*!(tn&&Ge(function(t){$e.all(t).catch(Je)})),Ye,{all:function(t){var a=this,e=Ze(a),s=e.resolve,c=e.reject,n=Ne(function(){var r=[],i=0,o=1;le(t,!1,function(t){var e=i++,n=!1;r.push(void 0),o++,a.resolve(t).then(function(t){n||(n=!0,r[e]=t,--o||s(r))},c)}),--o||s(r)});return n.e&&c(n.v),e.promise},race:function(t){var e=this,n=Ze(e),r=n.reject,i=Ne(function(){le(t,!1,function(t){e.resolve(t).then(n.resolve,r)})});return i.e&&r(i.v),n.promise}});var un=Q(!1),ln=[].indexOf,fn=!!ln&&1/[1].indexOf(1,-0)<0;V(V.P+V.F*(fn||!$t(ln)),"Array",{indexOf:function(t){return fn?ln.apply(this,arguments)||0:un(this,t,arguments[1])}});var dn={aspectRatio:16/13,margin:{top:50,left:50,bottom:50},x:{label:i18next.t("x_label",{ns:"railBar"}),getId:function(t){return t.year},getValue:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.x.getId.apply(this,e)},getClass:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.x.getId.apply(this,e)},getTickText:function(t){return i18next.t(t,{ns:"railBar"})}},y:{label:i18next.t("y_label",{ns:"railBar"}),getValue:function(t){return t.value},getText:function(t){return t.value},ticks:10,tickSizeOuter:0},z:{label:i18next.t("z_label",{ns:"railTable"}),getId:function(t){return t.category},getKeys:function(t){var e=Object.keys(t[0]);return e.splice(e.indexOf("category"),1),e},formatData:function(t){return t[0].values},getClass:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.z.getId.apply(this,e)},getDataPoints:function(t){return t.values},getText:function(t){return i18next.t(t.key,{ns:"rail"})}},_selfFormatter:i18n.getNumberFormatter(0),formatNum:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this._selfFormatter.format(e)},width:800,datatable:!1,tableTitle:""},pn=[].slice,hn={},vn=Function.bind||function(e){var n=I(this),r=pn.call(arguments,1),i=function(){var t=r.concat(pn.call(arguments));return this instanceof i?function(t,e,n){if(!(e in hn)){for(var r=[],i=0;i<e;i++)r[i]="a["+i+"]";hn[e]=Function("F,a","return new F("+r.join(",")+")")}return hn[e](t,n)}(n,t.length,t):de(n,t,e)};return c(n.prototype)&&(i.prototype=n.prototype),i};function yn(t,e){var n,r,i,o,a,s=e,c=d3.select("#railTable"),u=s.summaryId,l=function(t){var e=[];for(var n in t){var r={};for(var i in r.year=n,t[n])r[i]=t[n][i];e.push(r)}return e}(t),f=c.select(".chart-data-table"),d=["All","AB","AT","BC","MB","ON","QC","SK","USA-MX"];s.dataTableTotal&&d.push("total"),f.empty()||f.remove();var p;for((f=c.append("div").attr("class","chart-data-table")).append("div").attr("id",function(){return d3.select("#chrt-dt-tbl").empty()?u:u+"1"}).text(s.tableTitle),f.append("div").attr("id","copy-button-container"),(n=f.append("table").attr("class","table")).append("caption").attr("class","wb-inv").text(s.tableTitle),r=n.append("thead").attr("id","tblHeader").append("tr").attr("id","tblHeaderTR"),i=n.append("tbody").attr("id","tblBody"),r.append("td").attr("id","thead_h0").text("Year"!==(p=s.x.label)?p:""),a=0;a<d.length;a++)r.append("th").attr("id","thead_h"+(a+1)).style("text-align","right").text(s.z.getText.bind(s)({key:d[a]}));for((o=i.selectAll("tr").data(l).enter().append("tr").attr("id",function(t,e){return"row"+e})).append("th").attr("id",function(t,e){return"row"+e+"_h0"}).text((s.x.getText||s.x.getValue).bind(s)),a=0;a<d.length;a++)o.append("td").attr("headers",function(t,e){return"row"+e+"_h0 thead_h"+(a+1)}).text(function(t){return s.formatNum(t[d[a]])}).style("text-align","right");($||wb)&&$(".chart-data-table summary").trigger("wb-init.wb-details")}V(V.P,"Function",{bind:vn});var mn=[].sort,gn=[1,2,3];V(V.P+V.F*(l(function(){gn.sort(void 0)})||!l(function(){gn.sort(null)})||!$t(mn)),"Array",{sort:function(t){return void 0===t?mn.call(ht(this)):mn.call(ht(this),I(t))}});var bn,xn={f:{}.propertyIsEnumerable}.f,_n=(bn=!1,function(t){for(var e,n=P(t),r=et(n),i=r.length,o=0,a=[];o<i;)xn.call(n,e=r[o++])&&a.push(bn?[e,n[e]]:n[e]);return a});V(V.S,"Object",{values:function(t){return _n(t)}});var jn,wn={aspectRatio:19/6,margin:{top:30,right:0,bottom:20,left:120},alt:i18next.t("alt",{ns:"commodities"}),filterData:function(t){var i,o={},a=[];t.map(function(t){var e=Object.keys(t)[0];i||(i=Object.keys(t[e]));var n=i[i.length-1];o[e]||(o[e]=[]),a.push({key:e,lastYearValue:t[e][n].All});for(var r=0;r<i.length;r++)o[e].push({year:Object.keys(t[e])[r],value:Object.values(t[e])[r].All})}),a.sort(function(t,e){return t.lastYearValue<e.lastYearValue});var n,r=a.map(function(t){return t.key}),s=0,c=[];return Object.keys(o).map(function(t){var e=r[s];c.push(u({},t,e)),s++}),Object.keys(o).map(function(e){return c.map(function(t){if(Object.keys(t)[0]===e)return n=Object.values(t)[0]}),{id:n,dataPoints:o[n]}})},x:{getValue:function(t){return t.year},getText:function(t){return t.year}},r:{inverselyProportional:!1,getValue:function(t){return t.value}},z:{getId:function(t){return t.id},getClass:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.z.getId.apply(this,e)},getText:function(t){return i18next.t(t.id,{ns:"commodities"})},getDataPoints:function(t){return t.dataPoints}},width:800},Tn=(jn=!0,function(t,e){var n,r,i=String(N(t)),o=U(e),a=i.length;return o<0||a<=o?jn?"":void 0:(n=i.charCodeAt(o))<55296||56319<n||o+1===a||(r=i.charCodeAt(o+1))<56320||57343<r?jn?i.charAt(o):n:jn?i.slice(o,o+2):r-56320+(n-55296<<10)+65536});jt(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=Tn(e,n),this._i+=t.length,{value:t,done:!1})});var Cn=function(t,e,n){e in t?x.f(t,e,j(0,n)):t[e]=n};function On(t,n,e,r,i){var o=(e[1]-e[0])/r,a=[];a[0]=e[0];for(var s=1;s<r;s++)a.push(Math.round(s*o+e[0]));var c=function(t,e){return n[e]},u=function(t,e){if(t<r){var n=i.formatNum(a[e]);return 1===r?n:n+"+"}if(t===r+1)return"x"},l=d3.select("body").append("div").attr("class","tooltip").style("opacity",0);t.append("g").attr("class","colourbarTitle").attr("id","cbTitle").append("text").attr("transform",function(t,e){return"translate(225, 15)"}).style("display",function(){return"inline"});var f=t.attr("class","mapCB").selectAll(".legend").data(Array.from(Array(n.length).keys())),d=f.enter().append("g").attr("class","legend").attr("id",function(t,e){return"cb".concat(e)});d.append("rect").attr("width",35).attr("height",35).attr("y",20).attr("x",function(t,e){return 135+35*e}).attr("fill",c).attr("class",function(t,e){return e===r+1?"classNaN":1===r?"zeroValue":void 0}),d.selectAll(".legend rect").on("mouseover",function(t,e){if("classNaN"===d3.select(this).attr("class")){var n=i18next.t("NaNhover1",{ns:"airUI"}),r=i18next.t("NaNhover2",{ns:"airUI",escapeInterpolation:!1});l.style("opacity",.9).html("<br>"+n+"<br>"+r+"<br><br>").style("left",d3.event.pageX+10+"px").style("top",d3.event.pageY+10+"px")}}).on("mouseout",function(){l.style("opacity",0)}),d.append("text").text(u).attr("text-anchor","end").attr("transform",function(t,e){return e<r?"translate(".concat(140+35*e,", ").concat(65,") rotate(-45)"):e===r+1?"translate(".concat(156+35*e,", ").concat(72,") "):void 0}).style("display",function(){return"inline"}),f.select("rect").attr("fill",c),f.select("text").text(u),1===r?d3.select("#cb0").attr("transform","translate(73,0)"):d3.select("#cb0").attr("transform","translate(0,0)"),f.exit().remove()}V(V.S+V.F*!Ge(function(t){}),"Array",{from:function(t){var e,n,r,i,o=ht(t),a="function"==typeof this?this:Array,s=arguments.length,c=1<s?arguments[1]:void 0,u=void 0!==c,l=0,f=ue(o);if(u&&(c=L(c,2<s?arguments[2]:void 0,2)),null==f||a==Array&&se(f))for(n=new a(e=Y(o.length));l<e;l++)Cn(n,l,u?c(o[l],l):o[l]);else for(i=f.call(o),n=new a;!(r=i.next()).done;l++)Cn(n,l,u?ie(i,c,[r.value,l],!0):r.value);return n.length=l,n}});var An=function(){function n(t,e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),this.pNode=t||document.createElement("div"),this.options=e||{},this.nodes={},this.data=null,this.instanceNumber=++n.n,this.class=this.options.class||""}var t,e,r;return t=n,(e=[{key:"build",value:function(t){t&&(this.options=t),t.pNode&&(this.pNode=t.pNode),t.class&&(this.class=t.class),this.root=document.createElement("div"),this.root.setAttribute("class","copy-button button-"+this.instanceNumber+" "+this.class),this.pNode.appendChild(this.root),this.nodes.btnCopy=document.createElement("button"),this.nodes.btnCopy.setAttribute("type","button"),this.nodes.btnCopy.setAttribute("class","btn btn-primary copy button-"+this.instanceNumber+" "+this.class),this.nodes.btnCopy.setAttribute("title",this.options.title||""),this.root.appendChild(this.nodes.btnCopy);var e=document.createElement("span");e.setAttribute("class","fa fa-clipboard clipboard button-"+this.instanceNumber+" "+this.class),this.nodes.btnCopy.appendChild(e);var n=document.createElement("span");n.setAttribute("class","wb-inv button-"+this.instanceNumber+" "+this.class),n.innerHTML=this.options.accessibility||"",this.nodes.btnCopy.appendChild(n),this.nodes.msgCopyConfirm=document.createElement("div"),this.nodes.msgCopyConfirm.setAttribute("class","copy-confirm button-"+this.instanceNumber+" "+this.class),this.nodes.msgCopyConfirm.setAttribute("aria-live","polite"),this.nodes.msgCopyConfirm.innerHTML=this.options.msgCopyConfirm||"",this.root.appendChild(this.nodes.msgCopyConfirm),this.nodes.btnCopy.addEventListener("click",this.onBtnClick.bind(this))}},{key:"onBtnClick",value:function(t){this.copyData(this.data)}},{key:"copyData",value:function(t){var e=t||[];this.clipboard(this.toCSV("\t",e),this.root),this.fade(this.nodes.msgCopyConfirm,!0),setTimeout(function(t){this.fade(this.nodes.msgCopyConfirm,!1)}.bind(this),1500)}},{key:"toCSV",value:function(e,t){return t.map(function(t){return t.join(e)}).join("\r\n")}},{key:"clipboard",value:function(t,e){if(this.isIE())window.clipboardData.setData("Text",t);else{var n=document.createElement("textarea");n.textContent=t,e.appendChild(n),n.select(),document.execCommand("copy"),e.removeChild(n)}}},{key:"fade",value:function(t,e){var n=["copy-confirm button-"+this.instanceNumber+" "+this.class],r=e?"fadeIn":"fadeOut";n.push(r),t.setAttribute("class",n.join(" "))}},{key:"appendTo",value:function(t){this.pNode=t,this.pNode.appendChild(this.root),this.nodes.msgCopyConfirm.setAttribute("class","copy-confirm button-"+this.instanceNumber+" "+this.class)}},{key:"isIE",value:function(){var t=window.navigator.userAgent,e=t.indexOf("MSIE ");if(0<e)return parseInt(t.substring(e+5,t.indexOf(".",e)),10);if(0<t.indexOf("Trident/")){var n=t.indexOf("rv:");return parseInt(t.substring(n+3,t.indexOf(".",n)),10)}var r=t.indexOf("Edge/");return 0<r&&parseInt(t.substring(r+5,t.indexOf(".",r)),10)}}])&&i(t.prototype,e),r&&i(t,r),n}();An.n=0;var Sn,kn,En,Nn,Pn=new An,Bn=[],Fn="origin",Mn=.71,In="Origin",Ln="Dest",Dn={},Rn="2016",Vn=d3.select(".dashboard .map").append("svg"),zn=d3.select("body").append("div").attr("class","tooltip").attr("id","railTooltip").style("opacity",0),Gn=570-20-0,Un=150-20-10,Hn=d3.select("#mapColourScale").select("svg").attr("class","mapCB").attr("width",Gn).attr("height",Un).style("vertical-align","middle");d3.stcExt.addIEShim(Vn,387.1,457.5),d3.select("body").append("div").attr("class","tooltip").style("opacity",0);var Yn=d3.select(".data.raildata").append("svg").attr("id","svgBar"),Xn=d3.select("#commgrid").append("svg").attr("id","svg_commgrid"),Kn=function(){return new Promise(function(n,r){d3.json("data/rail/"+Sn+"_"+En+".json",function(t,e){t?r(t):n(e)})})};function Qn(t){var e;"originSelection"===t.target.id&&(Fn="origin"),"destinationSelection"===t.target.id&&(Fn="destination"),"commodity"===t.target.id&&$n(document.getElementById("commodity").value),"originGeo"===t.target.id&&qn(document.getElementById("originGeo").value),"destGeo"===t.target.id&&Jn(document.getElementById("destGeo").value),"yearSelector"===t.target.id&&(e=document.getElementById("yearSelector").value,Rn=e),Wn()}function Wn(){Dn[Nn]?(er(),tr(),yn(Dn[Nn],dn),Pn.pNode&&Pn.appendTo(document.getElementById("copy-button-container")),ir(Dn[Nn])):Kn().then(function(t){Dn[Nn]=t,er(),tr(),yn(Dn[Nn],dn),Pn.pNode&&Pn.appendTo(document.getElementById("copy-button-container")),ir(Dn[Nn])})}function $n(t){En=t,Nn="".concat(Sn,"_").concat(En)}function qn(t){Nn="".concat(Sn=t,"_").concat(En),Zn(t,In)}function Jn(t){Zn(kn=t,Ln)}function Zn(t,e){d3.select(".dashboard .map").selectAll(".rail".concat(e,"MapHighlight")).classed("rail".concat(e,"MapHighlight"),!1),d3.select(".dashboard .map").selectAll("#".concat(t,"_map")).classed("rail".concat(e,"MapHighlight"),!0).moveToFront()}function tr(){var t={},e=[];for(var n in Dn[Nn][Rn])"All"!==n&&(t[n]=Dn[Nn][Rn][n]);e.push(t);var r=["#AFE2FF","#72C2FF","#bc9dff","#894FFF","#5D0FBC"],i=function(t,e,n){var r,i=t[0],o=[],a=n;(o=Object.values(i)).sort(function(t,e){return t-e}),0===(r=d3.extent(o))[1]&&(a=1);var s=d3.scaleQuantize().domain([r[0],r[1]]).range(e.slice(0,a)),c=function(t){i.hasOwnProperty(t)&&d3.select(".dashboard .map").selectAll("."+t).style("fill",function(){return s(i[t])})};for(var u in i)c(u);return r}(e,r,r.length);0===i[1]?On(Hn,[r[0]],i,1,dn):On(Hn,r,i,r.length,dn);var o=i18next.t("units",{ns:"rail"});d3.select("#cbTitle").select("text").text(o).attr("transform",function(t,e){return"translate(203, 15)"})}function er(){barChart(Yn,t({},rr,{selectedOrig:Sn,selectedDest:kn})),d3.select("#svgBar").select(".x.axis").selectAll(".tick text").attr("dy","".concat(Mn,"em")),nr()}function nr(){var t=i18next.t(En,{ns:"commodities"}),e=i18next.t(Sn,{ns:"geography"}),n=i18next.t(kn,{ns:"geography"});d3.select("#railTitleBarChart").text("".concat(t," from ").concat(e," to ").concat(n)),d3.select("#mapTitleRail").text(i18next.t("mapTitle",{ns:"rail",commodity:i18next.t(En,{ns:"commodities"}),geo:i18next.t(Sn,{ns:"rail"}),year:Rn})),dn.tableTitle=i18next.t("tableTitle",{ns:"rail"})}Vn.on("mousemove",function(){if(d3.select(d3.event.target).attr("id")){var t,e=d3.event.target.id;t=isNaN(Dn[Nn][Rn][e.substring(0,e.length-4)])?"not available":dn.formatNum(Dn[Nn][Rn][e.substring(0,e.length-4)]),zn.style("opacity",.9),zn.html("<b>"+i18next.t("hoverText",{ns:"rail",origin:i18next.t(Sn,{ns:"rail"}),dest:i18next.t(e.substring(0,e.length-4),{ns:"rail"})})+"</b><br><br><table><tr><td><b>"+t+" "+i18next.t("units",{ns:"rail"})+"</td></tr></table>"),zn.style("left",d3.event.pageX+10+"px").style("top",d3.event.pageY+10+"px")}}),Vn.on("mouseout",function(){zn.style("opacity",0)}),Vn.on("mousedown",function(){"YT_map"!==event.target.id&&"NU_map"!==event.target.id&&"NT_map"!==event.target.id&&("origin"===Fn&&(qn(d3.event.target.id.substring(0,event.target.id.length-4)),Wn()),"destination"===Fn&&(Jn(d3.event.target.id.substring(0,event.target.id.length-4)),Wn()))});var rr=t({},dn,{filterData:function(){var e=this,n=Dn[Nn];return[{category:"".concat(this.selectedOrig),values:Object.keys(n).map(function(t){return{year:t,value:n[t][e.selectedDest]}})}]}});function ir(t){var e=[],n=i18next.t(En,{ns:"commodities"}),r=i18next.t(Sn,{ns:"geography"}),i=["".concat(n," from ").concat(r)],o=[""];for(var a in t[0])"date"!=a&&"isLast"!==a&&o.push(i18next.t(a,{ns:"rail"}));for(var s in e.push(i,[],o),t)if(Object.prototype.hasOwnProperty.call(t,s)){var c=[];for(var u in t[s])if("isLast"!==u&&Object.prototype.hasOwnProperty.call(t[s],u)){var l=t[s][u];c.push(l)}e.push(c)}Pn.data=e}i18n.load(["src/i18n"],function(){dn.x.label=i18next.t("x_label",{ns:"railBar"}),dn.y.label=i18next.t("y_label",{ns:"railBar"}),dn.z.label=i18next.t("z_label",{ns:"railTable"}),d3.queue().defer(d3.json,"data/rail/All_coal.json").defer(d3.json,"data/rail/All_mixed.json").defer(d3.json,"data/rail/All_wheat.json").defer(d3.json,"data/rail/All_ores.json").defer(d3.json,"data/rail/All_potash.json").defer(d3.json,"data/rail/All_lumber.json").defer(d3.json,"data/rail/All_canola.json").defer(d3.json,"data/rail/All_oils.json").defer(d3.json,"data/rail/All_chems.json").defer(d3.json,"data/rail/All_pulp.json").defer(d3.json,"data/road/CANADA.json").await(function(t,e,n,r,i,o,a,s,c,u,l){Bn.push({coal:e}),Bn.push({mixed:n}),Bn.push({wheat:r}),Bn.push({ores:i}),Bn.push({potash:o}),Bn.push({lumber:a}),Bn.push({canola:s}),Bn.push({oils:c}),Bn.push({chems:u}),Bn.push({pulp:l}),qn("AT"),Jn("QC"),$n("chems"),getCanadaMap(Vn).on("loaded",function(){var t=document.getElementById("AB_map").getBBox(),e=Vn.append("g").attr("id","usa-mex-group");e.append("rect").attr("width",35).attr("height",15).attr("x",t.x).attr("y",t.height+t.y+21).attr("class","USA-MX").attr("id","USA-MX_map"),e.append("image").attr("width",35).attr("height",15).attr("x",t.x).attr("y",t.height+t.y+10).attr("xlink:href","lib/usamexico.png").attr("id","USA-MX_map"),tr(),Zn("AT",In),Zn("QC",Ln)});var f,d={pNode:document.getElementById("copy-button-container"),title:i18next.t("CopyButton_Title",{ns:"CopyButton"}),msgCopyConfirm:i18next.t("CopyButton_Confirm",{ns:"CopyButton"}),accessibility:i18next.t("CopyButton_Title",{ns:"CopyButton"})};Pn.build(d),d3.select("#mapTitleRail").text(i18next.t("mapTitle",{ns:"rail",commodity:i18next.t(En,{ns:"commodities"}),geo:i18next.t(Sn,{ns:"rail"}),year:Rn})),d3.select("#symbolLink").html("<a href=".concat(i18next.t("linkURL",{ns:"symbolLink"})," target='_blank'>").concat(i18next.t("linkText",{ns:"symbolLink"}),"</a>")),f=i18next.t("bubbleTitle",{ns:"rail"}),d3.select("#commTableTitle").text(f),bubbleTable(Xn,wn,Bn),d3.json("data/rail/"+Sn+"_"+En+".json",function(t,e){Nn="".concat(Sn,"_").concat(En),Dn[Nn]=e,Wn()}),nr()})}),$(document).on("change",Qn),$(document).on("change",Qn),d3.selection.prototype.moveToFront=function(){return this.each(function(){this.parentNode.appendChild(this)})},d3.selection.prototype.moveToBack=function(){return this.each(function(){var t=this.parentNode.firstChild;t&&this.parentNode.insertBefore(this,t)})}}();