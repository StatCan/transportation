!function(){"use strict";function s(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}function t(t,n){return t(n={exports:{}},n.exports),n.exports}var h=t(function(t){var n=t.exports={version:"2.6.3"};"number"==typeof __e&&(__e=n)}),v=(h.version,t(function(t){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)})),o=t(function(t){var n="__core-js_shared__",e=v[n]||(v[n]={});(t.exports=function(t,n){return e[t]||(e[t]=void 0!==n?n:{})})("versions",[]).push({version:h.version,mode:"global",copyright:"Â© 2019 Denis Pushkarev (zloirock.ru)"})}),n=0,e=Math.random(),a=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++n+e).toString(36))},r=t(function(t){var n=o("wks"),e=v.Symbol,r="function"==typeof e;(t.exports=function(t){return n[t]||(n[t]=r&&e[t]||(r?e:a)("Symbol."+t))}).store=n}),i=function(t){return"object"==typeof t?null!==t:"function"==typeof t},u=function(t){if(!i(t))throw TypeError(t+" is not an object!");return t},c=function(t){try{return!!t()}catch(t){return!0}},l=!c(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),f=v.document,p=i(f)&&i(f.createElement),d=function(t){return p?f.createElement(t):{}},y=!l&&!c(function(){return 7!=Object.defineProperty(d("div"),"a",{get:function(){return 7}}).a}),g=Object.defineProperty,m={f:l?Object.defineProperty:function(t,n,e){if(u(t),n=function(t,n){if(!i(t))return t;var e,r;if(n&&"function"==typeof(e=t.toString)&&!i(r=e.call(t)))return r;if("function"==typeof(e=t.valueOf)&&!i(r=e.call(t)))return r;if(!n&&"function"==typeof(e=t.toString)&&!i(r=e.call(t)))return r;throw TypeError("Can't convert object to primitive value")}(n,!0),u(e),y)try{return g(t,n,e)}catch(t){}if("get"in e||"set"in e)throw TypeError("Accessors not supported!");return"value"in e&&(t[n]=e.value),t}},S=function(t,n){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:n}},_=l?function(t,n,e){return m.f(t,n,S(1,e))}:function(t,n,e){return t[n]=e,t},b=r("unscopables"),j=Array.prototype;null==j[b]&&_(j,b,{});var O=function(t){j[b][t]=!0},x=function(t,n){return{value:n,done:!!t}},A={},w={}.toString,T=function(t){return w.call(t).slice(8,-1)},k=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==T(t)?t.split(""):Object(t)},P=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t},L=function(t){return k(P(t))},M={}.hasOwnProperty,E=function(t,n){return M.call(t,n)},I=t(function(t){var i=a("src"),n="toString",e=Function[n],u=(""+e).split(n);h.inspectSource=function(t){return e.call(t)},(t.exports=function(t,n,e,r){var o="function"==typeof e;o&&(E(e,"name")||_(e,"name",n)),t[n]!==e&&(o&&(E(e,i)||_(e,i,t[n]?""+t[n]:u.join(String(n)))),t===v?t[n]=e:r?t[n]?t[n]=e:_(t,n,e):(delete t[n],_(t,n,e)))})(Function.prototype,n,function(){return"function"==typeof this&&this[i]||e.call(this)})}),C=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t},F=function(r,o,t){if(C(r),void 0===o)return r;switch(t){case 1:return function(t){return r.call(o,t)};case 2:return function(t,n){return r.call(o,t,n)};case 3:return function(t,n,e){return r.call(o,t,n,e)}}return function(){return r.apply(o,arguments)}},V="prototype",B=function(t,n,e){var r,o,i,u,a=t&B.F,c=t&B.G,l=t&B.S,s=t&B.P,f=t&B.B,p=c?v:l?v[n]||(v[n]={}):(v[n]||{})[V],d=c?h:h[n]||(h[n]={}),y=d[V]||(d[V]={});for(r in c&&(e=n),e)i=((o=!a&&p&&void 0!==p[r])?p:e)[r],u=f&&o?F(i,v):s&&"function"==typeof i?F(Function.call,i):i,p&&I(p,r,i,t&B.U),d[r]!=i&&_(d,r,u),s&&y[r]!=i&&(y[r]=i)};v.core=h,B.F=1,B.G=2,B.S=4,B.P=8,B.B=16,B.W=32,B.U=64,B.R=128;var G,R=B,D=Math.ceil,N=Math.floor,z=function(t){return isNaN(t=+t)?0:(0<t?N:D)(t)},H=Math.min,Y=function(t){return 0<t?H(z(t),9007199254740991):0},q=Math.max,U=Math.min,W=o("keys"),K=function(t){return W[t]||(W[t]=a(t))},Q=(G=!1,function(t,n,e){var r,o,i,u=L(t),a=Y(u.length),c=(o=a,(r=z(r=e))<0?q(r+o,0):U(r,o));if(G&&n!=n){for(;c<a;)if((i=u[c++])!=i)return!0}else for(;c<a;c++)if((G||c in u)&&u[c]===n)return G||c||0;return!G&&-1}),J=K("IE_PROTO"),X="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),Z=Object.keys||function(t){return function(t,n){var e,r=L(t),o=0,i=[];for(e in r)e!=J&&E(r,e)&&i.push(e);for(;n.length>o;)E(r,e=n[o++])&&(~Q(i,e)||i.push(e));return i}(t,X)},tt=l?Object.defineProperties:function(t,n){u(t);for(var e,r=Z(n),o=r.length,i=0;i<o;)m.f(t,e=r[i++],n[e]);return t},nt=v.document,et=nt&&nt.documentElement,rt=K("IE_PROTO"),ot=function(){},it="prototype",ut=function(){var t,n=d("iframe"),e=X.length;for(n.style.display="none",et.appendChild(n),n.src="javascript:",(t=n.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),ut=t.F;e--;)delete ut[it][X[e]];return ut()},at=Object.create||function(t,n){var e;return null!==t?(ot[it]=u(t),e=new ot,ot[it]=null,e[rt]=t):e=ut(),void 0===n?e:tt(e,n)},ct=m.f,lt=r("toStringTag"),st=function(t,n,e){t&&!E(t=e?t:t.prototype,lt)&&ct(t,lt,{configurable:!0,value:n})},ft={};_(ft,r("iterator"),function(){return this});var pt=function(t){return Object(P(t))},dt=K("IE_PROTO"),yt=Object.prototype,ht=Object.getPrototypeOf||function(t){return t=pt(t),E(t,dt)?t[dt]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?yt:null},vt=r("iterator"),gt=!([].keys&&"next"in[].keys()),mt="values",bt=function(){return this},jt=function(t,n,e,r,o,i,u){var a,c,l;c=n,l=r,(a=e).prototype=at(ft,{next:S(1,l)}),st(a,c+" Iterator");var s,f,p,d=function(t){if(!gt&&t in g)return g[t];switch(t){case"keys":case mt:return function(){return new e(this,t)}}return function(){return new e(this,t)}},y=n+" Iterator",h=o==mt,v=!1,g=t.prototype,m=g[vt]||g["@@iterator"]||o&&g[o],b=m||d(o),j=o?h?d("entries"):b:void 0,O="Array"==n&&g.entries||m;if(O&&(p=ht(O.call(new t)))!==Object.prototype&&p.next&&(st(p,y,!0),"function"!=typeof p[vt]&&_(p,vt,bt)),h&&m&&m.name!==mt&&(v=!0,b=function(){return m.call(this)}),(gt||v||!g[vt])&&_(g,vt,b),A[n]=b,A[y]=bt,o)if(s={values:h?b:d(mt),keys:i?b:d("keys"),entries:j},u)for(f in s)f in g||I(g,f,s[f]);else R(R.P+R.F*(gt||v),n,s);return s}(Array,"Array",function(t,n){this._t=L(t),this._i=0,this._k=n},function(){var t=this._t,n=this._k,e=this._i++;return!t||e>=t.length?(this._t=void 0,x(1)):x(0,"keys"==n?e:"values"==n?t[e]:[e,t[e]])},"values");A.Arguments=A.Array,O("keys"),O("values"),O("entries");for(var Ot=r("iterator"),St=r("toStringTag"),_t=A.Array,xt={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},At=Z(xt),wt=0;wt<At.length;wt++){var Tt,kt=At[wt],Pt=xt[kt],Lt=v[kt],Mt=Lt&&Lt.prototype;if(Mt&&(Mt[Ot]||_(Mt,Ot,_t),Mt[St]||_(Mt,St,kt),A[kt]=_t,Pt))for(Tt in jt)Mt[Tt]||I(Mt,Tt,jt[Tt],!0)}var Et,It,Ct,Ft;Et="keys",It=function(){return function(t){return Z(pt(t))}},Ct=(h.Object||{})[Et]||Object[Et],(Ft={})[Et]=It(Ct),R(R.S+R.F*c(function(){Ct(1)}),"Object",Ft);var Vt=Array.isArray||function(t){return"Array"==T(t)},Bt=r("species"),Gt=function(t,n){return Vt(e=t)&&("function"!=typeof(r=e.constructor)||r!==Array&&!Vt(r.prototype)||(r=void 0),i(r)&&null===(r=r[Bt])&&(r=void 0)),new(void 0===r?Array:r)(n);var e,r},Rt=function(f,t){var p=1==f,d=2==f,y=3==f,h=4==f,v=6==f,g=5==f||v,m=t||Gt;return function(t,n,e){for(var r,o,i=pt(t),u=k(i),a=F(n,e,3),c=Y(u.length),l=0,s=p?m(t,c):d?m(t,0):void 0;l<c;l++)if((g||l in u)&&(o=a(r=u[l],l,i),f))if(p)s[l]=o;else if(o)switch(f){case 3:return!0;case 5:return r;case 6:return l;case 2:s.push(r)}else if(h)return!1;return v?-1:y||h?h:s}},Dt=function(t,n){return!!t&&c(function(){n?t.call(null,function(){},1):t.call(null)})},Nt=Rt(2);R(R.P+R.F*!Dt([].filter,!0),"Array",{filter:function(t){return Nt(this,t,arguments[1])}});var zt={aspectRatio:1,margin:{top:50,left:100,bottom:150},x:{label:i18next.t("x_label",{ns:"railBar"}),getId:function(t){return t.year},getValue:function(){for(var t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e];return this.x.getId.apply(this,n)},getClass:function(){for(var t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e];return this.x.getId.apply(this,n)},getTickText:function(t){return i18next.t(t,{ns:"railBar"})}},y:{label:i18next.t("y_label",{ns:"railBar"}),getValue:function(t){return t.value},getText:function(t){return Math.round(t.value)},ticks:5},z:{getId:function(t){return t.category},getClass:function(){for(var t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e];return this.z.getId.apply(this,n)},getDataPoints:function(t){return t.values},getText:function(t){return i18next.t(t.id,{ns:"railBar"})}},width:900},Ht=[].sort,Yt=[1,2,3];R(R.P+R.F*(c(function(){Yt.sort(void 0)})||!c(function(){Yt.sort(null)})||!Dt(Ht)),"Array",{sort:function(t){return void 0===t?Ht.call(pt(this)):Ht.call(pt(this),C(t))}});var qt,Ut={f:{}.propertyIsEnumerable}.f,Wt=(qt=!1,function(t){for(var n,e=L(t),r=Z(e),o=r.length,i=0,u=[];i<o;)Ut.call(e,n=r[i++])&&u.push(qt?[n,e[n]]:e[n]);return u});R(R.S,"Object",{values:function(t){return Wt(t)}});var Kt=Rt(1);R(R.P+R.F*!Dt([].map,!0),"Array",{map:function(t){return Kt(this,t,arguments[1])}});var Qt={aspectRatio:19/6,margin:{top:30,right:0,bottom:0,left:120},alt:i18next.t("alt",{ns:"commodities"}),filterData:function(t){var o,i={},u=[];t.map(function(t){var n=Object.keys(t)[0];o||(o=Object.keys(t[n]));var e=o[o.length-1];i[n]||(i[n]=[]),u.push({key:n,lastYearValue:t[n][e].All});for(var r=0;r<o.length;r++)i[n].push({year:Object.keys(t[n])[r],value:Object.values(t[n])[r].All})}),u.sort(function(t,n){return t.lastYearValue<n.lastYearValue});var e,r=u.map(function(t){return t.key}),a=0,c=[];return Object.keys(i).map(function(t){var n=r[a];c.push(s({},t,n)),a++}),Object.keys(i).map(function(n){return c.map(function(t){if(Object.keys(t)[0]===n)return e=Object.values(t)[0]}),{id:e,dataPoints:i[e]}})},x:{getValue:function(t){return t.year},getText:function(t){return t.year}},r:{inverselyProportional:!1,getValue:function(t){return t.value}},z:{getId:function(t){return t.id},getClass:function(){for(var t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e];return this.z.getId.apply(this,n)},getText:function(t){return i18next.t(t.id,{ns:"commodities"})},getDataPoints:function(t){return t.dataPoints}},width:800},$t=[],Jt="ON",Xt="chems",Zt=["AT","ON","QC","MB","SK","AB","BC"].filter(function(t){return t!==Jt}),tn=d3.select("#commgrid").append("svg").attr("id","svg_commgrid");i18n.load(["src/i18n"],function(){zt.x.label=i18next.t("x_label",{ns:"railArea"}),zt.y.label=i18next.t("y_label",{ns:"railArea"}),d3.queue().defer(d3.json,"data/rail/All_coal.json").defer(d3.json,"data/rail/All_mixed.json").defer(d3.json,"data/rail/All_wheat.json").defer(d3.json,"data/rail/All_ores.json").defer(d3.json,"data/rail/All_lumber.json").defer(d3.json,"data/rail/All_canola.json").defer(d3.json,"data/rail/All_oils.json").defer(d3.json,"data/rail/All_chems.json").defer(d3.json,"data/rail/All_pulp.json").await(function(t,n,e,r,o,i,u,a,c,l){$t.push({coal:n}),$t.push({mixed:e}),$t.push({ores:o}),$t.push({lumber:i}),$t.push({canola:u}),$t.push({oils:a}),$t.push({chems:c}),$t.push({pulp:l}),d3.select("#commTableTitle").text("Total tonnage from all origins to all destinations (x 1M) for 10 commodities"),bubbleTable(tn,Qt,$t),d3.json("data/rail/"+Jt+"_"+Xt+".json",function(t,a){console.log("json1: ",a);for(var c=Object.keys(a).length,n=function(t){var u=Zt[t];d3.json("data/rail/"+u+"_"+Xt+".json",function(t,n){for(var e=[],r=0;r<c;r++){var o,i=Object.keys(a)[r];e.push((s(o={year:i},Jt+"to"+u,a[i][u]),s(o,u+"to"+Jt,n[i][Jt]),o))}})},e=0;e<Zt.length;e++)n(e)})})}),$(document).on("change",function(t){"commodity"===t.target.id&&(Xt=document.getElementById("commodity").value),"originGeo"===t.target.id&&(Jt=document.getElementById("originGeo").value)})}();