!function(){"use strict";function c(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function t(t,e){return t(e={exports:{}},e.exports),e.exports}var g=t(function(t){var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)}),v=t(function(t){var e=t.exports={version:"2.6.3"};"number"==typeof __e&&(__e=e)}),i=(v.version,function(t){return"object"==typeof t?null!==t:"function"==typeof t}),a=function(t){if(!i(t))throw TypeError(t+" is not an object!");return t},n=function(t){try{return!!t()}catch(t){return!0}},e=!n(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),r=g.document,o=i(r)&&i(r.createElement),u=function(t){return o?r.createElement(t):{}},l=!e&&!n(function(){return 7!=Object.defineProperty(u("div"),"a",{get:function(){return 7}}).a}),s=Object.defineProperty,f={f:e?Object.defineProperty:function(t,e,n){if(a(t),e=function(t,e){if(!i(t))return t;var n,r;if(e&&"function"==typeof(n=t.toString)&&!i(r=n.call(t)))return r;if("function"==typeof(n=t.valueOf)&&!i(r=n.call(t)))return r;if(!e&&"function"==typeof(n=t.toString)&&!i(r=n.call(t)))return r;throw TypeError("Can't convert object to primitive value")}(e,!0),a(n),l)try{return s(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},_=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},S=e?function(t,e,n){return f.f(t,e,_(1,n))}:function(t,e,n){return t[e]=n,t},p={}.hasOwnProperty,d=function(t,e){return p.call(t,e)},y=0,h=Math.random(),m=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++y+h).toString(36))},j=t(function(t){var o=m("src"),e="toString",n=Function[e],a=(""+n).split(e);v.inspectSource=function(t){return n.call(t)},(t.exports=function(t,e,n,r){var i="function"==typeof n;i&&(d(n,"name")||S(n,"name",e)),t[e]!==n&&(i&&(d(n,o)||S(n,o,t[e]?""+t[e]:a.join(String(e)))),t===g?t[e]=n:r?t[e]?t[e]=n:S(t,e,n):(delete t[e],S(t,e,n)))})(Function.prototype,e,function(){return"function"==typeof this&&this[o]||n.call(this)})}),b=function(r,i,t){if(function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!")}(r),void 0===i)return r;switch(t){case 1:return function(t){return r.call(i,t)};case 2:return function(t,e){return r.call(i,t,e)};case 3:return function(t,e,n){return r.call(i,t,e,n)}}return function(){return r.apply(i,arguments)}},x="prototype",O=function(t,e,n){var r,i,o,a,u=t&O.F,c=t&O.G,l=t&O.S,s=t&O.P,f=t&O.B,p=c?g:l?g[e]||(g[e]={}):(g[e]||{})[x],d=c?v:v[e]||(v[e]={}),y=d[x]||(d[x]={});for(r in c&&(n=e),n)o=((i=!u&&p&&void 0!==p[r])?p:n)[r],a=f&&i?b(o,g):s&&"function"==typeof o?b(Function.call,o):o,p&&j(p,r,o,t&O.U),d[r]!=o&&S(d,r,a),s&&y[r]!=o&&(y[r]=o)};g.core=v,O.F=1,O.G=2,O.S=4,O.P=8,O.B=16,O.W=32,O.U=64,O.R=128;var T=O,w={}.toString,A=function(t){return w.call(t).slice(8,-1)},P=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==A(t)?t.split(""):Object(t)},L=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t},k=function(t){return Object(L(t))},M=Math.ceil,C=Math.floor,E=function(t){return isNaN(t=+t)?0:(0<t?C:M)(t)},F=Math.min,I=function(t){return 0<t?F(E(t),9007199254740991):0},R=Array.isArray||function(t){return"Array"==A(t)},D=t(function(t){var e="__core-js_shared__",n=g[e]||(g[e]={});(t.exports=function(t,e){return n[t]||(n[t]=void 0!==e?e:{})})("versions",[]).push({version:v.version,mode:"global",copyright:"Â© 2019 Denis Pushkarev (zloirock.ru)"})}),V=t(function(t){var e=D("wks"),n=g.Symbol,r="function"==typeof n;(t.exports=function(t){return e[t]||(e[t]=r&&n[t]||(r?n:m)("Symbol."+t))}).store=e}),B=V("species"),G=function(t,e){return R(n=t)&&("function"!=typeof(r=n.constructor)||r!==Array&&!R(r.prototype)||(r=void 0),i(r)&&null===(r=r[B])&&(r=void 0)),new(void 0===r?Array:r)(e);var n,r},z=function(f,t){var p=1==f,d=2==f,y=3==f,g=4==f,v=6==f,h=5==f||v,m=t||G;return function(t,e,n){for(var r,i,o=k(t),a=P(o),u=b(e,n,3),c=I(a.length),l=0,s=p?m(t,c):d?m(t,0):void 0;l<c;l++)if((h||l in a)&&(i=u(r=a[l],l,o),f))if(p)s[l]=i;else if(i)switch(f){case 3:return!0;case 5:return r;case 6:return l;case 2:s.push(r)}else if(g)return!1;return v?-1:y||g?g:s}},N=function(t,e){return!!t&&n(function(){e?t.call(null,function(){},1):t.call(null)})},H=z(2);T(T.P+T.F*!N([].filter,!0),"Array",{filter:function(t){return H(this,t,arguments[1])}});var K=function(t){return P(L(t))},U=Math.max,W=Math.min,q=function(l){return function(t,e,n){var r,i,o,a=K(t),u=I(a.length),c=(i=u,(r=E(r=n))<0?U(r+i,0):W(r,i));if(l&&e!=e){for(;c<u;)if((o=a[c++])!=o)return!0}else for(;c<u;c++)if((l||c in a)&&a[c]===e)return l||c||0;return!l&&-1}},Q=q(!1),J=[].indexOf,X=!!J&&1/[1].indexOf(1,-0)<0;T(T.P+T.F*(X||!N(J)),"Array",{indexOf:function(t){return X?J.apply(this,arguments)||0:Q(this,t,arguments[1])}});var Y=V("unscopables"),Z=Array.prototype;null==Z[Y]&&S(Z,Y,{});var tt=function(t){Z[Y][t]=!0},et=function(t,e){return{value:e,done:!!t}},nt={},rt=D("keys"),it=function(t){return rt[t]||(rt[t]=m(t))},ot=q(!1),at=it("IE_PROTO"),ut="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),ct=Object.keys||function(t){return function(t,e){var n,r=K(t),i=0,o=[];for(n in r)n!=at&&d(r,n)&&o.push(n);for(;e.length>i;)d(r,n=e[i++])&&(~ot(o,n)||o.push(n));return o}(t,ut)},lt=e?Object.defineProperties:function(t,e){a(t);for(var n,r=ct(e),i=r.length,o=0;o<i;)f.f(t,n=r[o++],e[n]);return t},st=g.document,ft=st&&st.documentElement,pt=it("IE_PROTO"),dt=function(){},yt="prototype",gt=function(){var t,e=u("iframe"),n=ut.length;for(e.style.display="none",ft.appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),gt=t.F;n--;)delete gt[yt][ut[n]];return gt()},vt=Object.create||function(t,e){var n;return null!==t?(dt[yt]=a(t),n=new dt,dt[yt]=null,n[pt]=t):n=gt(),void 0===e?n:lt(n,e)},ht=f.f,mt=V("toStringTag"),bt=function(t,e,n){t&&!d(t=n?t:t.prototype,mt)&&ht(t,mt,{configurable:!0,value:e})},xt={};S(xt,V("iterator"),function(){return this});var Ot=it("IE_PROTO"),_t=Object.prototype,St=Object.getPrototypeOf||function(t){return t=k(t),d(t,Ot)?t[Ot]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?_t:null},jt=V("iterator"),Tt=!([].keys&&"next"in[].keys()),wt="values",At=function(){return this},Pt=function(t,e,n,r,i,o,a){var u,c,l;c=e,l=r,(u=n).prototype=vt(xt,{next:_(1,l)}),bt(u,c+" Iterator");var s,f,p,d=function(t){if(!Tt&&t in h)return h[t];switch(t){case"keys":case wt:return function(){return new n(this,t)}}return function(){return new n(this,t)}},y=e+" Iterator",g=i==wt,v=!1,h=t.prototype,m=h[jt]||h["@@iterator"]||i&&h[i],b=m||d(i),x=i?g?d("entries"):b:void 0,O="Array"==e&&h.entries||m;if(O&&(p=St(O.call(new t)))!==Object.prototype&&p.next&&(bt(p,y,!0),"function"!=typeof p[jt]&&S(p,jt,At)),g&&m&&m.name!==wt&&(v=!0,b=function(){return m.call(this)}),(Tt||v||!h[jt])&&S(h,jt,b),nt[e]=b,nt[y]=At,i)if(s={values:g?b:d(wt),keys:o?b:d("keys"),entries:x},a)for(f in s)f in h||j(h,f,s[f]);else T(T.P+T.F*(Tt||v),e,s);return s}(Array,"Array",function(t,e){this._t=K(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,et(1)):et(0,"keys"==e?n:"values"==e?t[n]:[n,t[n]])},"values");nt.Arguments=nt.Array,tt("keys"),tt("values"),tt("entries");for(var Lt=V("iterator"),kt=V("toStringTag"),Mt=nt.Array,Ct={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},Et=ct(Ct),Ft=0;Ft<Et.length;Ft++){var It,Rt=Et[Ft],Dt=Ct[Rt],Vt=g[Rt],Bt=Vt&&Vt.prototype;if(Bt&&(Bt[Lt]||S(Bt,Lt,Mt),Bt[kt]||S(Bt,kt,Rt),nt[Rt]=Mt,Dt))for(It in Pt)Bt[It]||j(Bt,It,Pt[It],!0)}var Gt,zt,Nt,Ht;Gt="keys",zt=function(){return function(t){return ct(k(t))}},Nt=(v.Object||{})[Gt]||Object[Gt],(Ht={})[Gt]=zt(Nt),T(T.S+T.F*n(function(){Nt(1)}),"Object",Ht);var Kt={aspectRatio:3.75,alt:i18next.t("alt",{ns:"railArea"}),margin:{top:50,left:80,bottom:70},filterData:function(t){return t},x:{label:i18next.t("x_label",{ns:"railArea"}),getValue:function(t){return new Date(t.year+"-01")},getText:function(t){return t.year},ticks:10},y:{label:i18next.t("y_label",{ns:"railArea"}),getValue:function(t,e){return"string"==typeof t[e]||t[e]instanceof String?0:t[e]},getText:function(t,e){return"string"==typeof t[e]||(t[e],String),t[e]},ticks:2},z:{label:i18next.t("z_label",{ns:"railArea"}),getId:function(t){return t.key},getKeys:function(t){var e=Object.keys(t[0]);return e.splice(e.indexOf("year"),1),-1!==e.indexOf(this.y.totalProperty)&&e.splice(e.indexOf(this.y.totalProperty),1),e},getClass:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.z.getId.apply(this,e)},getText:function(t){return i18next.t(t.key,{ns:"railArea"})}},datatable:!1,transition:!1,width:900},Ut=z(1);T(T.P+T.F*!N([].map,!0),"Array",{map:function(t){return Ut(this,t,arguments[1])}});var Wt={aspectRatio:19/3,margin:{top:30,right:0,bottom:0,left:120},alt:i18next.t("alt",{ns:"commodities"}),filterData:function(t){var i={};return t.map(function(t){var e=Object.keys(t);e.splice(e.indexOf("year"),1);for(var n=0;n<e.length;n++){var r=e[n];i[r]||(i[r]=[]),i[r].push({year:t.year,value:t[r]})}}),Object.keys(i).map(function(t){return{id:t,dataPoints:i[t]}})},x:{getValue:function(t){return t.year},getText:function(t){return t.year}},r:{inverselyProportional:!1,getValue:function(t){return t.value}},z:{getId:function(t){return t.id},getClass:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.z.getId.apply(this,e)},getText:function(t){return i18next.t(t.id,{ns:"commodities"})},getDataPoints:function(t){return t.dataPoints}},width:900};function qt(n,t){var e=300-63-0,r=30-0-0,i=d3.select(t).select("svg").attr("width",e).attr("height",r).style("vertical-align","middle").attr("transform","translate(345,30)").selectAll("rect").data(n).enter().append("g");i.append("rect").attr("width",20).attr("height",20).attr("y",5).attr("x",function(t,e){return 0+130*e}).attr("class",function(t,e){return n[e]+"to"}),i.append("text"),d3.select(t).selectAll("text").text(function(t,e){return 0===e?n[0]+" to "+n[1]:n[1]+" to "+n[0]}).attr("y",18).attr("x",function(t,e){return[25,155][e]}).style("display",function(){return"inline"})}var Qt={},$t="ATR",Jt="meat",Xt=["ATR","ON","QC","MB","SK","AB","BC"].filter(function(t){return t!==$t}),Yt=d3.select("#pair1").append("svg").attr("id","svg_pair1"),Zt=d3.select("#pair2").append("svg").attr("id","svg_pair2"),te=d3.select("#pair3").append("svg").attr("id","svg_pair3"),ee=d3.select("#pair4").append("svg").attr("id","svg_pair4"),ne=d3.select("#pair5").append("svg").attr("id","svg_pair5"),re=d3.select("#pair6").append("svg").attr("id","svg_pair6"),ie=d3.select("#commgrid").append("svg").attr("id","svg_commgrid");function oe(t){d3.select("#commTableTitle").text("Total tonnage from all origins to all destinations (x 1M) for 10 commodities"),d3.json("data/rail/commdata_allOrig_allDest.json",function(t,e){console.log("sort the data!"),bubbleTable(ie,Wt,e)})}i18n.load(["src/i18n"],function(){Kt.x.label=i18next.t("x_label",{ns:"railArea"}),Kt.y.label=i18next.t("y_label",{ns:"railArea"}),d3.json("data/rail/"+Jt+"_"+$t+".json",function(t,e){for(var u=(Qt[$t]=e).length,n=function(o){var a=Xt[o];d3.json("data/rail/"+Jt+"_"+a+".json",function(t,e){Qt[a]=e;for(var n=[],r=0;r<u;r++){var i;n.push((c(i={year:Qt[a][r].year},$t+"to"+a,Qt[$t][r][a]),c(i,a+"to"+$t,Qt[a][r][$t]),i))}0==o?(areaChart(Yt,Kt,n),qt([$t,a],"#legend1")):1==o?(areaChart(Zt,Kt,n),qt([$t,a],"#legend2")):2==o?(areaChart(te,Kt,n),qt([$t,a],"#legend3")):3==o?(areaChart(ee,Kt,n),qt([$t,a],"#legend4")):4==o?(areaChart(ne,Kt,n),qt([$t,a],"#legend5")):5==o&&(areaChart(re,Kt,n),qt([$t,a],"#legend6"))})},r=0;r<Xt.length;r++)n(r)}),oe()}),$(document).on("change",function(t){"commodity"===t.target.id&&(Jt=document.getElementById("commodity").value),"region"===t.target.id&&($t=document.getElementById("region").value),Qt[$t]?areaChart(Yt,Kt,Qt[$t]):d3.json("data/rail/rail_"+Jt+"_orig"+$t+"_all_dest.json",function(t,e){Qt[$t]=e})})}();