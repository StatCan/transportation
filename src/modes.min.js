!function(){"use strict";function t(t,n){return t(n={exports:{}},n.exports),n.exports}var h=t(function(t){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)}),y=t(function(t){var n=t.exports={version:"2.6.3"};"number"==typeof __e&&(__e=n)}),o=(y.version,function(t){return"object"==typeof t?null!==t:"function"==typeof t}),e=function(t){if(!o(t))throw TypeError(t+" is not an object!");return t},r=function(t){try{return!!t()}catch(t){return!0}},n=!r(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),i=h.document,a=o(i)&&o(i.createElement),u=!n&&!r(function(){return 7!=Object.defineProperty((t="div",a?i.createElement(t):{}),"a",{get:function(){return 7}}).a;var t}),c=Object.defineProperty,s={f:n?Object.defineProperty:function(t,n,r){if(e(t),n=function(t,n){if(!o(t))return t;var r,e;if(n&&"function"==typeof(r=t.toString)&&!o(e=r.call(t)))return e;if("function"==typeof(r=t.valueOf)&&!o(e=r.call(t)))return e;if(!n&&"function"==typeof(r=t.toString)&&!o(e=r.call(t)))return e;throw TypeError("Can't convert object to primitive value")}(n,!0),e(r),u)try{return c(t,n,r)}catch(t){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(t[n]=r.value),t}},g=n?function(t,n,r){return s.f(t,n,{enumerable:!((e=1)&e),configurable:!(2&e),writable:!(4&e),value:r});var e}:function(t,n,r){return t[n]=r,t},f={}.hasOwnProperty,l=function(t,n){return f.call(t,n)},d=0,m=Math.random(),p=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++d+m).toString(36))},v=t(function(t){var i=p("src"),n="toString",r=Function[n],a=(""+r).split(n);y.inspectSource=function(t){return r.call(t)},(t.exports=function(t,n,r,e){var o="function"==typeof r;o&&(l(r,"name")||g(r,"name",n)),t[n]!==r&&(o&&(l(r,i)||g(r,i,t[n]?""+t[n]:a.join(String(n)))),t===h?t[n]=r:e?t[n]?t[n]=r:g(t,n,r):(delete t[n],g(t,n,r)))})(Function.prototype,n,function(){return"function"==typeof this&&this[i]||r.call(this)})}),F=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t},x=function(e,o,t){if(F(e),void 0===o)return e;switch(t){case 1:return function(t){return e.call(o,t)};case 2:return function(t,n){return e.call(o,t,n)};case 3:return function(t,n,r){return e.call(o,t,n,r)}}return function(){return e.apply(o,arguments)}},S="prototype",_=function(t,n,r){var e,o,i,a,u=t&_.F,c=t&_.G,s=t&_.S,f=t&_.P,l=t&_.B,d=c?h:s?h[n]||(h[n]={}):(h[n]||{})[S],m=c?y:y[n]||(y[n]={}),p=m[S]||(m[S]={});for(e in c&&(r=n),r)i=((o=!u&&d&&void 0!==d[e])?d:r)[e],a=l&&o?x(i,h):f&&"function"==typeof i?x(Function.call,i):i,d&&v(d,e,i,t&_.U),m[e]!=i&&g(m,e,a),f&&p[e]!=i&&(p[e]=i)};h.core=y,_.F=1,_.G=2,_.S=4,_.P=8,_.B=16,_.W=32,_.U=64,_.R=128;var b,U,C,A,w,O,k,j,M,P=_,T={}.toString,D=function(t){return T.call(t).slice(8,-1)},E=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==D(t)?t.split(""):Object(t)},B=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t},W=function(t){return Object(B(t))},z=Math.ceil,N=Math.floor,R=function(t){return isNaN(t=+t)?0:(0<t?N:z)(t)},G=Math.min,I=function(t){return 0<t?G(R(t),9007199254740991):0},L=Array.isArray||function(t){return"Array"==D(t)},q=t(function(t){var n="__core-js_shared__",r=h[n]||(h[n]={});(t.exports=function(t,n){return r[t]||(r[t]=void 0!==n?n:{})})("versions",[]).push({version:y.version,mode:"global",copyright:"Â© 2019 Denis Pushkarev (zloirock.ru)"})}),H=t(function(t){var n=q("wks"),r=h.Symbol,e="function"==typeof r;(t.exports=function(t){return n[t]||(n[t]=e&&r[t]||(e?r:p)("Symbol."+t))}).store=n})("species"),K=function(t,n){return!!t&&r(function(){n?t.call(null,function(){},1):t.call(null)})},V=(C=1==(b=2),A=2==b,w=3==b,O=4==b,k=6==b,j=5==b||k,M=U||function(t,n){return L(r=t)&&("function"!=typeof(e=r.constructor)||e!==Array&&!L(e.prototype)||(e=void 0),o(e)&&null===(e=e[H])&&(e=void 0)),new(void 0===e?Array:e)(n);var r,e},function(t,n,r){for(var e,o,i=W(t),a=E(i),u=x(n,r,3),c=I(a.length),s=0,f=C?M(t,c):A?M(t,0):void 0;s<c;s++)if((j||s in a)&&(o=u(e=a[s],s,i),b))if(C)f[s]=o;else if(o)switch(b){case 3:return!0;case 5:return e;case 6:return s;case 2:f.push(e)}else if(O)return!1;return k?-1:w||O?O:f});P(P.P+P.F*!K([].filter,!0),"Array",{filter:function(t){return V(this,t,arguments[1])}});var Y=s.f,J=Function.prototype,Q=/^\s*function ([^ (]*)/,X="name";X in J||n&&Y(J,X,{configurable:!0,get:function(){try{return(""+this).match(Q)[1]}catch(t){return""}}});var Z=[].sort,tt=[1,2,3];P(P.P+P.F*(r(function(){tt.sort(void 0)})||!r(function(){tt.sort(null)})||!K(Z)),"Array",{sort:function(t){return void 0===t?Z.call(W(this)):Z.call(W(this),F(t))}});var nt,rt,et=/"/g;(rt={})[nt="link"]=function(n){return function(t){return n(this,"a","href",t)}}(function(t,n,r,e){var o=String(B(t)),i="<"+n;return""!==r&&(i+=" "+r+'="'+String(e).replace(et,"&quot;")+'"'),i+">"+o+"</"+n+">"}),P(P.P+P.F*r(function(){var t=""[nt]('"');return t!==t.toLowerCase()||3<t.split('"').length}),"String",rt);var ot={aspectRatio:16/14,width:1090,margin:{top:10,right:10,bottom:10,left:10}};function it(t,n){var e={intl:"#607890",USres:"#CC982A",nonUS:"#928941",cdnFromUS:"#FFDC68",cdnFromOther:"#FAB491",USres_land:"#CC982A",USres_air:"#CC982A",USres_marine:"#CC982A",USres_car:"#CC982A",USres_bus:"#CC982A",USres_train:"#CC982A",USres_other:"#CC982A",nonUS_land:"#928941",nonUS_air:"#928941",nonUS_marine:"#928941",cdnFromUS_land:"#FFDC68",cdnFromUS_air:"#FFDC68",cdnFromUS_marine:"#FFDC68",cdnFromUS_car:"#FFDC68",cdnFromUS_bus:"#FFDC68",cdnFromUS_train:"#FFDC68",cdnFromUS_other:"#FFDC68",cdnFromOther_land:"#FAB491",cdnFromOther_air:"#FAB491",cdnFromOther_marine:"#FAB491"},r=ot,o=r.width,i=Math.ceil(o/r.aspectRatio),a=r.innerHeight=i-r.margin.top-r.margin.bottom,u=r.innerWidth=o-r.margin.left-r.margin.right,c=t.select("g.margin-offset"),s=c.select(".data");r.innerHeight=i-r.margin.top-r.margin.bottom;var f=d3.format(",.0f"),l=function(t){return f(t)},d=d3.sankey().nodeWidth(36).nodePadding(40).size([u,a]),m=d.link();t.attr("viewBox","0 0 "+o+" "+i).attr("preserveAspectRatio","xMidYMid meet").attr("role","img").attr("aria-label",r.altText),c.empty()&&(c=t.append("g").attr("class","margin-offset").attr("transform","translate("+r.margin.left+","+r.margin.top+")")),d3.stcExt.addIEShim(t,i,o),function(t){d.nodes(t.nodes).links(t.links).layout(32),s.empty()&&(s=c.append("g").attr("class","data"));var n=s.append("g").selectAll(".link").data(t.links).enter().append("path").attr("class","link").attr("d",m).style("stroke-width",function(t){return Math.max(1,t.dy)}).style("opacity",function(t){if(0===t.value)return 0}).sort(function(t,n){return n.dy-t.dy});n.append("title").text(function(t){return i18next.t(t.target.name,{ns:"modes"})+"\n"+l(t.value)});var r=s.append("g").selectAll(".node").data(t.nodes).enter().append("g").attr("class","node").attr("transform",function(t){return"translate("+t.x+","+t.y+")"}).call(d3.drag().subject(function(t){return t}).on("start",function(){this.parentNode.appendChild(this)}).on("drag",function(t){d3.select(this).attr("transform","translate("+t.x+","+(t.y=Math.max(0,Math.min(a-t.dy,d3.event.y)))+")"),d.relayout(),n.attr("d",m)}));r.append("rect").attr("height",function(t){return t.dy}).attr("width",d.nodeWidth()).style("fill",function(t){return t.color=e[t.name]}).style("stroke",function(t){return d3.rgb(t.color).darker(2)}).append("title").text(function(t){return i18next.t(t.name,{ns:"modes"})+"\n"+l(t.value)}),r.append("text").attr("x",-6).attr("y",function(t){return t.dy/2}).attr("dy",".35em").attr("text-anchor","end").attr("transform",null).text(function(t){if(0!=t.value)return i18next.t(t.name,{ns:"modes"})}).filter(function(t){return t.x<u/2}).attr("x",6+d.nodeWidth()).attr("text-anchor","start")}(n)}var at,ut=Math.max,ct=Math.min,st=(at=!1,function(t,n,r){var e,o,i,a=E(B(t)),u=I(a.length),c=(o=u,(e=R(e=r))<0?ut(e+o,0):ct(e,o));if(at&&n!=n){for(;c<u;)if((i=a[c++])!=i)return!0}else for(;c<u;c++)if((at||c in a)&&a[c]===n)return at||c||0;return!at&&-1}),ft=[].indexOf,lt=!!ft&&1/[1].indexOf(1,-0)<0;P(P.P+P.F*(lt||!K(ft)),"Array",{indexOf:function(t){return lt?ft.apply(this,arguments)||0:st(this,t,arguments[1])}});var dt,mt={alt:i18next.t("alt",{ns:"modes"}),tableTitle:i18next.t("alt",{ns:"modes"}),margin:{top:50,left:80,bottom:50},filterData:function(t){return t.nodes},x:{},y:{getValue:function(t,n){if("string"==typeof t[n]||t[n]instanceof String){if(t.targetLinks[0])return"USres_car"!==t.name&&"USres_bus"!==t.name&&"USres_train"!==t.name&&"USres_other"!==t.name?"cdnFromUS_car"!==t.name&&"cdnFromUS_bus"!==t.name&&"cdnFromUS_train"!==t.name&&"cdnFromUS_other"!==t.name?i18next.t(t.targetLinks[0].source.name,{ns:"modes"})+", "+i18next.t(t[n],{ns:"modes"}):i18next.t("cdnFromUS",{ns:"modes"})+", "+i18next.t(t[n],{ns:"modes"}):i18next.t("USres",{ns:"modes"})+", "+i18next.t(t[n],{ns:"modes"});else if("cdnFromOther_land"===t.name)return i18next.t("cdnFromOther",{ns:"modes"})+", "+i18next.t(t[n],{ns:"modes"});return i18next.t(t[n],{ns:"modes"})}return t[n]}},z:{getKeys:function(t){var n=["name","value"];return-1!==n.indexOf(this.y.totalProperty)&&n.splice(n.indexOf(this.y.totalProperty),1),n},getText:function(t){return i18next.t(t.key,{ns:"modes"})}},datatable:!0,width:200},pt="CANADA",ht=d3.select("#sankeyGraph").append("svg").attr("id","svg_sankeyChart"),yt=d3.select(".tabledata").attr("id","modesTable");function gt(){it(ht,dt[pt])}i18n.load(["src/i18n"],function(){mt.tableTitle=i18next.t("tableTitle",{ns:"modes"}),d3.queue().defer(d3.json,"data/modes/canada_modes.json").await(function(t,n){it(ht,dt=n),drawTable(yt,mt,dt)})}),$(document).on("change",function(t){"groups"===t.target.id&&(pt=document.getElementById("groups").value,dt[pt]?gt():d3.json("data/modes/"+pt+"_modes.json",function(t,n){dt[pt]=n,gt()}))})}();