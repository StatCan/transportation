!function(){"use strict";function t(t,n){return t(n={exports:{}},n.exports),n.exports}var h=t(function(t){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)}),y=t(function(t){var n=t.exports={version:"2.6.3"};"number"==typeof __e&&(__e=n)}),o=(y.version,function(t){return"object"==typeof t?null!==t:"function"==typeof t}),e=function(t){if(!o(t))throw TypeError(t+" is not an object!");return t},r=function(t){try{return!!t()}catch(t){return!0}},n=!r(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),i=h.document,a=o(i)&&o(i.createElement),u=!n&&!r(function(){return 7!=Object.defineProperty((t="div",a?i.createElement(t):{}),"a",{get:function(){return 7}}).a;var t}),c=Object.defineProperty,f={f:n?Object.defineProperty:function(t,n,r){if(e(t),n=function(t,n){if(!o(t))return t;var r,e;if(n&&"function"==typeof(r=t.toString)&&!o(e=r.call(t)))return e;if("function"==typeof(r=t.valueOf)&&!o(e=r.call(t)))return e;if(!n&&"function"==typeof(r=t.toString)&&!o(e=r.call(t)))return e;throw TypeError("Can't convert object to primitive value")}(n,!0),e(r),u)try{return c(t,n,r)}catch(t){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(t[n]=r.value),t}},v=n?function(t,n,r){return f.f(t,n,{enumerable:!((e=1)&e),configurable:!(2&e),writable:!(4&e),value:r});var e}:function(t,n,r){return t[n]=r,t},s={}.hasOwnProperty,l=function(t,n){return s.call(t,n)},d=0,p=Math.random(),m=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++d+p).toString(36))},g=t(function(t){var i=m("src"),n="toString",r=Function[n],a=(""+r).split(n);y.inspectSource=function(t){return r.call(t)},(t.exports=function(t,n,r,e){var o="function"==typeof r;o&&(l(r,"name")||v(r,"name",n)),t[n]!==r&&(o&&(l(r,i)||v(r,i,t[n]?""+t[n]:a.join(String(n)))),t===h?t[n]=r:e?t[n]?t[n]=r:v(t,n,r):(delete t[n],v(t,n,r)))})(Function.prototype,n,function(){return"function"==typeof this&&this[i]||r.call(this)})}),F=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t},_=function(e,o,t){if(F(e),void 0===o)return e;switch(t){case 1:return function(t){return e.call(o,t)};case 2:return function(t,n){return e.call(o,t,n)};case 3:return function(t,n,r){return e.call(o,t,n,r)}}return function(){return e.apply(o,arguments)}},S="prototype",b=function(t,n,r){var e,o,i,a,u=t&b.F,c=t&b.G,f=t&b.S,s=t&b.P,l=t&b.B,d=c?h:f?h[n]||(h[n]={}):(h[n]||{})[S],p=c?y:y[n]||(y[n]={}),m=p[S]||(p[S]={});for(e in c&&(r=n),r)i=((o=!u&&d&&void 0!==d[e])?d:r)[e],a=l&&o?_(i,h):s&&"function"==typeof i?_(Function.call,i):i,d&&g(d,e,i,t&b.U),p[e]!=i&&v(p,e,a),s&&m[e]!=i&&(m[e]=i)};h.core=y,b.F=1,b.G=2,b.S=4,b.P=8,b.B=16,b.W=32,b.U=64,b.R=128;var C,A,x,w,U,j,k,M,O,P=b,E={}.toString,D=function(t){return E.call(t).slice(8,-1)},B=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==D(t)?t.split(""):Object(t)},T=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t},W=function(t){return Object(T(t))},N=Math.ceil,R=Math.floor,z=Math.min,G=function(t){return 0<t?z((n=t,isNaN(n=+n)?0:(0<n?R:N)(n)),9007199254740991):0;var n},I=Array.isArray||function(t){return"Array"==D(t)},q=t(function(t){var n="__core-js_shared__",r=h[n]||(h[n]={});(t.exports=function(t,n){return r[t]||(r[t]=void 0!==n?n:{})})("versions",[]).push({version:y.version,mode:"global",copyright:"Â© 2019 Denis Pushkarev (zloirock.ru)"})}),H=t(function(t){var n=q("wks"),r=h.Symbol,e="function"==typeof r;(t.exports=function(t){return n[t]||(n[t]=e&&r[t]||(e?r:m)("Symbol."+t))}).store=n})("species"),L=function(t,n){return!!t&&r(function(){n?t.call(null,function(){},1):t.call(null)})},Y=(x=1==(C=2),w=2==C,U=3==C,j=4==C,k=6==C,M=5==C||k,O=A||function(t,n){return I(r=t)&&("function"!=typeof(e=r.constructor)||e!==Array&&!I(e.prototype)||(e=void 0),o(e)&&null===(e=e[H])&&(e=void 0)),new(void 0===e?Array:e)(n);var r,e},function(t,n,r){for(var e,o,i=W(t),a=B(i),u=_(n,r,3),c=G(a.length),f=0,s=x?O(t,c):w?O(t,0):void 0;f<c;f++)if((M||f in a)&&(o=u(e=a[f],f,i),C))if(x)s[f]=o;else if(o)switch(C){case 3:return!0;case 5:return e;case 6:return f;case 2:s.push(e)}else if(j)return!1;return k?-1:U||j?j:s});P(P.P+P.F*!L([].filter,!0),"Array",{filter:function(t){return Y(this,t,arguments[1])}});var J=f.f,K=Function.prototype,Q=/^\s*function ([^ (]*)/,V="name";V in K||n&&J(K,V,{configurable:!0,get:function(){try{return(""+this).match(Q)[1]}catch(t){return""}}});var X=[].sort,Z=[1,2,3];P(P.P+P.F*(r(function(){Z.sort(void 0)})||!r(function(){Z.sort(null)})||!L(X)),"Array",{sort:function(t){return void 0===t?X.call(W(this)):X.call(W(this),F(t))}});var tt,nt,rt=/"/g;(nt={})[tt="link"]=function(n){return function(t){return n(this,"a","href",t)}}(function(t,n,r,e){var o=String(T(t)),i="<"+n;return""!==r&&(i+=" "+r+'="'+String(e).replace(rt,"&quot;")+'"'),i+">"+o+"</"+n+">"}),P(P.P+P.F*r(function(){var t=""[tt]('"');return t!==t.toLowerCase()||3<t.split('"').length}),"String",nt);var et={aspectRatio:16/14,width:1100,margin:{top:10,right:10,bottom:10,left:10}};function ot(t,n){var e={intl:"#607890",USres:"#CC982A",nonUS:"#928941",cdnFromUS:"#FFDC68",cdnFromOther:"#FAB491",USres_land:"#CC982A",USres_air:"#CC982A",USres_marine:"#CC982A",USres_car:"#CC982A",USres_bus:"#CC982A",USres_train:"#CC982A",USres_other:"#CC982A",nonUS_land:"#928941",nonUS_air:"#928941",nonUS_marine:"#928941",cdnFromUS_land:"#FFDC68",cdnFromUS_air:"#FFDC68",cdnFromUS_marine:"#FFDC68",cdnFromUS_car:"#FFDC68",cdnFromUS_bus:"#FFDC68",cdnFromUS_train:"#FFDC68",cdnFromUS_other:"#FFDC68",cdnFromOther_land:"#FAB491",cdnFromOther_air:"#FAB491",cdnFromOther_marine:"#FAB491"},r=et,o=r.width,i=Math.ceil(o/r.aspectRatio),a=r.innerHeight=i-r.margin.top-r.margin.bottom,u=r.innerWidth=o-r.margin.left-r.margin.right,c=t.select("g.margin-offset"),f=c.select(".data");r.innerHeight=i-r.margin.top-r.margin.bottom;var s=d3.format(",.0f"),l=function(t){return s(t)},d=d3.sankey().nodeWidth(36).nodePadding(40).size([u,a]),p=d.link();t.attr("viewBox","0 0 "+o+" "+i).attr("preserveAspectRatio","xMidYMid meet").attr("role","img").attr("aria-label",r.altText),c.empty()&&(c=t.append("g").attr("class","margin-offset").attr("transform","translate("+r.margin.left+","+r.margin.top+")")),d3.stcExt.addIEShim(t,i,o),function(t){d.nodes(t.nodes).links(t.links).layout(32),f.empty()&&(f=c.append("g").attr("class","data"));var n=f.append("g").selectAll(".link").data(t.links).enter().append("path").attr("class","link").attr("d",p).style("stroke-width",function(t){return Math.max(1,t.dy)}).style("opacity",function(t){if(0===t.value)return 0}).sort(function(t,n){return n.dy-t.dy});n.append("title").text(function(t){return t.source.name+"_to_"+t.target.name+"\n"+l(t.value)});var r=f.append("g").selectAll(".node").data(t.nodes).enter().append("g").attr("class","node").attr("transform",function(t){return"translate("+t.x+","+t.y+")"}).call(d3.drag().subject(function(t){return t}).on("start",function(){this.parentNode.appendChild(this)}).on("drag",function(t){d3.select(this).attr("transform","translate("+t.x+","+(t.y=Math.max(0,Math.min(a-t.dy,d3.event.y)))+")"),d.relayout(),n.attr("d",p)}));r.append("rect").attr("height",function(t){return t.dy}).attr("width",d.nodeWidth()).style("fill",function(t){return t.color=e[t.name]}).style("stroke",function(t){return d3.rgb(t.color).darker(2)}).append("title").text(function(t){return t.name+"\n"+l(t.value)}),r.append("text").attr("x",-6).attr("y",function(t){return t.dy/2}).attr("dy",".35em").attr("text-anchor","end").attr("transform",null).text(function(t){if(0!=t.value)return t.name}).filter(function(t){return t.x<u/2}).attr("x",6+d.nodeWidth()).attr("text-anchor","start")}(n)}var it,at="CANADA",ut=d3.select("#sankeyGraph").append("svg").attr("id","svg_sankeyChart");function ct(){ot(ut,it[at])}i18n.load(["src/i18n"],function(){d3.queue().defer(d3.json,"data/modes/canada_modes.json").await(function(t,n){ot(ut,it=n)})}),$(document).on("change",function(t){"groups"===t.target.id&&(at=document.getElementById("groups").value,it[at]?ct():d3.json("data/modes/"+at+"_modes.json",function(t,n){it[at]=n,ct()}))})}();