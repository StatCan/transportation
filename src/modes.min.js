!function(){"use strict";function t(t,n){return t(n={exports:{}},n.exports),n.exports}var m=t(function(t){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)}),y=t(function(t){var n=t.exports={version:"2.6.3"};"number"==typeof __e&&(__e=n)}),p=(y.version,function(t){return"object"==typeof t?null!==t:"function"==typeof t}),E=function(t){if(!p(t))throw TypeError(t+" is not an object!");return t},l=function(t){try{return!!t()}catch(t){return!0}},n=!l(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),e=m.document,r=p(e)&&p(e.createElement),o=!n&&!l(function(){return 7!=Object.defineProperty((t="div",r?e.createElement(t):{}),"a",{get:function(){return 7}}).a;var t}),i=Object.defineProperty,a={f:n?Object.defineProperty:function(t,n,e){if(E(t),n=function(t,n){if(!p(t))return t;var e,r;if(n&&"function"==typeof(e=t.toString)&&!p(r=e.call(t)))return r;if("function"==typeof(e=t.valueOf)&&!p(r=e.call(t)))return r;if(!n&&"function"==typeof(e=t.toString)&&!p(r=e.call(t)))return r;throw TypeError("Can't convert object to primitive value")}(n,!0),E(e),o)try{return i(t,n,e)}catch(t){}if("get"in e||"set"in e)throw TypeError("Accessors not supported!");return"value"in e&&(t[n]=e.value),t}},v=n?function(t,n,e){return a.f(t,n,{enumerable:!((r=1)&r),configurable:!(2&r),writable:!(4&r),value:e});var r}:function(t,n,e){return t[n]=e,t},c={}.hasOwnProperty,s=function(t,n){return c.call(t,n)},u=0,d=Math.random(),f=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++u+d).toString(36))},g=t(function(t){var i=f("src"),n="toString",e=Function[n],a=(""+e).split(n);y.inspectSource=function(t){return e.call(t)},(t.exports=function(t,n,e,r){var o="function"==typeof e;o&&(s(e,"name")||v(e,"name",n)),t[n]!==e&&(o&&(s(e,i)||v(e,i,t[n]?""+t[n]:a.join(String(n)))),t===m?t[n]=e:r?t[n]?t[n]=e:v(t,n,e):(delete t[n],v(t,n,e)))})(Function.prototype,n,function(){return"function"==typeof this&&this[i]||e.call(this)})}),O=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t},b=function(r,o,t){if(O(r),void 0===o)return r;switch(t){case 1:return function(t){return r.call(o,t)};case 2:return function(t,n){return r.call(o,t,n)};case 3:return function(t,n,e){return r.call(o,t,n,e)}}return function(){return r.apply(o,arguments)}},x="prototype",C=function(t,n,e){var r,o,i,a,c=t&C.F,s=t&C.G,u=t&C.S,l=t&C.P,d=t&C.B,f=s?m:u?m[n]||(m[n]={}):(m[n]||{})[x],p=s?y:y[n]||(y[n]={}),h=p[x]||(p[x]={});for(r in s&&(e=n),e)i=((o=!c&&f&&void 0!==f[r])?f:e)[r],a=d&&o?b(i,m):l&&"function"==typeof i?b(Function.call,i):i,f&&g(f,r,i,t&C.U),p[r]!=i&&v(p,r,a),l&&h[r]!=i&&(h[r]=i)};m.core=y,C.F=1,C.G=2,C.S=4,C.P=8,C.B=16,C.W=32,C.U=64,C.R=128;var h=C,w={}.toString,_=function(t){return w.call(t).slice(8,-1)},S=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==_(t)?t.split(""):Object(t)},k=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t},A=function(t){return Object(k(t))},j=Math.ceil,F=Math.floor,T=function(t){return isNaN(t=+t)?0:(0<t?F:j)(t)},P=Math.min,U=function(t){return 0<t?P(T(t),9007199254740991):0},M=Array.isArray||function(t){return"Array"==_(t)},N=t(function(t){var n="__core-js_shared__",e=m[n]||(m[n]={});(t.exports=function(t,n){return e[t]||(e[t]=void 0!==n?n:{})})("versions",[]).push({version:y.version,mode:"global",copyright:"Â© 2019 Denis Pushkarev (zloirock.ru)"})}),I=t(function(t){var n=N("wks"),e=m.Symbol,r="function"==typeof e;(t.exports=function(t){return n[t]||(n[t]=r&&e[t]||(r?e:f)("Symbol."+t))}).store=n}),B=I("species"),R=function(t,n){return M(e=t)&&("function"!=typeof(r=e.constructor)||r!==Array&&!M(r.prototype)||(r=void 0),p(r)&&null===(r=r[B])&&(r=void 0)),new(void 0===r?Array:r)(n);var e,r},z=function(d,t){var f=1==d,p=2==d,h=3==d,m=4==d,y=6==d,v=5==d||y,g=t||R;return function(t,n,e){for(var r,o,i=A(t),a=S(i),c=b(n,e,3),s=U(a.length),u=0,l=f?g(t,s):p?g(t,0):void 0;u<s;u++)if((v||u in a)&&(o=c(r=a[u],u,i),d))if(f)l[u]=o;else if(o)switch(d){case 3:return!0;case 5:return r;case 6:return u;case 2:l.push(r)}else if(m)return!1;return y?-1:h||m?m:l}},D=function(t,n){return!!t&&l(function(){n?t.call(null,function(){},1):t.call(null)})},G=z(1);h(h.P+h.F*!D([].map,!0),"Array",{map:function(t){return G(this,t,arguments[1])}});h(h.P+h.F*!D([].reduce,!0),"Array",{reduce:function(t){return function(t,n,e,r,o){O(n);var i=A(t),a=S(i),c=U(i.length),s=o?c-1:0,u=o?-1:1;if(e<2)for(;;){if(s in a){r=a[s],s+=u;break}if(s+=u,o?s<0:c<=s)throw TypeError("Reduce of empty array with no initial value")}for(;o?0<=s:s<c;s+=u)s in a&&(r=n(r,a[s],s,i));return r}(this,t,arguments.length,arguments[1],!1)}});var L,H,W,V=I("match"),Y=I("species"),K=(L=!0,function(t,n){var e,r,o=String(k(t)),i=T(n),a=o.length;return i<0||a<=i?L?"":void 0:(e=o.charCodeAt(i))<55296||56319<e||i+1===a||(r=o.charCodeAt(i+1))<56320||57343<r?L?o.charAt(i):e:L?o.slice(i,i+2):r-56320+(e-55296<<10)+65536}),X=I("toStringTag"),q="Arguments"==_(function(){return arguments}()),Z=RegExp.prototype.exec,J=function(t,n){var e,r,o,i,a=t.exec;if("function"==typeof a){var c=a.call(t,n);if("object"!=typeof c)throw new TypeError("RegExp exec method returned something other than an Object or null");return c}if("RegExp"!==(void 0===(e=t)?"Undefined":null===e?"Null":"string"==typeof(o=function(t,n){try{return t[n]}catch(t){}}(r=Object(e),X))?o:q?_(r):"Object"==(i=_(r))&&"function"==typeof r.callee?"Arguments":i))throw new TypeError("RegExp#exec called on incompatible receiver");return Z.call(t,n)},Q=RegExp.prototype.exec,tt=String.prototype.replace,nt=Q,et="lastIndex",rt=(H=/a/,W=/b*/g,Q.call(H,"a"),Q.call(W,"a"),0!==H[et]||0!==W[et]),ot=void 0!==/()??/.exec("")[1];(rt||ot)&&(nt=function(t){var n,e,r,o,i=this;return ot&&(e=new RegExp("^"+i.source+"$(?!\\s)",function(){var t=E(this),n="";return t.global&&(n+="g"),t.ignoreCase&&(n+="i"),t.multiline&&(n+="m"),t.unicode&&(n+="u"),t.sticky&&(n+="y"),n}.call(i))),rt&&(n=i[et]),r=Q.call(i,t),rt&&r&&(i[et]=i.global?r.index+r[0].length:n),ot&&r&&1<r.length&&tt.call(r[0],e,function(){for(o=1;o<arguments.length-2;o++)void 0===arguments[o]&&(r[o]=void 0)}),r});var it=nt;h({target:"RegExp",proto:!0,forced:it!==/./.exec},{exec:it});var at=I("species"),ct=!l(function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")}),st=function(){var t=/(?:)/,n=t.exec;t.exec=function(){return n.apply(this,arguments)};var e="ab".split(t);return 2===e.length&&"a"===e[0]&&"b"===e[1]}(),ut=Math.min,lt=[].push,dt="split",ft="length",pt="lastIndex",ht=4294967295,mt=!l(function(){});!function(e,t,n){var r=I(e),i=!l(function(){var t={};return t[r]=function(){return 7},7!=""[e](t)}),o=i?!l(function(){var t=!1,n=/a/;return n.exec=function(){return t=!0,null},"split"===e&&(n.constructor={},n.constructor[at]=function(){return n}),n[r](""),!t}):void 0;if(!i||!o||"replace"===e&&!ct||"split"===e&&!st){var a=/./[r],c=n(k,r,""[e],function(t,n,e,r,o){return n.exec===it?i&&!o?{done:!0,value:a.call(n,e,r)}:{done:!0,value:t.call(e,n,r)}:{done:!1}}),s=c[0],u=c[1];g(String.prototype,e,s),v(RegExp.prototype,r,2==t?function(t,n){return u.call(t,this,n)}:function(t){return u.call(t,this)})}}("split",2,function(o,i,C,w){var S;return S="c"=="abbc"[dt](/(b)*/)[1]||4!="test"[dt](/(?:)/,-1)[ft]||2!="ab"[dt](/(?:ab)*/)[ft]||4!="."[dt](/(.?)(.?)/)[ft]||1<"."[dt](/()()/)[ft]||""[dt](/.?/)[ft]?function(t,n){var e,r,o=String(this);if(void 0===t&&0===n)return[];if(!p(e=t)||(void 0!==(r=e[V])?!r:"RegExp"!=_(e)))return C.call(o,t,n);for(var i,a,c,s=[],u=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),l=0,d=void 0===n?ht:n>>>0,f=new RegExp(t.source,u+"g");(i=it.call(f,o))&&!(l<(a=f[pt])&&(s.push(o.slice(l,i.index)),1<i[ft]&&i.index<o[ft]&&lt.apply(s,i.slice(1)),c=i[0][ft],l=a,s[ft]>=d));)f[pt]===i.index&&f[pt]++;return l===o[ft]?!c&&f.test("")||s.push(""):s.push(o.slice(l)),s[ft]>d?s.slice(0,d):s}:"0"[dt](void 0,0)[ft]?function(t,n){return void 0===t&&0===n?[]:C.call(this,t,n)}:C,[function(t,n){var e=o(this),r=null==t?void 0:t[i];return void 0!==r?r.call(t,e,n):S.call(String(e),t,n)},function(t,n){var e=w(S,t,this,n,S!==C);if(e.done)return e.value;var r,o,i,a=E(t),c=String(this),s=(r=RegExp,void 0===(i=E(a).constructor)||null==(o=E(i)[Y])?r:O(o)),u=a.unicode,l=(a.ignoreCase?"i":"")+(a.multiline?"m":"")+(a.unicode?"u":"")+(mt?"y":"g"),d=new s(mt?a:"^(?:"+a.source+")",l),f=void 0===n?ht:n>>>0;if(0===f)return[];if(0===c.length)return null===J(d,c)?[c]:[];for(var p,h,m=0,y=0,v=[];y<c.length;){d.lastIndex=mt?y:0;var g,b=J(d,mt?c:c.slice(y));if(null===b||(g=ut(U(d.lastIndex+(mt?0:y)),c.length))===m)p=c,y=(h=y)+(u?K(p,h).length:1);else{if(v.push(c.slice(m,y)),v.length===f)return v;for(var x=1;x<=b.length-1;x++)if(v.push(b[x]),v.length===f)return v;y=m=g}}return v.push(c.slice(m)),v}]});var yt=a.f,vt=Function.prototype,gt=/^\s*function ([^ (]*)/;"name"in vt||n&&yt(vt,"name",{configurable:!0,get:function(){try{return(""+this).match(gt)[1]}catch(t){return""}}});var bt=[].sort,xt=[1,2,3];h(h.P+h.F*(l(function(){xt.sort(void 0)})||!l(function(){xt.sort(null)})||!D(bt)),"Array",{sort:function(t){return void 0===t?bt.call(A(this)):bt.call(A(this),O(t))}});var Ct,wt,St=/"/g;(wt={})[Ct="link"]=function(n){return function(t){return n(this,"a","href",t)}}(function(t,n,e,r){var o=String(k(t)),i="<"+n;return""!==e&&(i+=" "+e+'="'+String(r).replace(St,"&quot;")+'"'),i+">"+o+"</"+n+">"}),h(h.P+h.F*l(function(){var t=""[Ct]('"');return t!==t.toLowerCase()||3<t.split('"').length}),"String",wt);var Et=Math.max,Ot=Math.min,_t=function(u){return function(t,n,e){var r,o,i,a=S(k(t)),c=U(a.length),s=(o=c,(r=T(r=e))<0?Et(r+o,0):Ot(r,o));if(u&&n!=n){for(;s<c;)if((i=a[s++])!=i)return!0}else for(;s<c;s++)if((u||s in a)&&a[s]===n)return u||s||0;return!u&&-1}},kt=I("unscopables"),At=Array.prototype;null==At[kt]&&v(At,kt,{});var jt,Ft=_t(!0);function Tt(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Pt(o){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter(function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable}))),n.forEach(function(t){var n,e,r;n=o,r=i[e=t],e in n?Object.defineProperty(n,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[e]=r})}return o}h(h.P,"Array",{includes:function(t){return Ft(this,t,1<arguments.length?arguments[1]:void 0)}}),jt="includes",At[kt][jt]=!0;var Ut=z(2);h(h.P+h.F*!D([].filter,!0),"Array",{filter:function(t){return Ut(this,t,arguments[1])}});var Mt={aspectRatio:16/14,width:1090,margin:{top:10,right:10,bottom:10,left:10}};var Nt=_t(!1),It=[].indexOf,Bt=!!It&&1/[1].indexOf(1,-0)<0;h(h.P+h.F*(Bt||!D(It)),"Array",{indexOf:function(t){return Bt?It.apply(this,arguments)||0:Nt(this,t,arguments[1])}});var Rt={tableTitle:i18next.t("alt",{ns:"modes"}),y:{getValue:function(t,n){return t[n]}},z:{getId:function(t){return t.name},getKeys:function(t){var n=["name","value"];return-1!==n.indexOf(this.y.totalProperty)&&n.splice(n.indexOf(this.y.totalProperty),1),n},getKeyText:function(t){return i18next.t(t,{ns:"modes_sankey"})},getText:function(t){var n=i18next.t(t.source.name,{ns:"modes"}),e=i18next.t(t.target.name,{ns:"modes"});return"".concat(n," -> ").concat(e)}}},zt=[].slice,Dt={},Gt=Function.bind||function(n){var e=O(this),r=zt.call(arguments,1),o=function(){var t=r.concat(zt.call(arguments));return this instanceof o?function(t,n,e){if(!(n in Dt)){for(var r=[],o=0;o<n;o++)r[o]="a["+o+"]";Dt[n]=Function("F,a","return new F("+r.join(",")+")")}return Dt[n](t,e)}(e,t.length,t):function(t,n,e){var r=void 0===e;switch(n.length){case 0:return r?t():t.call(e);case 1:return r?t(n[0]):t.call(e,n[0]);case 2:return r?t(n[0],n[1]):t.call(e,n[0],n[1]);case 3:return r?t(n[0],n[1],n[2]):t.call(e,n[0],n[1],n[2]);case 4:return r?t(n[0],n[1],n[2],n[3]):t.call(e,n[0],n[1],n[2],n[3])}return t.apply(e,n)}(e,t,n)};return p(e.prototype)&&(o.prototype=e.prototype),o};h(h.P,"Function",{bind:Gt});var Lt=function(){function e(t,n){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this.pNode=t||document.createElement("div"),this.options=n||{},this.nodes={},this.data=null,this.instanceNumber=++e.n,this.class=this.options.class||""}var t,n,r;return t=e,(n=[{key:"build",value:function(t){t&&(this.options=t),t.pNode&&(this.pNode=t.pNode),t.class&&(this.class=t.class),this.root=document.createElement("div"),this.root.setAttribute("class","copy-button button-"+this.instanceNumber+" "+this.class),this.pNode.appendChild(this.root),this.nodes.btnCopy=document.createElement("button"),this.nodes.btnCopy.setAttribute("type","button"),this.nodes.btnCopy.setAttribute("class","btn btn-primary copy button-"+this.instanceNumber+" "+this.class),this.nodes.btnCopy.setAttribute("title",this.options.title||""),this.root.appendChild(this.nodes.btnCopy);var n=document.createElement("span");n.setAttribute("class","fa fa-clipboard clipboard button-"+this.instanceNumber+" "+this.class),this.nodes.btnCopy.appendChild(n);var e=document.createElement("span");e.setAttribute("class","wb-inv button-"+this.instanceNumber+" "+this.class),e.innerHTML=this.options.accessibility||"",this.nodes.btnCopy.appendChild(e),this.nodes.msgCopyConfirm=document.createElement("div"),this.nodes.msgCopyConfirm.setAttribute("class","copy-confirm button-"+this.instanceNumber+" "+this.class),this.nodes.msgCopyConfirm.setAttribute("aria-live","polite"),this.nodes.msgCopyConfirm.innerHTML=this.options.msgCopyConfirm||"",this.root.appendChild(this.nodes.msgCopyConfirm),this.nodes.btnCopy.addEventListener("click",this.onBtnClick.bind(this))}},{key:"onBtnClick",value:function(t){this.copyData(this.data)}},{key:"copyData",value:function(t){var n=t||[];this.clipboard(this.toCSV("\t",n),this.root),this.fade(this.nodes.msgCopyConfirm,!0),setTimeout(function(t){this.fade(this.nodes.msgCopyConfirm,!1)}.bind(this),1500)}},{key:"toCSV",value:function(n,t){return t.map(function(t){return t.join(n)}).join("\r\n")}},{key:"clipboard",value:function(t,n){if(this.isIE())window.clipboardData.setData("Text",t);else{var e=document.createElement("textarea");e.textContent=t,n.appendChild(e),e.select(),document.execCommand("copy"),n.removeChild(e)}}},{key:"fade",value:function(t,n){var e=["copy-confirm button-"+this.instanceNumber+" "+this.class],r=n?"fadeIn":"fadeOut";e.push(r),t.setAttribute("class",e.join(" "))}},{key:"appendTo",value:function(t){this.pNode=t,this.pNode.appendChild(this.root),this.nodes.msgCopyConfirm.setAttribute("class","copy-confirm button-"+this.instanceNumber+" "+this.class)}},{key:"isIE",value:function(){var t=window.navigator.userAgent,n=t.indexOf("MSIE ");if(0<n)return parseInt(t.substring(n+5,t.indexOf(".",n)),10);if(0<t.indexOf("Trident/")){var e=t.indexOf("rv:");return parseInt(t.substring(e+3,t.indexOf(".",e)),10)}var r=t.indexOf("Edge/");return 0<r&&parseInt(t.substring(r+5,t.indexOf(".",r)),10)}}])&&Tt(t.prototype,n),r&&Tt(t,r),e}();Lt.n=0;var Ht=new Lt,Wt="Canada",Vt="01",Yt="2018",$t={},Kt=[{node:0,name:"intl"},{node:1,name:"USres"},{node:2,name:"nonUSres"},{node:3,name:"cdnFromUS"},{node:4,name:"cdnFromOther"},{node:5,name:"USres_air"},{node:6,name:"USres_marine"},{node:7,name:"USres_land"},{node:8,name:"nonUSres_air"},{node:9,name:"nonUSres_marine"},{node:10,name:"nonUSres_land"},{node:11,name:"cdnFromUS_air"},{node:12,name:"cdnFromUS_marine"},{node:13,name:"cdnFromUS_land"},{node:14,name:"cdnFromOther_air"},{node:15,name:"cdnFromOther_marine"},{node:16,name:"cdnFromOther_land"},{node:17,name:"USres_car"},{node:18,name:"USres_bus"},{node:19,name:"USres_train"},{node:20,name:"USres_other"},{node:21,name:"cdnFromUS_car"},{node:22,name:"cdnFromUS_bus"},{node:23,name:"cdnFromUS_train"},{node:24,name:"cdnFromUS_other"}],Xt=function(e,r,o){$t[e+"-"+r]?o():d3.json("data/modes/"+e+"-"+r+".json",function(t,n){$t[e+"-"+r]=n,o()})},qt=d3.select("#sankeyGraph").append("svg").attr("id","svg_sankeyChart"),Zt=d3.select(".tabledata");function Jt(){var t,n,e,r=i18next.t(Vt,{ns:"modesMonth"});0===$t[Yt+"-"+Vt][Wt].map(function(t){return t.value}).reduce(function(t,n){return t+n})?(d3.selectAll("svg > *").remove(),d3.select("#zeroFlag").text("Zero international travellers for ".concat(Wt,",\n          ").concat(r," ").concat(Yt))):(d3.selectAll("svg > *").remove(),function(t,n,r){var e=Mt,o=e.width,i=Math.ceil(o/e.aspectRatio),a=e.innerHeight=i-e.margin.top-e.margin.bottom,c=e.innerWidth=o-e.margin.left-e.margin.right,s=t.select("g.margin-offset"),u=s.select(".data"),l=[];r={links:r.links.map(function(t){return Pt({},t)}).filter(function(t){return 0<t.value&&(l.push(t.source,t.target),!0)}),nodes:r.nodes.map(function(t){return Pt({},t)}).filter(function(t){return l.includes(t.node)})},e.innerHeight=i-e.margin.top-e.margin.bottom;var d=d3.format(",.0f"),f=function(t){return d(t)},p=d3.sankey().size([c,a]),h=p.link();t.attr("viewBox","0 0 "+o+" "+i).attr("preserveAspectRatio","xMidYMid meet").attr("role","img").attr("aria-label",e.altText),s.empty()&&(s=t.append("g").attr("class","margin-offset").attr("transform","translate("+e.margin.left+","+e.margin.top+")")),d3.stcExt.addIEShim(t,i,o),function(){p.nodes(r.nodes).links(r.links).layout(32);var e=d3.select("body").append("div").attr("class","tooltip").style("opacity",0);u.empty()&&(u=s.append("g").attr("class","data"));var n=u.append("g").selectAll(".link").data(p.links()).enter().append("path").attr("class","link").attr("d",h).style("stroke-width",function(t){return Math.max(1,t.dy)}).sort(function(t,n){return n.dy-t.dy}).on("mousemove",function(t){var n=t.source.name;e.transition().style("opacity",.9),e.html("<b>"+i18next.t(n,{ns:"modes"})+"</b><br><br><table><tr><td>"+i18next.t(t.target.name,{ns:"modes"})+": </td><td style='padding: 5px 10px 5px 5px;'><b>"+f(t.value)+" people</td></tr></table>").style("left",d3.event.pageX+"px").style("top",d3.event.pageY-90+"px")}).on("mouseout",function(t){e.transition().style("opacity",0)});if(0!==r.links.length){var t=u.append("g").selectAll(".node").data(p.nodes()).enter().append("g").attr("class",function(t){return"node "+t.name}).attr("transform",function(t){return"translate(".concat(t.x||0,", ").concat(t.y||0,")")}).call(d3.drag().subject(function(t){return t}).on("start",function(){this.parentNode.appendChild(this)}).on("drag",function(t){d3.select(this).attr("transform","translate("+t.x+","+(t.y=Math.max(0,Math.min(a-t.dy,d3.event.y)))+")"),p.relayout(),n.attr("d",h)}));t.on("mousemove",function(t){e.transition().style("opacity",.9),e.html("<b>"+i18next.t(t.name,{ns:"modes"})+"</b><br><br><table><tr><td>Total:</td><td style='padding: 5px 10px 5px 5px;'><b>"+f(t.value)+" people</td></tr></table>").style("left",d3.event.pageX+"px").style("top",d3.event.pageY-90+"px")}).on("mouseout",function(t){e.transition().style("opacity",0)}),t.append("rect").attr("height",function(t){return t.dy}).attr("width",p.nodeWidth()).style("stroke",function(t){return d3.rgb(t.color).darker(2)}).text(function(t){return i18next.t(t.name,{ns:"modes"})+"\n"+f(t.value)}),t.append("text").attr("x",-6).attr("y",function(t){return t.dy/2.5}).attr("dy",".35em").attr("text-anchor","end").attr("transform",null).text(function(t){if(0!=t.value)return i18next.t(t.name,{ns:"modes"})}).filter(function(t){return t.x<c/2}).attr("x",6+p.nodeWidth()).attr("text-anchor","start").call(function(t,s){t.each(function(){for(var t,n=d3.select(this),e=n.text().split(/\s+/).reverse(),r=[],o=0,i=n.attr("y"),a=parseFloat(n.attr("dy")),c=n.text(null).append("tspan").attr("x",40).attr("y",i).attr("dy",a+"em");t=e.pop();)r.push(t),c.text(r.join(" ")),c.node().getComputedTextLength()>s&&(r.pop(),c.text(r.join(" ")),r=[t],c=n.append("tspan").attr("x",40).attr("y",i).attr("dy",1.1*++o+a+"em").text(t))})},200)}}()}(qt,0,{nodes:Kt,links:$t[Yt+"-"+Vt][Wt]})),drawTable(Zt,Rt,$t[Yt+"-"+Vt][Wt].map(function(t){return{source:Kt[t.source],target:Kt[t.target],value:t.value}})),t=i18next.t(Wt,{ns:"modesGeography"}),n=i18next.t(Vt,{ns:"modesMonth"}),e=i18next.t("tableTitle",{ns:"modes_sankey"})+" "+t+" in "+n+" "+Yt+", by type of transport",d3.select("#only-dt-tbl").text(e),Ht.appendTo(document.getElementById("copy-button-container")),function(t){var n=[],e=i18next.t(Wt,{ns:"roadGeography"}),r=["Sales of fuel in ".concat(e," used for road motor vehicles, annual (millions of dollars)")],o=[""];for(var i in t[0])"date"!=i&&o.push(i18next.t(i,{ns:"roadArea"}));for(var a in n.push(r,[],o),t)if(Object.prototype.hasOwnProperty.call(t,a)){var c=[];for(var s in t[a])if(Object.prototype.hasOwnProperty.call(t[a],s)){var u=t[a][s];"date"==s||"total"==s||isNaN(u)||(u/=1e3),c.push(u)}n.push(c)}Ht.data=n}($t[Yt+"-"+Vt][Wt])}i18n.load(["src/i18n"],function(){var t={pNode:document.getElementById("copy-button-container"),title:i18next.t("CopyButton_Title",{ns:"CopyButton"}),msgCopyConfirm:i18next.t("CopyButton_Confirm",{ns:"CopyButton"}),accessibility:i18next.t("CopyButton_Title",{ns:"CopyButton"})};Ht.build(t),Xt(Yt,Vt,Jt)}),$(document).on("change",function(t){d3.selectAll(".tooltip").style("opacity",0),"groups"!==t.target.id&&"month"!==t.target.id&&"year"!==t.target.id||(Wt=document.getElementById("groups").value,Vt=document.getElementById("month").value,Yt=document.getElementById("year").value,""!==d3.select("#zeroFlag").text()&&d3.select("#zeroFlag").text(""),Xt(Yt,Vt,function(){Jt()}))})}();