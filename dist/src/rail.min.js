!function(){"use strict";function s(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function t(t,e){return t(e={exports:{}},e.exports),e.exports}var g=t(function(t){var e=t.exports={version:"2.6.3"};"number"==typeof __e&&(__e=e)}),v=(g.version,t(function(t){var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)})),i=t(function(t){var e="__core-js_shared__",n=v[e]||(v[e]={});(t.exports=function(t,e){return n[t]||(n[t]=void 0!==e?e:{})})("versions",[]).push({version:g.version,mode:"global",copyright:"Â© 2019 Denis Pushkarev (zloirock.ru)"})}),e=0,n=Math.random(),u=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++e+n).toString(36))},r=t(function(t){var e=i("wks"),n=v.Symbol,r="function"==typeof n;(t.exports=function(t){return e[t]||(e[t]=r&&n[t]||(r?n:u)("Symbol."+t))}).store=e}),o=function(t){return"object"==typeof t?null!==t:"function"==typeof t},a=function(t){if(!o(t))throw TypeError(t+" is not an object!");return t},c=function(t){try{return!!t()}catch(t){return!0}},l=!c(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),f=v.document,p=o(f)&&o(f.createElement),d=function(t){return p?f.createElement(t):{}},y=!l&&!c(function(){return 7!=Object.defineProperty(d("div"),"a",{get:function(){return 7}}).a}),h=Object.defineProperty,m={f:l?Object.defineProperty:function(t,e,n){if(a(t),e=function(t,e){if(!o(t))return t;var n,r;if(e&&"function"==typeof(n=t.toString)&&!o(r=n.call(t)))return r;if("function"==typeof(n=t.valueOf)&&!o(r=n.call(t)))return r;if(!e&&"function"==typeof(n=t.toString)&&!o(r=n.call(t)))return r;throw TypeError("Can't convert object to primitive value")}(e,!0),a(n),y)try{return h(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},j=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},S=l?function(t,e,n){return m.f(t,e,j(1,n))}:function(t,e,n){return t[e]=n,t},b=r("unscopables"),O=Array.prototype;null==O[b]&&S(O,b,{});var x=function(t){O[b][t]=!0},_=function(t,e){return{value:e,done:!!t}},T={},w={}.toString,L=function(t){return w.call(t).slice(8,-1)},P=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==L(t)?t.split(""):Object(t)},k=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t},A=function(t){return P(k(t))},M={}.hasOwnProperty,C=function(t,e){return M.call(t,e)},E=t(function(t){var o=u("src"),e="toString",n=Function[e],a=(""+n).split(e);g.inspectSource=function(t){return n.call(t)},(t.exports=function(t,e,n,r){var i="function"==typeof n;i&&(C(n,"name")||S(n,"name",e)),t[e]!==n&&(i&&(C(n,o)||S(n,o,t[e]?""+t[e]:a.join(String(e)))),t===v?t[e]=n:r?t[e]?t[e]=n:S(t,e,n):(delete t[e],S(t,e,n)))})(Function.prototype,e,function(){return"function"==typeof this&&this[o]||n.call(this)})}),F=function(r,i,t){if(function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!")}(r),void 0===i)return r;switch(t){case 1:return function(t){return r.call(i,t)};case 2:return function(t,e){return r.call(i,t,e)};case 3:return function(t,e,n){return r.call(i,t,e,n)}}return function(){return r.apply(i,arguments)}},I="prototype",D=function(t,e,n){var r,i,o,a,u=t&D.F,c=t&D.G,l=t&D.S,s=t&D.P,f=t&D.B,p=c?v:l?v[e]||(v[e]={}):(v[e]||{})[I],d=c?g:g[e]||(g[e]={}),y=d[I]||(d[I]={});for(r in c&&(n=e),n)o=((i=!u&&p&&void 0!==p[r])?p:n)[r],a=f&&i?F(o,v):s&&"function"==typeof o?F(Function.call,o):o,p&&E(p,r,o,t&D.U),d[r]!=o&&S(d,r,a),s&&y[r]!=o&&(y[r]=o)};v.core=g,D.F=1,D.G=2,D.S=4,D.P=8,D.B=16,D.W=32,D.U=64,D.R=128;var V=D,R=Math.ceil,B=Math.floor,G=function(t){return isNaN(t=+t)?0:(0<t?B:R)(t)},N=Math.min,z=function(t){return 0<t?N(G(t),9007199254740991):0},H=Math.max,K=Math.min,U=function(l){return function(t,e,n){var r,i,o,a=A(t),u=z(a.length),c=(i=u,(r=G(r=n))<0?H(r+i,0):K(r,i));if(l&&e!=e){for(;c<u;)if((o=a[c++])!=o)return!0}else for(;c<u;c++)if((l||c in a)&&a[c]===e)return l||c||0;return!l&&-1}},W=i("keys"),q=function(t){return W[t]||(W[t]=u(t))},Q=U(!1),J=q("IE_PROTO"),X="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),Y=Object.keys||function(t){return function(t,e){var n,r=A(t),i=0,o=[];for(n in r)n!=J&&C(r,n)&&o.push(n);for(;e.length>i;)C(r,n=e[i++])&&(~Q(o,n)||o.push(n));return o}(t,X)},Z=l?Object.defineProperties:function(t,e){a(t);for(var n,r=Y(e),i=r.length,o=0;o<i;)m.f(t,n=r[o++],e[n]);return t},tt=v.document,et=tt&&tt.documentElement,nt=q("IE_PROTO"),rt=function(){},it="prototype",ot=function(){var t,e=d("iframe"),n=X.length;for(e.style.display="none",et.appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),ot=t.F;n--;)delete ot[it][X[n]];return ot()},at=Object.create||function(t,e){var n;return null!==t?(rt[it]=a(t),n=new rt,rt[it]=null,n[nt]=t):n=ot(),void 0===e?n:Z(n,e)},ut=m.f,ct=r("toStringTag"),lt=function(t,e,n){t&&!C(t=n?t:t.prototype,ct)&&ut(t,ct,{configurable:!0,value:e})},st={};S(st,r("iterator"),function(){return this});var ft=function(t){return Object(k(t))},pt=q("IE_PROTO"),dt=Object.prototype,yt=Object.getPrototypeOf||function(t){return t=ft(t),C(t,pt)?t[pt]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?dt:null},gt=r("iterator"),vt=!([].keys&&"next"in[].keys()),ht="values",mt=function(){return this},bt=function(t,e,n,r,i,o,a){var u,c,l;c=e,l=r,(u=n).prototype=at(st,{next:j(1,l)}),lt(u,c+" Iterator");var s,f,p,d=function(t){if(!vt&&t in h)return h[t];switch(t){case"keys":case ht:return function(){return new n(this,t)}}return function(){return new n(this,t)}},y=e+" Iterator",g=i==ht,v=!1,h=t.prototype,m=h[gt]||h["@@iterator"]||i&&h[i],b=m||d(i),O=i?g?d("entries"):b:void 0,x="Array"==e&&h.entries||m;if(x&&(p=yt(x.call(new t)))!==Object.prototype&&p.next&&(lt(p,y,!0),"function"!=typeof p[gt]&&S(p,gt,mt)),g&&m&&m.name!==ht&&(v=!0,b=function(){return m.call(this)}),(vt||v||!h[gt])&&S(h,gt,b),T[e]=b,T[y]=mt,i)if(s={values:g?b:d(ht),keys:o?b:d("keys"),entries:O},a)for(f in s)f in h||E(h,f,s[f]);else V(V.P+V.F*(vt||v),e,s);return s}(Array,"Array",function(t,e){this._t=A(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,_(1)):_(0,"keys"==e?n:"values"==e?t[n]:[n,t[n]])},"values");T.Arguments=T.Array,x("keys"),x("values"),x("entries");for(var Ot=r("iterator"),xt=r("toStringTag"),jt=T.Array,St={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},_t=Y(St),Tt=0;Tt<_t.length;Tt++){var wt,Lt=_t[Tt],Pt=St[Lt],kt=v[Lt],At=kt&&kt.prototype;if(At&&(At[Ot]||S(At,Ot,jt),At[xt]||S(At,xt,Lt),T[Lt]=jt,Pt))for(wt in bt)At[wt]||E(At,wt,bt[wt],!0)}var Mt,Ct,Et,Ft;Mt="keys",Ct=function(){return function(t){return Y(ft(t))}},Et=(g.Object||{})[Mt]||Object[Mt],(Ft={})[Mt]=Ct(Et),V(V.S+V.F*c(function(){Et(1)}),"Object",Ft);var It=Array.isArray||function(t){return"Array"==L(t)},Dt=r("species"),Vt=function(t,e){return It(n=t)&&("function"!=typeof(r=n.constructor)||r!==Array&&!It(r.prototype)||(r=void 0),o(r)&&null===(r=r[Dt])&&(r=void 0)),new(void 0===r?Array:r)(e);var n,r},Rt=function(f,t){var p=1==f,d=2==f,y=3==f,g=4==f,v=6==f,h=5==f||v,m=t||Vt;return function(t,e,n){for(var r,i,o=ft(t),a=P(o),u=F(e,n,3),c=z(a.length),l=0,s=p?m(t,c):d?m(t,0):void 0;l<c;l++)if((h||l in a)&&(i=u(r=a[l],l,o),f))if(p)s[l]=i;else if(i)switch(f){case 3:return!0;case 5:return r;case 6:return l;case 2:s.push(r)}else if(g)return!1;return v?-1:y||g?g:s}},Bt=function(t,e){return!!t&&c(function(){e?t.call(null,function(){},1):t.call(null)})},Gt=Rt(2);V(V.P+V.F*!Bt([].filter,!0),"Array",{filter:function(t){return Gt(this,t,arguments[1])}});var Nt=U(!1),zt=[].indexOf,Ht=!!zt&&1/[1].indexOf(1,-0)<0;V(V.P+V.F*(Ht||!Bt(zt)),"Array",{indexOf:function(t){return Ht?zt.apply(this,arguments)||0:Nt(this,t,arguments[1])}});var Kt=Rt(1);V(V.P+V.F*!Bt([].map,!0),"Array",{map:function(t){return Kt(this,t,arguments[1])}});var Ut={alt:i18next.t("alt",{ns:"line"}),aspectRatio:3.8,margin:{top:20,right:10,bottom:50,left:70},filterData:function(t){var n=t;return Object.keys(n[0]).slice(1).map(function(e){return{id:e,data:n.map(function(t){return{year:t.year,value:t[e]}})}})},x:{ticks:10,getValue:function(t){return new Date(t.year+"-01")},getText:function(t){return t.year}},y:{ticks:3,getValue:function(t){return t.value},getText:function(t){return t.value}},z:{label:i18next.t("z_label",{ns:"line"}),getId:function(t){return t.id},getKeys:function(t){var e=Object.keys(t);return e.splice(e.indexOf("keys"),1),e},getClass:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.z.getId.apply(this,e)},getDataPoints:function(t){return t.data},getText:function(t){return i18next.t(t.id,{ns:"line"})}},datatable:!1,width:600},Wt={aspectRatio:19/3,margin:{top:30,right:0,bottom:0,left:120},alt:i18next.t("alt",{ns:"commodities"}),filterData:function(t){var i={};return t.map(function(t){var e=Object.keys(t);e.splice(e.indexOf("year"),1);for(var n=0;n<e.length;n++){var r=e[n];i[r]||(i[r]=[]),i[r].push({year:t.year,value:t[r]})}}),Object.keys(i).map(function(t){return{id:t,dataPoints:i[t]}})},x:{getValue:function(t){return t.year},getText:function(t){return t.year}},r:{inverselyProportional:!1,getValue:function(t){return t.value}},z:{getId:function(t){return t.id},getClass:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.z.getId.apply(this,e)},getText:function(t){return i18next.t(t.id,{ns:"commodities"})},getDataPoints:function(t){return t.dataPoints}},width:900};function qt(n,t){var e=300-63-0,r=30-0-0,i=d3.select(t).select("svg").attr("width",e).attr("height",r).style("vertical-align","middle").attr("transform","translate(345,30)").selectAll("rect").data(n).enter().append("g"),o=[0,20],a=[130,150];i.append("line").attr("x1",function(t,e){return 0===e?o[0]:a[0]}).attr("x2",function(t,e){return 0===e?o[1]:a[1]}).attr("y1",7).attr("y2",7).attr("class",function(t,e){return(0===e?"legendLine ":"legendLine2 ")+n[e]+"to"}),i.append("text"),d3.select(t).selectAll("text").text(function(t,e){return 0===e?n[0]+" to "+n[1]:n[1]+" to "+n[0]}).attr("y",10).attr("x",function(t,e){return[25,155][e]}).style("display",function(){return"inline"})}var Qt="ON",$t="chems",Jt=["AT","ON","QC","MB","SK","AB","BC"].filter(function(t){return t!==Qt}),Xt=d3.select("#pair1").append("svg").attr("id","svg_pair1"),Yt=d3.select("#pair2").append("svg").attr("id","svg_pair2"),Zt=d3.select("#pair3").append("svg").attr("id","svg_pair3"),te=d3.select("#pair4").append("svg").attr("id","svg_pair4"),ee=d3.select("#pair5").append("svg").attr("id","svg_pair5"),ne=d3.select("#pair6").append("svg").attr("id","svg_pair6"),re=d3.select("#commgrid").append("svg").attr("id","svg_commgrid");function ie(t){d3.select("#commTableTitle").text("Total tonnage from all origins to all destinations (x 1M) for 10 commodities"),d3.json("data/rail/commdata_allOrig_allDest.json",function(t,e){console.log("sort the data!"),bubbleTable(re,Wt,e)})}i18n.load(["src/i18n"],function(){Ut.x.label=i18next.t("x_label",{ns:"railArea"}),Ut.y.label=i18next.t("y_label",{ns:"railArea"}),d3.json("data/rail/"+Qt+"_"+$t+".json",function(t,c){console.log("json1: ",c);for(var l=Object.keys(c).length,e=function(a){var u=Jt[a];d3.json("data/rail/"+u+"_"+$t+".json",function(t,e){for(var n=[],r=0;r<l;r++){var i,o=Object.keys(c)[r];n.push((s(i={year:o},Qt+"to"+u,c[o][u]),s(i,u+"to"+Qt,e[o][Qt]),i))}0==a?(lineChart(Xt,Ut,n),qt([Qt,u],"#legend1")):1==a?(lineChart(Yt,Ut,n),qt([Qt,u],"#legend2")):2==a?(lineChart(Zt,Ut,n),qt([Qt,u],"#legend3")):3==a?(lineChart(te,Ut,n),qt([Qt,u],"#legend4")):4==a?(lineChart(ee,Ut,n),qt([Qt,u],"#legend5")):5==a&&(lineChart(ne,Ut,n),qt([Qt,u],"#legend6"))})},n=0;n<Jt.length;n++)e(n)}),ie()}),$(document).on("change",function(t){"commodity"===t.target.id&&($t=document.getElementById("commodity").value),"region"===t.target.id&&(Qt=document.getElementById("region").value)})}();