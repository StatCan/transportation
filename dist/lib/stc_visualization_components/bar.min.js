!function(a){var b={margin:{top:18,right:10,bottom:30,left:50},x:{getDomain:function(a){var b,c,d,e=this,f=[];for(b=0;b<a.length;b++)c=a[b],d=e.x.getValue.call(e,c),-1===f.indexOf(d)&&f.push(d);return f}},y:{getDomain:function(a){var b=d3.min(a,this.y.getValue.bind(this)),c=d3.max(a,this.y.getValue.bind(this));return b>0&&(b=0),c<0&&(c=0),this.showValues&&(b<0&&(b-=.09*(c-b)),c>0&&(c+=.06*(c-b))),[b,c]}},z:{getDomain:function(a){var b,c,d,e=this,f=[];for(b=0;b<a.length;b++)c=a[b],d=e.z.getId.call(e,c),-1===f.indexOf(d)&&f.push(d);return f}},groupPadding:.2,barPadding:.1,aspectRatio:16/9,width:600,barTableID:"barTable"};this.barChart=function(c,d,e){var f,g,h,i,j,k=a(!0,{},b,d),l=k.width,m=Math.ceil(l/k.aspectRatio),n=k.innerHeight=m-k.margin.top-k.margin.bottom,o=k.innerWidth=l-k.margin.left-k.margin.right,p=c.select("g.margin-offset"),q=p.select(".data"),r=d3.transition().duration(1e3),s=function(){var a,b=this.settings,c=b.filterData&&"function"==typeof b.filterData?b.filterData.call(b,e):e,j=[].concat.apply([],c.map(function(a){return b.z.getDataPoints.call(b,a)})),k=p.select(".x.axis"),l=p.select(".y.axis"),m=b.showValues,s=function(){return x.apply(this,arguments)+g.bandwidth()/2},t=function(a,c){var d="bar-group bar-group"+(c+1);return b.x&&b.x.getClass&&"function"==typeof b.x.getClass&&(d+=" "+b.x.getClass.call(b,a)),d},u=function(){return"translate("+f(b.x.getValue.apply(b,arguments))+",0)"},v=function(a,c){var d="bar bar"+(c+1);return b.x&&b.z.getClass&&"function"==typeof b.z.getClass&&(d+=" "+b.z.getClass.call(b,a)),d},w=function(){var a=d3.select(this),d=b.x.getValue.call(b,a.data()[0]),e=function(a){return b.z.getDataPoints.call(b,a).filter(function(a){return b.x.getValue.call(b,a)===d})[0]},f=function(a){var c=e.call(b,a),d=b.y.getValue.call(b,c);switch(Math.sign(d)){case 1:return"-0.5em";case-1:return"1.5em"}},i=a.selectAll(".bar").data(c,b.z.getId.bind(b)),j=a.selectAll(".value").data(function(){return"function"==typeof m?c.filter(function(a){return m.call(b,e(a))}):!0!==m?[]:c},b.z.getId.bind(b));i.enter().append("rect").attr("x",x).attr("width",g.bandwidth()).attr("y",h(0)).attr("height",0).attr("class",v.bind(b)).each(function(a){var c=e.call(b,a),d=A(a)+"_"+z(c),f=y(c),g=B(c),i=h(0);d3.select(this).attr("id",d).transition(r).attr("y",f<i?f:i).attr("height",g)}),i.attr("x",x).attr("width",g.bandwidth()).attr("class",v.bind(b)).each(function(a){var c=e.call(b,a),d=A(a)+"_"+z(c),f=y(c),g=B(c),i=h(0);d3.select(this).attr("id",d).transition(r).attr("y",f<i?f:i).attr("height",g)}),i.exit().remove(),j.enter().append("text").attr("x",s).attr("aria-hidden","true").attr("dy",f).attr("text-anchor","middle").attr("class","value").each(function(a){var c=e.call(b,a),d=y(c);d3.select(this).attr("y",d).text(b.y.getText.call(b,c))}),j.attr("x",s).each(function(a){var c=e.call(b,a),d=y(c);d3.select(this).transition(r).attr("y",d).attr("dy",f).text(b.y.getText.call(b,c))}),j.exit().remove()},x=function(){return g(b.z.getId.apply(b,arguments))},y=function(a){return h(b.y.getValue.call(b,a))},z=b.x.getId.bind(b),A=b.z.getId.bind(b),B=function(){var a=y.apply(this,arguments);return a<h(0)?h(0)-a:a-h(0)},C=b.x.getDomain.call(b,j);f=i.x0=d3.scaleBand().paddingInner(b.groupPadding),g=i.x1=d3.scaleBand().padding(b.barPadding),h=i.y=d3.scaleLinear().rangeRound([n,0]),f.domain(C).rangeRound([0,o]),g.domain(b.z.getDomain.call(b,c)).rangeRound([0,f.bandwidth()]),h.domain(b.y.getDomain.call(b,j)),q.empty()&&(q=p.append("g").attr("class","data")),a=q.selectAll(".bar-group").data(C.map(function(a){for(var c=0;c<j.length;c++)if(b.x.getValue.call(b,j[c])===a)return j[c]}).filter(function(a){return void 0!==a}),b.x.getId.bind(b)),a.enter().append("g").attr("class",t).attr("transform",u).each(w),a.attr("class",t).transition(r).attr("transform",u).each(w),a.exit().remove(),k.empty()?(k=p.append("g").attr("class","x axis").attr("aria-hidden","true").attr("transform","translate(0,"+n+")"),k.append("text").attr("class","chart-label").attr("fill","#000").attr("x",o).attr("dy","-0.5em").attr("text-anchor","end").text(b.x.label)):k.select("text").text(d.x.label),k.call(d3.axisBottom(f).ticks(b.x.ticks).tickSizeOuter(b.x.tickSizeOuter?b.x.tickSizeOuter:null).tickFormat(b.x.getTickText?b.x.getTickText.bind(b):null)),l.empty()?(l=p.append("g").attr("class","y axis").attr("aria-hidden","true"),l.append("text").attr("class","chart-label").attr("fill","#000").attr("y","0").attr("dy","-0.5em").attr("text-anchor","start").text(b.y.label)):l.select("text").text(d.y.label),l.call(d3.axisLeft(h).ticks(b.y.ticks).tickSizeOuter(b.y.tickSizeOuter?b.y.tickSizeOuter:null).tickFormat(b.y.getTickText?b.y.getTickText.bind(b):null))},t=function(){var a,b,c,d,f,g,h=this.settings,i=h.summaryId?h.summaryId:"chrt-dt-tbl",j=d3.select("#"+h.barTableID),k=h.filterData&&"function"==typeof h.filterData?h.filterData(e,"table"):e,l=j.select(function(){return this.parentNode}),m=l.select("details"),n=h.z.getKeys.call(h,k),o=h.z.formatData.call(h,k);if(m.empty()){for(m=l.append("details").attr("class","chart-data-table"),m.append("summary").attr("id",i).text(h.tableTitle),a=m.append("table").attr("class","table").attr("aria-labelledby",i),b=a.append("thead").attr("id","tblHeader").append("tr").attr("id","tblHeaderTR"),c=a.append("tbody").attr("id","tblBody"),b.append("th").attr("id","thead_h0").text(h.z.label),g=0;g<n.length;g++)b.append("th").attr("id","thead_h"+(g+1)).attr("class","tblHeader").text(h.z.getText.bind(h)({key:n[g]}));for(d=c.selectAll("tr").data(o),f=d.enter().append("tr").attr("id",function(a,b){return"row"+b}),f.append("th").attr("id",function(a,b){return"row"+b+"_h0"}).text((h.x.getText||h.x.getValue).bind(h)),g=0;g<n.length;g++)f.append("td").attr("headers",function(a,b){return"row"+b+"_h0 thead_h"+(g+1)}).text(function(a){return h.y.getText?h.y.getText.call(h,a,n[g]):h.y.getValue.call(h,a,n[g])});($||wb)&&$(".chart-data-table summary").trigger("wb-init.wb-details")}},u=function(){q.remove()};return i={settings:k,clear:u,svg:c},c.attr("viewBox","0 0 "+l+" "+m).attr("preserveAspectRatio","xMidYMid meet").attr("role","img").attr("aria-label",k.altText),p.empty()&&(p=c.append("g").attr("class","margin-offset").attr("transform","translate("+k.margin.left+","+k.margin.top+")")),j=function(){s.apply(i),d3.stcExt.addIEShim(c,m,l),!1!==k.datatable&&t.apply(i)},void 0===e?d3.json(k.url,function(a,b){e=b,j()}):j(),i},Math.sign||(Math.sign=function(a){return(a>0)-(a<0)||+a})}(jQuery.extend,jQuery);
//# sourceMappingURL=bar.min.js.map