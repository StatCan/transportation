!function(a){var b={margin:{top:15,right:10,bottom:30,left:50},aspectRatio:16/9,x:{ticks:5},y:{ticks:10},showLabels:!1,pointRadius:5,width:600};this.scatterChart=function(c,d,e){var f,g,h,i,j,k=a(!0,{},b,d),l=k.width,m=Math.ceil(l/k.aspectRatio),n=k.innerHeight=m-k.margin.top-k.margin.bottom,o=k.innerWidth=l-k.margin.left-k.margin.right,p=c.select("g.margin-offset"),q=p.select(".data"),r=d3.transition().duration(1e3).ease(d3.easeLinear),s=function(a){var b,c,d,e=function(a,b){return a-b};return b=a.map(function(a){return k.x.getValue(a)}).sort(e),c=a.map(function(a){return k.y.getValue(a)}).sort(e),d=Math.floor(.05*a.length),{x:{min:b[d],max:b[b.length-d]},y:{min:c[d],max:c[c.length-d]}}},t=function(){var a,b,c,j,l,m,t,u,v,w=this.settings,x=w.filterData&&"function"==typeof w.filterData?w.filterData.call(w,e):e,y=w.displayOnly&&"function"==typeof w.displayOnly?w.displayOnly.call(w,x):null,z=p.select(".x.axis"),A=p.select(".y.axis"),B=function(a,b){var c="point point"+(b+1);return w.z&&w.z.getClass&&"function"==typeof w.z.getClass&&(c+=" "+w.z.getClass.call(w,a)),y&&-1===y.indexOf(a)||(c+=" visible"),c},C=function(a,b){var c="label label"+(b+1);return y&&-1===y.indexOf(a)||(c+=" visible"),c},D=function(){if(w.z&&w.z.getId&&"function"==typeof w.z.getId)return w.z.getId.apply(w,arguments)},E=function(){return f(w.x.getValue.apply(this,arguments))},F=function(){return g(w.y.getValue.apply(this,arguments))},G=function(a,b,c){var d=c[b].getBBox(),e=E.apply(w,arguments)+w.pointRadius;return e+d.width>o&&(e-=d.width+2*w.pointRadius),e},H=function(a){var b=F(a)-w.pointRadius;return b<0&&(b=2*+w.pointRadius),b};"object"==typeof w.pointRadius?(j="function"==typeof w.pointRadius.getDomain?w.pointRadius.getDomain.call(w,x):[0,1],l=w.pointRadius.getRange.call(w,x)||[1,1],h=i.p=d3.scaleLinear().range(l).domain(j),m=function(){return h(w.pointRadius.getValue.apply(this,arguments))},a=l[1]):(m=w.pointRadius||1,a=m),w.filterOutliars?(t=s(x),b=[t.x.min,t.x.max],c=[t.y.min,t.y.max]):(b=d3.extent(y||x,w.x.getValue.bind(w)),c=d3.extent(y||x,w.y.getValue.bind(w))),f=i.x=d3.scaleLinear().range([a,o-2*a]),g=i.y=d3.scaleLinear().range([n-2*a,a]),f.domain(b),g.domain(c),q.empty()&&(q=p.append("g").attr("class","data")),u=q.selectAll(".point").data(x,w.z.getId.bind(w)),u.enter().append("circle").attr("r",m).attr("id",D).attr("class",B).attr("cx",E).attr("cy",F),u.transition(r).attr("class",B).attr("cx",E).attr("cy",F),u.exit().remove(),v=q.selectAll(".label"),w.showLabels?(v.data(x).enter().append("text").text(w.z.getText.bind(w)).attr("aria-hidden","true").attr("class",C).attr("fill","#000").attr("x",G).attr("y",H),v.transition(r).text(w.z.getText.bind(w)).attr("class",C).attr("x",G).attr("y",H),v.exit().remove()):v.remove(),z.empty()?(z=p.append("g").attr("class","x axis").attr("aria-hidden","true").attr("transform","translate(0,"+(n-2*a)+")"),z.append("text").attr("class","chart-label").attr("fill","#000").attr("x",o-2*a).attr("dy","-0.5em").attr("text-anchor","end").text(d.x.label)):z.select("text").text(d.x.label),z.call(d3.axisBottom(f).ticks(k.x.ticks).tickFormat(w.x.getTickText?w.x.getTickText.bind(w):null)),A.empty()?(A=p.append("g").attr("class","y axis").attr("aria-hidden","true").attr("transform","translate("+a+",0)"),A.append("text").attr("class","chart-label").attr("fill","#000").attr("y",a).attr("dy","-0.5em").attr("text-anchor","start").text(d.y.label)):A.select("text").text(d.y.label),A.call(d3.axisLeft(g).ticks(k.y.ticks).tickFormat(w.y.getTickText?w.y.getTickText.bind(w):null))},u=function(){var a,b,f,g,h,i=this.settings,j=i.filterData&&"function"==typeof i.filterData?i.filterData(e,"table"):e,k=c.select(c.classed("svg-shimmed")?function(){return this.parentNode.parentNode}:function(){return this.parentNode}),l=k.select("details");l.empty()&&(l=k.append("details").attr("class","chart-data-table"),l.append("summary").attr("id","chrt-dt-tbl").text(d.datatable.title||"Data"),a=l.append("table").attr("class","table").attr("aria-labelledby","chrt-dt-tbl"),b=a.append("thead").append("tr"),f=a.append("tbody"),b.append("th").text(d.z.label),b.append("th").text(d.x.label),b.append("th").text(d.y.label),g=f.selectAll("tr").data(j),h=g.enter().append("tr"),h.append("th").text(d.z.getText.bind(i)),h.append("td").text((d.x.getText||d.x.getValue).bind(i)),h.append("td").text((d.y.getText||d.y.getValue).bind(i)),($||wb)&&$(".chart-data-table summary").trigger("wb-init.wb-details"))},v=function(){q.remove()};return i={settings:k,clear:v,svg:c},c.attr("viewBox","0 0 "+l+" "+m).attr("preserveAspectRatio","xMidYMid meet").attr("role","img").attr("aria-label",k.altText),c.node().msContentZoomFactor&&c.attr("height",m),p.empty()&&(p=c.append("g").attr("class","margin-offset").attr("transform","translate("+k.margin.left+","+k.margin.top+")")),j=function(){t.apply(i),d3.stcExt.addIEShim(c,m,l),!1!==k.datatable&&u.apply(i)},void 0===e?d3.json(k.url,function(a,b){e=b,j()}):j(),i}}(jQuery.extend);
//# sourceMappingURL=scatter.min.js.map